{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-H100-80GB-HBM3_rlhf-gpus_176.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 192, "brand": "AMD EPYC 9654 96-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-n002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "4", "device": 0, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 70.794, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "5", "device": 1, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 35.0, "power": 70.988, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "6", "device": 2, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 34.0, "power": 71.595, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "7", "device": 3, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 71.158, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1734049399.022191, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "176", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031399.0892518}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/24 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1734031429.8373687, "gpudata": {"0": {"memory": [7172.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.027}, "1": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 36.0, "power": 119.652}, "2": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 35.0, "power": 120.947}, "3": {"memory": [6980.5625, 81559.0], "load": 0.0, "temperature": 31.0, "power": 118.218}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031429.8373687, "iodata": {"read_count": 0, "write_count": 407, "read_bytes": 0, "read_time": 0, "write_time": 16, "busy_time": 224}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031429.8373687, "netdata": {"bytes_sent": 111165084560, "bytes_recv": 801221253774, "packets_sent": 256458033, "packets_recv": 673927665, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031429.8373687, "cpudata": {"memory": [33627164672, 2429110050816], "load": 0.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 68, 'objective/kl': -0.0003152333665639162, 'objective/entropy': 92.87032318115234, 'objective/non_score_reward': 1.576166869199369e-05, 'objective/rlhf_reward': -0.9859561920166016, 'objective/scores': -0.9859718084335327, 'policy/approxkl_avg': 2.392251491546631, 'policy/clipfrac_avg': 0.40382450819015503, 'loss/policy_avg': 0.2204381823539734, 'loss/value_avg': 4.051501750946045, 'val/clipfrac_avg': 0.24813061952590942, 'policy/entropy_avg': 1.5255608558654785, 'val/ratio': 0.9659631252288818, 'val/ratio_var': 0.0014978019753471017, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 704, 'epoch': 0.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/24 [00:10<?, ?it/s]\r  4%|\u258d         | 1/24 [00:10<03:56, 10.27s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031439.8552315, "gpudata": {"0": {"memory": [44892.5625, 81559.0], "load": 0.39, "temperature": 42.0, "power": 267.442}, "1": {"memory": [44688.5625, 81559.0], "load": 0.38, "temperature": 45.0, "power": 273.218}, "2": {"memory": [45082.5625, 81559.0], "load": 0.39, "temperature": 45.0, "power": 269.518}, "3": {"memory": [44702.5625, 81559.0], "load": 0.4, "temperature": 41.0, "power": 270.519}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031439.8552315, "iodata": {"read_count": 0, "write_count": 856, "read_bytes": 0, "read_time": 0, "write_time": 33, "busy_time": 408}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031439.8552315, "netdata": {"bytes_sent": 111165097494, "bytes_recv": 801221265856, "packets_sent": 256458088, "packets_recv": 673927718, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031439.8552315, "cpudata": {"memory": [55462404096, 2429110050816], "load": 3.3}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 98, 'objective/kl': 26.854412078857422, 'objective/entropy': 41.08890151977539, 'objective/non_score_reward': -1.342720627784729, 'objective/rlhf_reward': -2.2657814025878906, 'objective/scores': -0.9230610132217407, 'policy/approxkl_avg': 1.2586462497711182, 'policy/clipfrac_avg': 0.27032190561294556, 'loss/policy_avg': 0.13246116042137146, 'loss/value_avg': 2.3481881618499756, 'val/clipfrac_avg': 0.3575592339038849, 'policy/entropy_avg': 0.7781448364257812, 'val/ratio': 0.965839147567749, 'val/ratio_var': 0.0011774093145504594, 'val/num_eos_tokens': 0, 'lr': 4.791666666666667e-05, 'episode': 1408, 'epoch': 0.26}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  4%|\u258d         | 1/24 [00:14<03:56, 10.27s/it]\r  8%|\u258a         | 2/24 [00:14<02:24,  6.57s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 115, 'objective/kl': 43.823326110839844, 'objective/entropy': 14.519155502319336, 'objective/non_score_reward': -2.1911661624908447, 'objective/rlhf_reward': -3.15301513671875, 'objective/scores': -0.9618489742279053, 'policy/approxkl_avg': 1.340342402458191, 'policy/clipfrac_avg': 0.1767192780971527, 'loss/policy_avg': 0.09410620480775833, 'loss/value_avg': 1.9443039894104004, 'val/clipfrac_avg': 0.351046621799469, 'policy/entropy_avg': 0.34605497121810913, 'val/ratio': 0.9695148468017578, 'val/ratio_var': 0.001474845572374761, 'val/num_eos_tokens': 0, 'lr': 4.5833333333333334e-05, 'episode': 2112, 'epoch': 0.39}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 2/24 [00:18<02:24,  6.57s/it]\r 12%|\u2588\u258e        | 3/24 [00:18<01:54,  5.43s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031449.8708022, "gpudata": {"0": {"memory": [14028.5625, 81559.0], "load": 0.0, "temperature": 35.0, "power": 129.435}, "1": {"memory": [14640.5625, 81559.0], "load": 0.0, "temperature": 39.0, "power": 132.303}, "2": {"memory": [13332.5625, 81559.0], "load": 0.0, "temperature": 39.0, "power": 132.627}, "3": {"memory": [13512.5625, 81559.0], "load": 0.0, "temperature": 34.0, "power": 126.461}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031449.8708022, "iodata": {"read_count": 0, "write_count": 1820, "read_bytes": 0, "read_time": 0, "write_time": 70, "busy_time": 696}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031449.8708022, "netdata": {"bytes_sent": 111165193503, "bytes_recv": 801221312541, "packets_sent": 256458383, "packets_recv": 673928000, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031449.8708022, "cpudata": {"memory": [65370673152, 2429110050816], "load": 7.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 61.1221923828125, 'objective/entropy': 12.311054229736328, 'objective/non_score_reward': -3.0561094284057617, 'objective/rlhf_reward': -4.07907772064209, 'objective/scores': -1.0229676961898804, 'policy/approxkl_avg': 1.8017559051513672, 'policy/clipfrac_avg': 0.15941253304481506, 'loss/policy_avg': 0.0955326110124588, 'loss/value_avg': 1.930051565170288, 'val/clipfrac_avg': 0.26681095361709595, 'policy/entropy_avg': 0.26034820079803467, 'val/ratio': 0.9910998344421387, 'val/ratio_var': 0.005145231727510691, 'val/num_eos_tokens': 0, 'lr': 4.375e-05, 'episode': 2816, 'epoch': 0.52}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 12%|\u2588\u258e        | 3/24 [00:26<01:54,  5.43s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r 17%|\u2588\u258b        | 4/24 [00:26<02:13,  6.69s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031460.1158648, "gpudata": {"0": {"memory": [12624.5625, 81559.0], "load": 0.11, "temperature": 35.0, "power": 193.431}, "1": {"memory": [12830.5625, 81559.0], "load": 0.37, "temperature": 40.0, "power": 199.303}, "2": {"memory": [12620.5625, 81559.0], "load": 0.5, "temperature": 40.0, "power": 199.033}, "3": {"memory": [12592.5625, 81559.0], "load": 0.42, "temperature": 35.0, "power": 198.781}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031460.1158648, "iodata": {"read_count": 0, "write_count": 2086, "read_bytes": 0, "read_time": 0, "write_time": 78, "busy_time": 792}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031460.1158648, "netdata": {"bytes_sent": 111165284362, "bytes_recv": 801221332030, "packets_sent": 256458498, "packets_recv": 673928076, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031460.1158648, "cpudata": {"memory": [65821368320, 2429110050816], "load": 2.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 99, 'objective/kl': 41.47489547729492, 'objective/entropy': 3.81461763381958, 'objective/non_score_reward': -2.073744773864746, 'objective/rlhf_reward': -3.253648281097412, 'objective/scores': -1.179903507232666, 'policy/approxkl_avg': 0.6463647484779358, 'policy/clipfrac_avg': 0.07436615228652954, 'loss/policy_avg': 0.02940964139997959, 'loss/value_avg': 1.6011617183685303, 'val/clipfrac_avg': 0.3247815668582916, 'policy/entropy_avg': 0.10306882858276367, 'val/ratio': 0.9871988296508789, 'val/ratio_var': 0.0004967594286426902, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-05, 'episode': 3520, 'epoch': 0.65}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 17%|\u2588\u258b        | 4/24 [00:35<02:13,  6.69s/it]\r 21%|\u2588\u2588        | 5/24 [00:35<02:19,  7.34s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 49.88418960571289, 'objective/entropy': 5.947641372680664, 'objective/non_score_reward': -2.4942095279693604, 'objective/rlhf_reward': -3.6018314361572266, 'objective/scores': -1.107621669769287, 'policy/approxkl_avg': 1.3640748262405396, 'policy/clipfrac_avg': 0.11455430090427399, 'loss/policy_avg': 0.054105207324028015, 'loss/value_avg': 1.6658375263214111, 'val/clipfrac_avg': 0.35256755352020264, 'policy/entropy_avg': 0.15853801369667053, 'val/ratio': 0.9658792018890381, 'val/ratio_var': 0.000594017212279141, 'val/num_eos_tokens': 0, 'lr': 3.958333333333333e-05, 'episode': 4224, 'epoch': 0.78}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 21%|\u2588\u2588        | 5/24 [00:39<02:19,  7.34s/it]\r 25%|\u2588\u2588\u258c       | 6/24 [00:39<01:52,  6.24s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 113, 'objective/kl': 33.421653747558594, 'objective/entropy': 2.20479679107666, 'objective/non_score_reward': -1.671082615852356, 'objective/rlhf_reward': -3.014822483062744, 'objective/scores': -1.3437402248382568, 'policy/approxkl_avg': 0.8695321679115295, 'policy/clipfrac_avg': 0.056530073285102844, 'loss/policy_avg': 0.0146391112357378, 'loss/value_avg': 1.5107110738754272, 'val/clipfrac_avg': 0.3823970854282379, 'policy/entropy_avg': 0.09018369019031525, 'val/ratio': 0.981425940990448, 'val/ratio_var': 0.0005483469576574862, 'val/num_eos_tokens': 0, 'lr': 3.7500000000000003e-05, 'episode': 4928, 'epoch': 0.91}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 25%|\u2588\u2588\u258c       | 6/24 [00:43<01:52,  6.24s/it]\r 29%|\u2588\u2588\u2589       | 7/24 [00:43<01:33,  5.49s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 4517.431186114871, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11692.63155463093, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11347.244677382418, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 5428.685154025274, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 5602.900456469865, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11574.769155090624, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11905.169454508748, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031470.1444223, "gpudata": {"0": {"memory": [13446.5625, 81559.0], "load": 0.29, "temperature": 41.0, "power": 231.032}, "1": {"memory": [13654.5625, 81559.0], "load": 0.45, "temperature": 45.0, "power": 234.591}, "2": {"memory": [13444.5625, 81559.0], "load": 0.21, "temperature": 45.0, "power": 231.023}, "3": {"memory": [13424.5625, 81559.0], "load": 0.18, "temperature": 40.0, "power": 228.525}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031470.1444223, "iodata": {"read_count": 0, "write_count": 2180, "read_bytes": 0, "read_time": 0, "write_time": 81, "busy_time": 920}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031470.1444223, "netdata": {"bytes_sent": 111165295642, "bytes_recv": 801221343438, "packets_sent": 256458542, "packets_recv": 673928118, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031470.1444223, "cpudata": {"memory": [66086232064, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 118, 'objective/kl': 20.972728729248047, 'objective/entropy': 0.5468426942825317, 'objective/non_score_reward': -1.0486364364624023, 'objective/rlhf_reward': -2.4537253379821777, 'objective/scores': -1.4050886631011963, 'policy/approxkl_avg': 0.035390183329582214, 'policy/clipfrac_avg': 0.011102326214313507, 'loss/policy_avg': 0.005682823248207569, 'loss/value_avg': 1.2879350185394287, 'val/clipfrac_avg': 0.4394899904727936, 'policy/entropy_avg': 0.019870413467288017, 'val/ratio': 0.9989278316497803, 'val/ratio_var': 0.00010932662553386763, 'val/num_eos_tokens': 0, 'lr': 3.541666666666667e-05, 'episode': 5632, 'epoch': 1.04}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 29%|\u2588\u2588\u2589       | 7/24 [00:47<01:33,  5.49s/it]\r 33%|\u2588\u2588\u2588\u258e      | 8/24 [00:47<01:19,  4.98s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 123, 'objective/kl': 19.836177825927734, 'objective/entropy': 0.29730504751205444, 'objective/non_score_reward': -0.9918088316917419, 'objective/rlhf_reward': -2.412806510925293, 'objective/scores': -1.4209976196289062, 'policy/approxkl_avg': 0.02802112326025963, 'policy/clipfrac_avg': 0.00735018216073513, 'loss/policy_avg': 0.003719469765201211, 'loss/value_avg': 1.1678184270858765, 'val/clipfrac_avg': 0.39878591895103455, 'policy/entropy_avg': 0.010566134005784988, 'val/ratio': 0.9970629215240479, 'val/ratio_var': 8.200750016840175e-06, 'val/num_eos_tokens': 0, 'lr': 3.3333333333333335e-05, 'episode': 6336, 'epoch': 1.17}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 33%|\u2588\u2588\u2588\u258e      | 8/24 [00:51<01:19,  4.98s/it]\r 38%|\u2588\u2588\u2588\u258a      | 9/24 [00:51<01:10,  4.73s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031480.1627584, "gpudata": {"0": {"memory": [12622.5625, 81559.0], "load": 0.64, "temperature": 39.0, "power": 376.397}, "1": {"memory": [35252.5625, 81559.0], "load": 0.2, "temperature": 44.0, "power": 363.138}, "2": {"memory": [12622.5625, 81559.0], "load": 0.46, "temperature": 44.0, "power": 369.651}, "3": {"memory": [30616.5625, 81559.0], "load": 0.45, "temperature": 38.0, "power": 367.579}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031480.1627584, "iodata": {"read_count": 0, "write_count": 2258, "read_bytes": 0, "read_time": 0, "write_time": 82, "busy_time": 1020}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031480.1627584, "netdata": {"bytes_sent": 111165357136, "bytes_recv": 801221380755, "packets_sent": 256458627, "packets_recv": 673928192, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031480.1627584, "cpudata": {"memory": [66321907712, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 126, 'objective/kl': 19.435077667236328, 'objective/entropy': 0.14399226009845734, 'objective/non_score_reward': -0.9717538356781006, 'objective/rlhf_reward': -2.409114360809326, 'objective/scores': -1.4373605251312256, 'policy/approxkl_avg': 0.010238153859972954, 'policy/clipfrac_avg': 0.00300171528942883, 'loss/policy_avg': 0.003499063663184643, 'loss/value_avg': 1.0944801568984985, 'val/clipfrac_avg': 0.30983999371528625, 'policy/entropy_avg': 0.004366614390164614, 'val/ratio': 0.999592661857605, 'val/ratio_var': 3.082875764448545e-06, 'val/num_eos_tokens': 0, 'lr': 3.125e-05, 'episode': 7040, 'epoch': 1.3}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 38%|\u2588\u2588\u2588\u258a      | 9/24 [00:55<01:10,  4.73s/it]\r 42%|\u2588\u2588\u2588\u2588\u258f     | 10/24 [00:55<01:03,  4.53s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 128, 'objective/kl': 18.907978057861328, 'objective/entropy': 0.05319646745920181, 'objective/non_score_reward': -0.9453988075256348, 'objective/rlhf_reward': -2.397458076477051, 'objective/scores': -1.452059268951416, 'policy/approxkl_avg': 0.004435772076249123, 'policy/clipfrac_avg': 0.0012127466034144163, 'loss/policy_avg': 0.0011242515174672008, 'loss/value_avg': 1.0011096000671387, 'val/clipfrac_avg': 0.25307542085647583, 'policy/entropy_avg': 0.0020810519345104694, 'val/ratio': 0.999893069267273, 'val/ratio_var': 1.9995275124529144e-06, 'val/num_eos_tokens': 0, 'lr': 2.916666666666667e-05, 'episode': 7744, 'epoch': 1.43}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 42%|\u2588\u2588\u2588\u2588\u258f     | 10/24 [01:00<01:03,  4.53s/it]\r 46%|\u2588\u2588\u2588\u2588\u258c     | 11/24 [01:00<00:58,  4.50s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031490.3433673, "gpudata": {"0": {"memory": [12624.5625, 81559.0], "load": 0.7, "temperature": 39.0, "power": 273.368}, "1": {"memory": [30854.5625, 81559.0], "load": 0.78, "temperature": 44.0, "power": 278.33}, "2": {"memory": [12622.5625, 81559.0], "load": 0.64, "temperature": 44.0, "power": 271.867}, "3": {"memory": [31852.5625, 81559.0], "load": 0.51, "temperature": 38.0, "power": 269.699}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031490.3433673, "iodata": {"read_count": 0, "write_count": 2373, "read_bytes": 0, "read_time": 0, "write_time": 83, "busy_time": 1116}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031490.3433673, "netdata": {"bytes_sent": 111165444773, "bytes_recv": 801221394348, "packets_sent": 256458728, "packets_recv": 673928258, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031490.3433673, "cpudata": {"memory": [66481004544, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 132, 'objective/kl': 19.167118072509766, 'objective/entropy': 0.07874053716659546, 'objective/non_score_reward': -0.9583560228347778, 'objective/rlhf_reward': -2.4121131896972656, 'objective/scores': -1.4537570476531982, 'policy/approxkl_avg': 0.011076396331191063, 'policy/clipfrac_avg': 0.001648263307288289, 'loss/policy_avg': 0.0007314137183129787, 'loss/value_avg': 0.9154618978500366, 'val/clipfrac_avg': 0.21441492438316345, 'policy/entropy_avg': 0.0022761065047234297, 'val/ratio': 0.9992760419845581, 'val/ratio_var': 2.4899829895730363e-06, 'val/num_eos_tokens': 0, 'lr': 2.7083333333333332e-05, 'episode': 8448, 'epoch': 1.56}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 46%|\u2588\u2588\u2588\u2588\u258c     | 11/24 [01:03<00:58,  4.50s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 12/24 [01:03<00:51,  4.31s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 134, 'objective/kl': 19.073284149169922, 'objective/entropy': 0.020122192800045013, 'objective/non_score_reward': -0.9536643028259277, 'objective/rlhf_reward': -2.4090089797973633, 'objective/scores': -1.4553446769714355, 'policy/approxkl_avg': 0.001240174169652164, 'policy/clipfrac_avg': 0.0006566251977346838, 'loss/policy_avg': 0.0001874708104878664, 'loss/value_avg': 0.8910754919052124, 'val/clipfrac_avg': 0.14333191514015198, 'policy/entropy_avg': 0.0011520112166181207, 'val/ratio': 0.9995659589767456, 'val/ratio_var': 6.773530714099252e-08, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 9152, 'epoch': 1.69}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 12/24 [01:07<00:51,  4.31s/it]\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 13/24 [01:07<00:46,  4.20s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 137, 'objective/kl': 18.979103088378906, 'objective/entropy': 0.025874119251966476, 'objective/non_score_reward': -0.9489551186561584, 'objective/rlhf_reward': -2.4122424125671387, 'objective/scores': -1.463287353515625, 'policy/approxkl_avg': 0.0006991755217313766, 'policy/clipfrac_avg': 0.0005226200446486473, 'loss/policy_avg': 0.00013414269778877497, 'loss/value_avg': 0.8572431802749634, 'val/clipfrac_avg': 0.11468830704689026, 'policy/entropy_avg': 0.0010245894081890583, 'val/ratio': 0.9996904134750366, 'val/ratio_var': 3.029176909308262e-08, 'val/num_eos_tokens': 0, 'lr': 2.2916666666666667e-05, 'episode': 9856, 'epoch': 1.82}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 13/24 [01:11<00:46,  4.20s/it]\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 14/24 [01:11<00:41,  4.13s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12194.437876609441, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11326.53632169218, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11618.795747418588, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 10533.578326122279, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12071.430806198661, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11771.23109293069, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11851.133943407285, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031500.4000258, "gpudata": {"0": {"memory": [12622.5625, 81559.0], "load": 0.78, "temperature": 39.0, "power": 390.725}, "1": {"memory": [34204.5625, 81559.0], "load": 0.64, "temperature": 44.0, "power": 401.515}, "2": {"memory": [36946.5625, 81559.0], "load": 0.77, "temperature": 44.0, "power": 389.468}, "3": {"memory": [30864.5625, 81559.0], "load": 0.82, "temperature": 39.0, "power": 390.287}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031500.4000258, "iodata": {"read_count": 0, "write_count": 2574, "read_bytes": 0, "read_time": 0, "write_time": 89, "busy_time": 1220}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031500.4000258, "netdata": {"bytes_sent": 111165459319, "bytes_recv": 801221416860, "packets_sent": 256458808, "packets_recv": 673928338, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031500.4000258, "cpudata": {"memory": [66565943296, 2429110050816], "load": 6.3}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 139, 'objective/kl': 19.017972946166992, 'objective/entropy': 0.03408931568264961, 'objective/non_score_reward': -0.9508986473083496, 'objective/rlhf_reward': -2.423491954803467, 'objective/scores': -1.4725933074951172, 'policy/approxkl_avg': 0.0025613801553845406, 'policy/clipfrac_avg': 0.00073702831286937, 'loss/policy_avg': 0.00026574148796498775, 'loss/value_avg': 0.8339571356773376, 'val/clipfrac_avg': 0.017005253583192825, 'policy/entropy_avg': 0.0012699770741164684, 'val/ratio': 0.9996616244316101, 'val/ratio_var': 8.977303878054954e-08, 'val/num_eos_tokens': 0, 'lr': 2.0833333333333336e-05, 'episode': 10560, 'epoch': 1.95}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 14/24 [01:15<00:41,  4.13s/it]\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 15/24 [01:15<00:36,  4.08s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 141, 'objective/kl': 19.125102996826172, 'objective/entropy': 0.04580092430114746, 'objective/non_score_reward': -0.9562550783157349, 'objective/rlhf_reward': -2.416273832321167, 'objective/scores': -1.4600186347961426, 'policy/approxkl_avg': 0.0045328084379434586, 'policy/clipfrac_avg': 0.000663325481582433, 'loss/policy_avg': 0.00045503678848035634, 'loss/value_avg': 0.8360388278961182, 'val/clipfrac_avg': 0.05280473083257675, 'policy/entropy_avg': 0.0011080362601205707, 'val/ratio': 0.9998345971107483, 'val/ratio_var': 1.8375590116193052e-07, 'val/num_eos_tokens': 0, 'lr': 1.8750000000000002e-05, 'episode': 11264, 'epoch': 2.08}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 15/24 [01:19<00:36,  4.08s/it]\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 16/24 [01:19<00:32,  4.04s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 142, 'objective/kl': 18.865156173706055, 'objective/entropy': 0.05349023640155792, 'objective/non_score_reward': -0.9432578086853027, 'objective/rlhf_reward': -2.409231424331665, 'objective/scores': -1.4659737348556519, 'policy/approxkl_avg': 0.0026314333081245422, 'policy/clipfrac_avg': 0.000710227235686034, 'loss/policy_avg': 0.0010643044952303171, 'loss/value_avg': 0.8362854719161987, 'val/clipfrac_avg': 0.0006901265005581081, 'policy/entropy_avg': 0.0012244204990565777, 'val/ratio': 1.0001004934310913, 'val/ratio_var': 6.642742391704815e-07, 'val/num_eos_tokens': 0, 'lr': 1.6666666666666667e-05, 'episode': 11968, 'epoch': 2.21}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 16/24 [01:23<00:32,  4.04s/it]\r 71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 17/24 [01:23<00:28,  4.03s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [17, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031510.4372973, "gpudata": {"0": {"memory": [13434.5625, 81559.0], "load": 0.58, "temperature": 41.0, "power": 234.845}, "1": {"memory": [13630.5625, 81559.0], "load": 0.79, "temperature": 46.0, "power": 243.873}, "2": {"memory": [13434.5625, 81559.0], "load": 0.34, "temperature": 46.0, "power": 241.15}, "3": {"memory": [13392.5625, 81559.0], "load": 0.34, "temperature": 40.0, "power": 232.923}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031510.4372973, "iodata": {"read_count": 0, "write_count": 3012, "read_bytes": 0, "read_time": 0, "write_time": 98, "busy_time": 1316}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031510.4372973, "netdata": {"bytes_sent": 111165522771, "bytes_recv": 801221450213, "packets_sent": 256458901, "packets_recv": 673928418, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031510.4372973, "cpudata": {"memory": [66573037568, 2429110050816], "load": 6.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 144, 'objective/kl': 19.452199935913086, 'objective/entropy': 0.021598976105451584, 'objective/non_score_reward': -0.9726099967956543, 'objective/rlhf_reward': -2.4403443336486816, 'objective/scores': -1.4677345752716064, 'policy/approxkl_avg': 0.0005615232512354851, 'policy/clipfrac_avg': 0.00035511364694684744, 'loss/policy_avg': 0.00020548894826788455, 'loss/value_avg': 0.8279372453689575, 'val/clipfrac_avg': 0.004891187883913517, 'policy/entropy_avg': 0.0010009539546445012, 'val/ratio': 0.9996286034584045, 'val/ratio_var': 4.344885695672929e-08, 'val/num_eos_tokens': 0, 'lr': 1.4583333333333335e-05, 'episode': 12672, 'epoch': 2.34}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 17/24 [01:27<00:28,  4.03s/it]\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 18/24 [01:27<00:24,  4.01s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [18, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 145, 'objective/kl': 18.753252029418945, 'objective/entropy': 0.05530780553817749, 'objective/non_score_reward': -0.9376626014709473, 'objective/rlhf_reward': -2.3974921703338623, 'objective/scores': -1.4598296880722046, 'policy/approxkl_avg': 0.0014309992548078299, 'policy/clipfrac_avg': 0.0006700257072225213, 'loss/policy_avg': 0.00028238585218787193, 'loss/value_avg': 0.8312421441078186, 'val/clipfrac_avg': 0.0006298241787590086, 'policy/entropy_avg': 0.001252668211236596, 'val/ratio': 1.0000486373901367, 'val/ratio_var': 8.536786708646105e-07, 'val/num_eos_tokens': 0, 'lr': 1.25e-05, 'episode': 13376, 'epoch': 2.47}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 18/24 [01:32<00:24,  4.01s/it]\r 79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 19/24 [01:32<00:20,  4.10s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [19, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031520.4553795, "gpudata": {"0": {"memory": [45028.5625, 81559.0], "load": 0.16, "temperature": 46.0, "power": 381.283}, "1": {"memory": [44942.5625, 81559.0], "load": 0.48, "temperature": 50.0, "power": 399.281}, "2": {"memory": [44958.5625, 81559.0], "load": 0.2, "temperature": 50.0, "power": 397.892}, "3": {"memory": [44702.5625, 81559.0], "load": 0.45, "temperature": 45.0, "power": 401.144}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031520.4553795, "iodata": {"read_count": 0, "write_count": 3163, "read_bytes": 0, "read_time": 0, "write_time": 101, "busy_time": 1428}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031520.4553795, "netdata": {"bytes_sent": 111165610855, "bytes_recv": 801221463806, "packets_sent": 256459004, "packets_recv": 673928484, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031520.4553795, "cpudata": {"memory": [66702172160, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 146, 'objective/kl': 19.151132583618164, 'objective/entropy': 0.04829414188861847, 'objective/non_score_reward': -0.9575566053390503, 'objective/rlhf_reward': -2.4007134437561035, 'objective/scores': -1.4431569576263428, 'policy/approxkl_avg': 0.0012277495115995407, 'policy/clipfrac_avg': 0.0006901265005581081, 'loss/policy_avg': 0.00045168492943048477, 'loss/value_avg': 0.8477623462677002, 'val/clipfrac_avg': 0.0005025193095207214, 'policy/entropy_avg': 0.001045128796249628, 'val/ratio': 1.000044822692871, 'val/ratio_var': 1.4937889147859096e-07, 'val/num_eos_tokens': 0, 'lr': 1.0416666666666668e-05, 'episode': 14080, 'epoch': 2.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 19/24 [01:35<00:20,  4.10s/it]\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 20/24 [01:35<00:16,  4.03s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [20, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 148, 'objective/kl': 18.511741638183594, 'objective/entropy': 0.027823954820632935, 'objective/non_score_reward': -0.9255871772766113, 'objective/rlhf_reward': -2.382331132888794, 'objective/scores': -1.4567439556121826, 'policy/approxkl_avg': 0.000965361250564456, 'policy/clipfrac_avg': 0.000489118741825223, 'loss/policy_avg': 0.00043079297756776214, 'loss/value_avg': 0.8428352475166321, 'val/clipfrac_avg': 0.0009849377674981952, 'policy/entropy_avg': 0.0008388027781620622, 'val/ratio': 0.9999529123306274, 'val/ratio_var': 8.11697944413936e-08, 'val/num_eos_tokens': 0, 'lr': 8.333333333333334e-06, 'episode': 14784, 'epoch': 2.74}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 20/24 [01:39<00:16,  4.03s/it]\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 21/24 [01:39<00:12,  4.01s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11893.913873334503, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11881.866075254218, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11928.744122113018, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11578.902222379707, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 10866.83140815749, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11993.37768841498, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12100.93076291752, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 149, 'objective/kl': 18.92154312133789, 'objective/entropy': 0.01714252308011055, 'objective/non_score_reward': -0.9460772275924683, 'objective/rlhf_reward': -2.4271957874298096, 'objective/scores': -1.4811186790466309, 'policy/approxkl_avg': 0.0006562240305356681, 'policy/clipfrac_avg': 0.0003216123441234231, 'loss/policy_avg': 0.0005126531468704343, 'loss/value_avg': 0.8323520421981812, 'val/clipfrac_avg': 0.0003283125988673419, 'policy/entropy_avg': 0.0007079756469465792, 'val/ratio': 0.9997801780700684, 'val/ratio_var': 2.0394271160739663e-08, 'val/num_eos_tokens': 0, 'lr': 6.25e-06, 'episode': 15488, 'epoch': 2.87}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 21/24 [01:43<00:12,  4.01s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 22/24 [01:43<00:08,  4.01s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [22, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031530.4937367, "gpudata": {"0": {"memory": [12624.5625, 81559.0], "load": 0.25, "temperature": 38.0, "power": 213.113}, "1": {"memory": [13666.5625, 81559.0], "load": 0.63, "temperature": 46.0, "power": 223.202}, "2": {"memory": [13446.5625, 81559.0], "load": 0.4, "temperature": 47.0, "power": 223.059}, "3": {"memory": [13416.5625, 81559.0], "load": 0.14, "temperature": 41.0, "power": 213.764}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031530.4937367, "iodata": {"read_count": 0, "write_count": 3271, "read_bytes": 0, "read_time": 0, "write_time": 103, "busy_time": 1532}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031530.4937367, "netdata": {"bytes_sent": 111165622255, "bytes_recv": 801221475414, "packets_sent": 256459050, "packets_recv": 673928528, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031530.4937367, "cpudata": {"memory": [66811723776, 2429110050816], "load": 6.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 150, 'objective/kl': 18.742191314697266, 'objective/entropy': 0.022151760756969452, 'objective/non_score_reward': -0.9371095895767212, 'objective/rlhf_reward': -2.3824398517608643, 'objective/scores': -1.4453301429748535, 'policy/approxkl_avg': 0.0008667358197271824, 'policy/clipfrac_avg': 0.00035511364694684744, 'loss/policy_avg': 0.00024153318372555077, 'loss/value_avg': 0.8297135829925537, 'val/clipfrac_avg': 0.0003953151754103601, 'policy/entropy_avg': 0.0007555800257250667, 'val/ratio': 0.9997932314872742, 'val/ratio_var': 4.2883097961521344e-08, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-06, 'episode': 16192, 'epoch': 3.0}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 22/24 [01:47<00:08,  4.01s/it]\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 23/24 [01:47<00:04,  4.00s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [23, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 151, 'objective/kl': 18.832820892333984, 'objective/entropy': 0.056399568915367126, 'objective/non_score_reward': -0.9416410326957703, 'objective/rlhf_reward': -2.394866466522217, 'objective/scores': -1.4532256126403809, 'policy/approxkl_avg': 0.001344230491667986, 'policy/clipfrac_avg': 0.0004154159687459469, 'loss/policy_avg': 0.0005344698438420892, 'loss/value_avg': 0.8403962254524231, 'val/clipfrac_avg': 0.00046901803580112755, 'policy/entropy_avg': 0.0009458590648137033, 'val/ratio': 0.9999823570251465, 'val/ratio_var': 3.474461323094147e-07, 'val/num_eos_tokens': 0, 'lr': 2.0833333333333334e-06, 'episode': 16896, 'epoch': 3.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 23/24 [01:51<00:04,  4.00s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 24/24 [01:51<00:00,  3.98s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 24/24 [01:51<00:00,  4.66s/it]\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 11791.503985318195, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11895.628611824775, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1212 14:25:38.957265354 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "176", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031541.0585485, "return_code": 0}, "pipe": null}
