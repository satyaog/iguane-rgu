{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-g002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-g002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-A100-SXM4-80GB_rlhf-gpus_270.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 64, "brand": "AMD EPYC 7543 32-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-g002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "0", "device": 0, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 36.0, "power": 62.5, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "1", "device": 1, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 61.063, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "2", "device": 2, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 36.0, "power": 63.041, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "3", "device": 3, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 62.719, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1733975928.621562, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX2", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "270", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733957928.7005801}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/16 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957955.4546266, "gpudata": {"0": {"memory": [5752.25, 81920.0], "load": 0.0, "temperature": 32.0, "power": 79.845}, "1": {"memory": [5824.25, 81920.0], "load": 0.0, "temperature": 29.0, "power": 78.923}, "2": {"memory": [5824.25, 81920.0], "load": 0.0, "temperature": 32.0, "power": 80.471}, "3": {"memory": [5752.25, 81920.0], "load": 0.0, "temperature": 29.0, "power": 80.286}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957955.4546266, "iodata": {"read_count": 0, "write_count": 44, "read_bytes": 0, "read_time": 0, "write_time": 4, "busy_time": 16}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957955.4546266, "netdata": {"bytes_sent": 252287135071, "bytes_recv": 672898764350, "packets_sent": 264482154, "packets_recv": 468049424, "errin": 0, "errout": 0, "dropin": 1341975, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957955.4546266, "cpudata": {"memory": [18671423488, 1076141588480], "load": 0.0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957965.4793558, "gpudata": {"0": {"memory": [62218.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 300.992}, "1": {"memory": [62606.25, 81920.0], "load": 0.95, "temperature": 40.0, "power": 355.82}, "2": {"memory": [62052.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 334.052}, "3": {"memory": [61520.25, 81920.0], "load": 1.0, "temperature": 36.0, "power": 107.897}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957965.4793558, "iodata": {"read_count": 0, "write_count": 171, "read_bytes": 0, "read_time": 0, "write_time": 20, "busy_time": 76}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957965.4793558, "netdata": {"bytes_sent": 252287241659, "bytes_recv": 672898788746, "packets_sent": 264482265, "packets_recv": 468049526, "errin": 0, "errout": 0, "dropin": 1341980, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957965.4793558, "cpudata": {"memory": [20371836928, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 68, 'objective/kl': 7.296527473954484e-05, 'objective/entropy': 93.9216079711914, 'objective/non_score_reward': -3.6482629184320103e-06, 'objective/rlhf_reward': -0.2965282201766968, 'objective/scores': -0.2965245246887207, 'policy/approxkl_avg': 1.8374285697937012, 'policy/clipfrac_avg': 0.39093726873397827, 'loss/policy_avg': 0.21686655282974243, 'loss/value_avg': 4.416154861450195, 'val/clipfrac_avg': 0.22230958938598633, 'policy/entropy_avg': 1.6530433893203735, 'val/ratio': 0.9702487587928772, 'val/ratio_var': 0.0008487658924423158, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 1080, 'epoch': 0.2}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/16 [00:15<?, ?it/s]\r  6%|\u258b         | 1/16 [00:15<03:57, 15.86s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957975.6420548, "gpudata": {"0": {"memory": [11208.25, 81920.0], "load": 0.92, "temperature": 38.0, "power": 97.095}, "1": {"memory": [11344.25, 81920.0], "load": 0.98, "temperature": 37.0, "power": 95.731}, "2": {"memory": [11540.25, 81920.0], "load": 0.98, "temperature": 38.0, "power": 97.207}, "3": {"memory": [11986.25, 81920.0], "load": 0.96, "temperature": 37.0, "power": 98.991}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957975.6420548, "iodata": {"read_count": 0, "write_count": 191, "read_bytes": 0, "read_time": 0, "write_time": 26, "busy_time": 104}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957975.6420548, "netdata": {"bytes_sent": 252287254030, "bytes_recv": 672898802636, "packets_sent": 264482316, "packets_recv": 468049597, "errin": 0, "errout": 0, "dropin": 1341985, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957975.6420548, "cpudata": {"memory": [20394897408, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 84, 'objective/kl': 20.944862365722656, 'objective/entropy': 46.183860778808594, 'objective/non_score_reward': -1.0472432374954224, 'objective/rlhf_reward': -1.2761725187301636, 'objective/scores': -0.22892940044403076, 'policy/approxkl_avg': 1.1592130661010742, 'policy/clipfrac_avg': 0.2729865610599518, 'loss/policy_avg': 0.14654985070228577, 'loss/value_avg': 2.363508701324463, 'val/clipfrac_avg': 0.35264238715171814, 'policy/entropy_avg': 0.8646113872528076, 'val/ratio': 0.9869304895401001, 'val/ratio_var': 0.0003907794307451695, 'val/num_eos_tokens': 0, 'lr': 4.6875e-05, 'episode': 2160, 'epoch': 0.4}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  6%|\u258b         | 1/16 [00:25<03:57, 15.86s/it]\r 12%|\u2588\u258e        | 2/16 [00:25<02:51, 12.28s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957985.669012, "gpudata": {"0": {"memory": [26680.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 311.098}, "1": {"memory": [27070.25, 81920.0], "load": 1.0, "temperature": 40.0, "power": 228.982}, "2": {"memory": [27048.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 204.925}, "3": {"memory": [28002.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 235.14}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957985.669012, "iodata": {"read_count": 0, "write_count": 207, "read_bytes": 0, "read_time": 0, "write_time": 27, "busy_time": 112}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957985.669012, "netdata": {"bytes_sent": 252287265978, "bytes_recv": 672898816052, "packets_sent": 264482364, "packets_recv": 468049664, "errin": 0, "errout": 0, "dropin": 1341990, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957985.669012, "cpudata": {"memory": [20408594432, 1076141588480], "load": 6.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 91, 'objective/kl': 27.112295150756836, 'objective/entropy': 15.155040740966797, 'objective/non_score_reward': -1.3556149005889893, 'objective/rlhf_reward': -1.5643895864486694, 'objective/scores': -0.20877480506896973, 'policy/approxkl_avg': 0.6326916813850403, 'policy/clipfrac_avg': 0.13991527259349823, 'loss/policy_avg': 0.08110010623931885, 'loss/value_avg': 2.289357900619507, 'val/clipfrac_avg': 0.31379279494285583, 'policy/entropy_avg': 0.37431496381759644, 'val/ratio': 0.9756186008453369, 'val/ratio_var': 0.0006933188415132463, 'val/num_eos_tokens': 1, 'lr': 4.375e-05, 'episode': 3240, 'epoch': 0.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 12%|\u2588\u258e        | 2/16 [00:35<02:51, 12.28s/it]\r 19%|\u2588\u2589        | 3/16 [00:35<02:25, 11.19s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957995.6854584, "gpudata": {"0": {"memory": [34472.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.337}, "1": {"memory": [34104.25, 81920.0], "load": 1.0, "temperature": 36.0, "power": 122.964}, "2": {"memory": [34182.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.449}, "3": {"memory": [47962.25, 81920.0], "load": 1.0, "temperature": 37.0, "power": 98.876}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957995.6854584, "iodata": {"read_count": 0, "write_count": 252, "read_bytes": 0, "read_time": 0, "write_time": 32, "busy_time": 152}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957995.6854584, "netdata": {"bytes_sent": 252287372837, "bytes_recv": 672898841636, "packets_sent": 264482480, "packets_recv": 468049771, "errin": 0, "errout": 0, "dropin": 1341995, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957995.6854584, "cpudata": {"memory": [20456050688, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 95, 'objective/kl': 43.002586364746094, 'objective/entropy': 16.06281280517578, 'objective/non_score_reward': -2.150129556655884, 'objective/rlhf_reward': -2.387105941772461, 'objective/scores': -0.23697638511657715, 'policy/approxkl_avg': 0.9988960027694702, 'policy/clipfrac_avg': 0.1519566774368286, 'loss/policy_avg': 0.08250080049037933, 'loss/value_avg': 2.233217239379883, 'val/clipfrac_avg': 0.2628363072872162, 'policy/entropy_avg': 0.3525175452232361, 'val/ratio': 0.9813223481178284, 'val/ratio_var': 0.0009602741920389235, 'val/num_eos_tokens': 2, 'lr': 4.0625000000000005e-05, 'episode': 4320, 'epoch': 0.8}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 19%|\u2588\u2589        | 3/16 [00:45<02:25, 11.19s/it]\r 25%|\u2588\u2588\u258c       | 4/16 [00:45<02:08, 10.67s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958006.0265892, "gpudata": {"0": {"memory": [47034.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.337}, "1": {"memory": [44220.25, 81920.0], "load": 1.0, "temperature": 36.0, "power": 95.482}, "2": {"memory": [38326.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.207}, "3": {"memory": [61946.25, 81920.0], "load": 1.0, "temperature": 36.0, "power": 98.344}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958006.0265892, "iodata": {"read_count": 0, "write_count": 298, "read_bytes": 0, "read_time": 0, "write_time": 35, "busy_time": 184}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958006.0265892, "netdata": {"bytes_sent": 252287384437, "bytes_recv": 672898855632, "packets_sent": 264482528, "packets_recv": 468049843, "errin": 0, "errout": 0, "dropin": 1342000, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958006.0265892, "cpudata": {"memory": [20442398720, 1076141588480], "load": 6.3}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 97, 'objective/kl': 34.411808013916016, 'objective/entropy': 5.560184955596924, 'objective/non_score_reward': -1.7205904722213745, 'objective/rlhf_reward': -1.9068946838378906, 'objective/scores': -0.18630409240722656, 'policy/approxkl_avg': 0.6439127922058105, 'policy/clipfrac_avg': 0.08247728645801544, 'loss/policy_avg': 0.06365188956260681, 'loss/value_avg': 2.2980170249938965, 'val/clipfrac_avg': 0.3266465663909912, 'policy/entropy_avg': 0.16347818076610565, 'val/ratio': 1.0121567249298096, 'val/ratio_var': 0.005056000780314207, 'val/num_eos_tokens': 0, 'lr': 3.7500000000000003e-05, 'episode': 5400, 'epoch': 1.0}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 25%|\u2588\u2588\u258c       | 4/16 [00:55<02:08, 10.67s/it]\r 31%|\u2588\u2588\u2588\u258f      | 5/16 [00:55<01:54, 10.40s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 4488.883428114593, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7407.107066640596, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7315.920718284194, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7469.680756153485, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7274.732608331886, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958016.366024, "gpudata": {"0": {"memory": [47032.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.627}, "1": {"memory": [62280.25, 81920.0], "load": 1.0, "temperature": 36.0, "power": 95.482}, "2": {"memory": [48044.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.449}, "3": {"memory": [61948.25, 81920.0], "load": 0.96, "temperature": 37.0, "power": 98.458}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958016.366024, "iodata": {"read_count": 0, "write_count": 340, "read_bytes": 0, "read_time": 0, "write_time": 38, "busy_time": 216}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958016.366024, "netdata": {"bytes_sent": 252287395951, "bytes_recv": 672898869194, "packets_sent": 264482575, "packets_recv": 468049912, "errin": 0, "errout": 0, "dropin": 1342005, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958016.366024, "cpudata": {"memory": [20455219200, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 99, 'objective/kl': 36.00397872924805, 'objective/entropy': 4.991366863250732, 'objective/non_score_reward': -1.8001987934112549, 'objective/rlhf_reward': -1.990199089050293, 'objective/scores': -0.19000017642974854, 'policy/approxkl_avg': 1.0062642097473145, 'policy/clipfrac_avg': 0.07493448257446289, 'loss/policy_avg': 0.04025585949420929, 'loss/value_avg': 2.314467668533325, 'val/clipfrac_avg': 0.31139063835144043, 'policy/entropy_avg': 0.12096564471721649, 'val/ratio': 0.9787770509719849, 'val/ratio_var': 0.00044472949230112135, 'val/num_eos_tokens': 0, 'lr': 3.4375e-05, 'episode': 6480, 'epoch': 1.2}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 31%|\u2588\u2588\u2588\u258f      | 5/16 [01:05<01:54, 10.40s/it]\r 38%|\u2588\u2588\u2588\u258a      | 6/16 [01:05<01:42, 10.23s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958026.4355166, "gpudata": {"0": {"memory": [61986.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 376.419}, "1": {"memory": [62606.25, 81920.0], "load": 0.92, "temperature": 43.0, "power": 335.545}, "2": {"memory": [63236.25, 81920.0], "load": 1.0, "temperature": 47.0, "power": 384.666}, "3": {"memory": [61946.25, 81920.0], "load": 1.0, "temperature": 40.0, "power": 114.355}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958026.4355166, "iodata": {"read_count": 0, "write_count": 360, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 240}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958026.4355166, "netdata": {"bytes_sent": 252287500707, "bytes_recv": 672898893924, "packets_sent": 264482686, "packets_recv": 468050018, "errin": 0, "errout": 0, "dropin": 1342010, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958026.4355166, "cpudata": {"memory": [20456607744, 1076141588480], "load": 6.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 100, 'objective/kl': 29.724403381347656, 'objective/entropy': 2.923877716064453, 'objective/non_score_reward': -1.486220121383667, 'objective/rlhf_reward': -1.7327704429626465, 'objective/scores': -0.24655044078826904, 'policy/approxkl_avg': 0.40456146001815796, 'policy/clipfrac_avg': 0.05670423060655594, 'loss/policy_avg': 0.03939608484506607, 'loss/value_avg': 2.166738510131836, 'val/clipfrac_avg': 0.3373558521270752, 'policy/entropy_avg': 0.08106928318738937, 'val/ratio': 0.9926092624664307, 'val/ratio_var': 0.0003000429423991591, 'val/num_eos_tokens': 2, 'lr': 3.125e-05, 'episode': 7560, 'epoch': 1.4}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 38%|\u2588\u2588\u2588\u258a      | 6/16 [01:15<01:42, 10.23s/it]\r 44%|\u2588\u2588\u2588\u2588\u258d     | 7/16 [01:15<01:31, 10.15s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958036.478039, "gpudata": {"0": {"memory": [62218.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 334.761}, "1": {"memory": [62050.25, 81920.0], "load": 0.96, "temperature": 44.0, "power": 376.644}, "2": {"memory": [62258.25, 81920.0], "load": 1.0, "temperature": 48.0, "power": 337.422}, "3": {"memory": [61520.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 239.954}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958036.478039, "iodata": {"read_count": 0, "write_count": 387, "read_bytes": 0, "read_time": 0, "write_time": 43, "busy_time": 256}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958036.478039, "netdata": {"bytes_sent": 252287513078, "bytes_recv": 672898907634, "packets_sent": 264482737, "packets_recv": 468050087, "errin": 0, "errout": 0, "dropin": 1342015, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958036.478039, "cpudata": {"memory": [20455858176, 1076141588480], "load": 6.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 101, 'objective/kl': 28.227293014526367, 'objective/entropy': 2.0446221828460693, 'objective/non_score_reward': -1.4113645553588867, 'objective/rlhf_reward': -1.6286036968231201, 'objective/scores': -0.2172389030456543, 'policy/approxkl_avg': 0.4293704926967621, 'policy/clipfrac_avg': 0.044636618345975876, 'loss/policy_avg': 0.024969162419438362, 'loss/value_avg': 2.110675811767578, 'val/clipfrac_avg': 0.3322632610797882, 'policy/entropy_avg': 0.05927825719118118, 'val/ratio': 0.9862040281295776, 'val/ratio_var': 0.0002158816932933405, 'val/num_eos_tokens': 0, 'lr': 2.8125000000000003e-05, 'episode': 8640, 'epoch': 1.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 44%|\u2588\u2588\u2588\u2588\u258d     | 7/16 [01:25<01:31, 10.15s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 8/16 [01:25<01:20, 10.09s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958046.5860214, "gpudata": {"0": {"memory": [62218.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 340.366}, "1": {"memory": [39564.25, 81920.0], "load": 0.93, "temperature": 39.0, "power": 96.692}, "2": {"memory": [38954.25, 81920.0], "load": 0.93, "temperature": 42.0, "power": 100.47}, "3": {"memory": [30226.25, 81920.0], "load": 0.94, "temperature": 38.0, "power": 99.415}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958046.5860214, "iodata": {"read_count": 0, "write_count": 411, "read_bytes": 0, "read_time": 0, "write_time": 45, "busy_time": 288}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958046.5860214, "netdata": {"bytes_sent": 252287525026, "bytes_recv": 672898921426, "packets_sent": 264482785, "packets_recv": 468050158, "errin": 0, "errout": 0, "dropin": 1342021, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958046.5860214, "cpudata": {"memory": [20452810752, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              ", "pipe": "stderr"}
{"event": "line", "data": "\r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 102, 'objective/kl': 34.721500396728516, 'objective/entropy': 4.528106689453125, 'objective/non_score_reward': -1.7360749244689941, 'objective/rlhf_reward': -1.9230031967163086, 'objective/scores': -0.18692827224731445, 'policy/approxkl_avg': 0.2791218161582947, 'policy/clipfrac_avg': 0.07202567905187607, 'loss/policy_avg': 0.047989875078201294, 'loss/value_avg': 1.9295704364776611, 'val/clipfrac_avg': 0.2948593497276306, 'policy/entropy_avg': 0.1298438310623169, 'val/ratio': 0.9930101633071899, 'val/ratio_var': 0.0002930526388809085, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 9720, 'epoch': 1.8}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 8/16 [01:35<01:20, 10.09s/it]\r 56%|\u2588\u2588\u2588\u2588\u2588\u258b    | 9/16 [01:35<01:10, 10.05s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 103, 'objective/kl': 26.477371215820312, 'objective/entropy': 2.477881908416748, 'objective/non_score_reward': -1.3238685131072998, 'objective/rlhf_reward': -1.5110976696014404, 'objective/scores': -0.18722915649414062, 'policy/approxkl_avg': 0.12520506978034973, 'policy/clipfrac_avg': 0.03026292845606804, 'loss/policy_avg': 0.02261105179786682, 'loss/value_avg': 1.8740043640136719, 'val/clipfrac_avg': 0.2563984990119934, 'policy/entropy_avg': 0.06338642537593842, 'val/ratio': 0.9968023896217346, 'val/ratio_var': 0.00010406073852209374, 'val/num_eos_tokens': 0, 'lr': 2.1875e-05, 'episode': 10800, 'epoch': 2.0}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 56%|\u2588\u2588\u2588\u2588\u2588\u258b    | 9/16 [01:44<01:10, 10.05s/it]\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 10/16 [01:44<00:59,  9.87s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7365.196207806401, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7271.402588557657, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7193.295164638698, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7214.570545090722, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7662.820374519703, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958056.850612, "gpudata": {"0": {"memory": [12564.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 210.886}, "1": {"memory": [12582.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 206.042}, "2": {"memory": [12702.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 214.093}, "3": {"memory": [12722.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 207.108}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958056.850612, "iodata": {"read_count": 0, "write_count": 442, "read_bytes": 0, "read_time": 0, "write_time": 49, "busy_time": 312}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958056.850612, "netdata": {"bytes_sent": 252287633876, "bytes_recv": 672898959607, "packets_sent": 264482936, "packets_recv": 468050306, "errin": 0, "errout": 0, "dropin": 1342026, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958056.850612, "cpudata": {"memory": [20472537088, 1076141588480], "load": 6.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 103, 'objective/kl': 27.798160552978516, 'objective/entropy': 1.8572394847869873, 'objective/non_score_reward': -1.3899080753326416, 'objective/rlhf_reward': -1.5985713005065918, 'objective/scores': -0.2086634635925293, 'policy/approxkl_avg': 0.21454864740371704, 'policy/clipfrac_avg': 0.024475891143083572, 'loss/policy_avg': 0.01715032011270523, 'loss/value_avg': 1.858790636062622, 'val/clipfrac_avg': 0.20360326766967773, 'policy/entropy_avg': 0.038128744810819626, 'val/ratio': 0.999029278755188, 'val/ratio_var': 0.00026609207270666957, 'val/num_eos_tokens': 0, 'lr': 1.8750000000000002e-05, 'episode': 11880, 'epoch': 2.2}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 10/16 [01:54<00:59,  9.87s/it]\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 11/16 [01:54<00:49,  9.88s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958066.8755245, "gpudata": {"0": {"memory": [14392.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 203.62}, "1": {"memory": [14432.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 183.084}, "2": {"memory": [14452.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 213.852}, "3": {"memory": [14746.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 199.611}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958066.8755245, "iodata": {"read_count": 0, "write_count": 467, "read_bytes": 0, "read_time": 0, "write_time": 50, "busy_time": 336}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958066.8755245, "netdata": {"bytes_sent": 252287645604, "bytes_recv": 672898973351, "packets_sent": 264482986, "packets_recv": 468050376, "errin": 0, "errout": 0, "dropin": 1342031, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958066.8755245, "cpudata": {"memory": [20470132736, 1076141588480], "load": 6.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 20.05310821533203, 'objective/entropy': 0.24344344437122345, 'objective/non_score_reward': -1.0026555061340332, 'objective/rlhf_reward': -1.2288939952850342, 'objective/scores': -0.22623848915100098, 'policy/approxkl_avg': 0.011941793374717236, 'policy/clipfrac_avg': 0.004638365004211664, 'loss/policy_avg': 0.001833887305110693, 'loss/value_avg': 1.803223967552185, 'val/clipfrac_avg': 0.27434486150741577, 'policy/entropy_avg': 0.012565265409648418, 'val/ratio': 0.9983144998550415, 'val/ratio_var': 1.279433604395308e-06, 'val/num_eos_tokens': 0, 'lr': 1.5625e-05, 'episode': 12960, 'epoch': 2.4}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 11/16 [02:04<00:49,  9.88s/it]\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 12/16 [02:04<00:39,  9.86s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958076.8875308, "gpudata": {"0": {"memory": [14390.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 201.976}, "1": {"memory": [14256.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 201.151}, "2": {"memory": [14644.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 203.279}, "3": {"memory": [14746.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 201.446}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958076.8875308, "iodata": {"read_count": 0, "write_count": 497, "read_bytes": 0, "read_time": 0, "write_time": 55, "busy_time": 368}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958076.8875308, "netdata": {"bytes_sent": 252287657774, "bytes_recv": 672898989635, "packets_sent": 264483039, "packets_recv": 468050482, "errin": 0, "errout": 0, "dropin": 1342036, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958076.8875308, "cpudata": {"memory": [20466577408, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 20.969995498657227, 'objective/entropy': 0.4551136791706085, 'objective/non_score_reward': -1.0484998226165771, 'objective/rlhf_reward': -1.2367818355560303, 'objective/scores': -0.18828201293945312, 'policy/approxkl_avg': 0.10386490076780319, 'policy/clipfrac_avg': 0.00575209641829133, 'loss/policy_avg': 0.015675600618124008, 'loss/value_avg': 1.7709436416625977, 'val/clipfrac_avg': 0.12040968239307404, 'policy/entropy_avg': 0.013667111285030842, 'val/ratio': 1.025263786315918, 'val/ratio_var': 0.010124731808900833, 'val/num_eos_tokens': 0, 'lr': 1.25e-05, 'episode': 14040, 'epoch': 2.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 12/16 [02:14<00:39,  9.86s/it]\r 81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 13/16 [02:14<00:29,  9.81s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958086.9271188, "gpudata": {"0": {"memory": [15044.25, 81920.0], "load": 1.0, "temperature": 48.0, "power": 298.21}, "1": {"memory": [15086.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 321.473}, "2": {"memory": [15296.25, 81920.0], "load": 1.0, "temperature": 47.0, "power": 234.878}, "3": {"memory": [15204.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 199.379}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958086.9271188, "iodata": {"read_count": 0, "write_count": 514, "read_bytes": 0, "read_time": 0, "write_time": 56, "busy_time": 392}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958086.9271188, "netdata": {"bytes_sent": 252287762738, "bytes_recv": 672899014399, "packets_sent": 264483152, "packets_recv": 468050589, "errin": 0, "errout": 0, "dropin": 1342041, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958086.9271188, "cpudata": {"memory": [20469952512, 1076141588480], "load": 6.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 19.80709457397461, 'objective/entropy': 0.20316298305988312, 'objective/non_score_reward': -0.9903547763824463, 'objective/rlhf_reward': -1.2094236612319946, 'objective/scores': -0.2190687656402588, 'policy/approxkl_avg': 0.00792242493480444, 'policy/clipfrac_avg': 0.0025244583375751972, 'loss/policy_avg': 0.0022640323732048273, 'loss/value_avg': 1.7391152381896973, 'val/clipfrac_avg': 0.14114254713058472, 'policy/entropy_avg': 0.008345738053321838, 'val/ratio': 0.9996803998947144, 'val/ratio_var': 4.854796770814573e-06, 'val/num_eos_tokens': 0, 'lr': 9.375000000000001e-06, 'episode': 15120, 'epoch': 2.8}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 13/16 [02:23<00:29,  9.81s/it]\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 14/16 [02:23<00:19,  9.82s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958096.9496503, "gpudata": {"0": {"memory": [14942.25, 81920.0], "load": 0.88, "temperature": 45.0, "power": 204.687}, "1": {"memory": [15058.25, 81920.0], "load": 0.91, "temperature": 42.0, "power": 202.265}, "2": {"memory": [15296.25, 81920.0], "load": 0.82, "temperature": 46.0, "power": 204.395}, "3": {"memory": [15402.25, 81920.0], "load": 0.86, "temperature": 43.0, "power": 199.554}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958096.9496503, "iodata": {"read_count": 0, "write_count": 539, "read_bytes": 0, "read_time": 0, "write_time": 57, "busy_time": 416}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958096.9496503, "netdata": {"bytes_sent": 252287776237, "bytes_recv": 672899038465, "packets_sent": 264483216, "packets_recv": 468050675, "errin": 0, "errout": 0, "dropin": 1342046, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958096.9496503, "cpudata": {"memory": [20471418880, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 19.298139572143555, 'objective/entropy': 0.1744779348373413, 'objective/non_score_reward': -0.9649069905281067, 'objective/rlhf_reward': -1.2022223472595215, 'objective/scores': -0.23731517791748047, 'policy/approxkl_avg': 0.0035861250944435596, 'policy/clipfrac_avg': 0.0017295596189796925, 'loss/policy_avg': 0.002407233929261565, 'loss/value_avg': 1.7287362813949585, 'val/clipfrac_avg': 0.0011486721923574805, 'policy/entropy_avg': 0.008937083184719086, 'val/ratio': 1.0002861022949219, 'val/ratio_var': 4.221801646053791e-06, 'val/num_eos_tokens': 0, 'lr': 6.25e-06, 'episode': 16200, 'epoch': 3.0}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 14/16 [02:33<00:19,  9.82s/it]\r 94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 15/16 [02:33<00:09,  9.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7321.683719749995, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7448.34027921852, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7376.185437160139, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7312.965645000828, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7540.163054367591, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958106.9720294, "gpudata": {"0": {"memory": [15684.25, 81920.0], "load": 0.86, "temperature": 47.0, "power": 230.817}, "1": {"memory": [15710.25, 81920.0], "load": 0.86, "temperature": 44.0, "power": 321.343}, "2": {"memory": [15948.25, 81920.0], "load": 0.86, "temperature": 47.0, "power": 300.169}, "3": {"memory": [15818.25, 81920.0], "load": 0.86, "temperature": 43.0, "power": 199.554}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958106.9720294, "iodata": {"read_count": 0, "write_count": 577, "read_bytes": 0, "read_time": 0, "write_time": 60, "busy_time": 456}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958106.9720294, "netdata": {"bytes_sent": 252287789538, "bytes_recv": 672899053333, "packets_sent": 264483271, "packets_recv": 468050751, "errin": 0, "errout": 0, "dropin": 1342051, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733958106.9720294, "cpudata": {"memory": [20461813760, 1076141588480], "load": 6.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 19.625, 'objective/entropy': 0.2840782403945923, 'objective/non_score_reward': -0.9812499284744263, 'objective/rlhf_reward': -1.215293049812317, 'objective/scores': -0.23404312133789062, 'policy/approxkl_avg': 0.003909869119524956, 'policy/clipfrac_avg': 0.002048392780125141, 'loss/policy_avg': 0.002844959031790495, 'loss/value_avg': 1.7150503396987915, 'val/clipfrac_avg': 0.0010918937623500824, 'policy/entropy_avg': 0.009166943840682507, 'val/ratio': 1.001092553138733, 'val/ratio_var': 1.6952593796304427e-05, 'val/num_eos_tokens': 0, 'lr': 3.125e-06, 'episode': 17280, 'epoch': 3.2}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 15/16 [02:43<00:09,  9.78s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [02:43<00:00,  9.86s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [02:43<00:00, 10.23s/it]", "pipe": "stderr"}
{"event": "line", "data": "\n", "pipe": "stderr"}
{"event": "line", "data": "[rank0]:[W1211 18:01:55.594330782 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "270", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733958117.7382536, "return_code": 0}, "pipe": null}
