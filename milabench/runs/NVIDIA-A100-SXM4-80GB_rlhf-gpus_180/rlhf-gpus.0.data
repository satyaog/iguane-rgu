{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-g002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-g002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-A100-SXM4-80GB_rlhf-gpus_180.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 64, "brand": "AMD EPYC 7543 32-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-g002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "0", "device": 0, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 35.0, "power": 62.258, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "1", "device": 1, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 30.0, "power": 61.063, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "2", "device": 2, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 35.0, "power": 62.572, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "3", "device": 3, "product": "NVIDIA A100-SXM4-80GB", "memory": {"used": 578.375, "total": 81920.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 62.719, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1733975747.766867, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX2", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "180", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733957747.8472323}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "data", "data": {"task": "main", "time": 1733957774.4084349, "gpudata": {"0": {"memory": [2132.25, 81920.0], "load": 0.0, "temperature": 31.0, "power": 79.547}, "1": {"memory": [2204.25, 81920.0], "load": 0.0, "temperature": 29.0, "power": 78.632}, "2": {"memory": [2204.25, 81920.0], "load": 0.0, "temperature": 31.0, "power": 80.471}, "3": {"memory": [2132.25, 81920.0], "load": 0.0, "temperature": 29.0, "power": 79.995}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957774.4084349, "iodata": {"read_count": 0, "write_count": 94, "read_bytes": 0, "read_time": 0, "write_time": 11, "busy_time": 48}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957774.4084349, "netdata": {"bytes_sent": 252285547772, "bytes_recv": 672897428545, "packets_sent": 264469296, "packets_recv": 468036327, "errin": 0, "errout": 0, "dropin": 1341885, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957774.4084349, "cpudata": {"memory": [27415179264, 1076141588480], "load": 0.0}}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/23 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1733957784.4303763, "gpudata": {"0": {"memory": [15232.25, 81920.0], "load": 0.49, "temperature": 38.0, "power": 149.842}, "1": {"memory": [15704.25, 81920.0], "load": 0.3, "temperature": 37.0, "power": 215.488}, "2": {"memory": [15768.25, 81920.0], "load": 0.15, "temperature": 39.0, "power": 194.874}, "3": {"memory": [14838.25, 81920.0], "load": 0.12, "temperature": 37.0, "power": 170.552}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957784.4303763, "iodata": {"read_count": 0, "write_count": 272, "read_bytes": 0, "read_time": 0, "write_time": 35, "busy_time": 100}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957784.4303763, "netdata": {"bytes_sent": 252285653955, "bytes_recv": 672897453339, "packets_sent": 264469407, "packets_recv": 468036433, "errin": 0, "errout": 0, "dropin": 1341890, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957784.4303763, "cpudata": {"memory": [19600740352, 1076141588480], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 68, 'objective/kl': 5.714944563806057e-06, 'objective/entropy': 93.11650085449219, 'objective/non_score_reward': -2.8574686439242214e-07, 'objective/rlhf_reward': 2.3515734672546387, 'objective/scores': 2.3515737056732178, 'policy/approxkl_avg': 2.350184917449951, 'policy/clipfrac_avg': 0.4190841317176819, 'loss/policy_avg': 0.222452312707901, 'loss/value_avg': 21.84585189819336, 'val/clipfrac_avg': 0.5009827017784119, 'policy/entropy_avg': 1.4799299240112305, 'val/ratio': 0.9602465629577637, 'val/ratio_var': 0.0014294440625235438, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 720, 'epoch': 0.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/23 [00:10<?, ?it/s]\r  4%|\u258d         | 1/23 [00:10<03:53, 10.61s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 89, 'objective/kl': 25.831911087036133, 'objective/entropy': 33.558475494384766, 'objective/non_score_reward': -1.2915955781936646, 'objective/rlhf_reward': 0.9893926978111267, 'objective/scores': 2.2809882164001465, 'policy/approxkl_avg': 1.2582628726959229, 'policy/clipfrac_avg': 0.2600104808807373, 'loss/policy_avg': 0.12172014266252518, 'loss/value_avg': 11.429277420043945, 'val/clipfrac_avg': 0.6468291282653809, 'policy/entropy_avg': 0.6641734838485718, 'val/ratio': 0.9752753973007202, 'val/ratio_var': 0.0014498846139758825, 'val/num_eos_tokens': 0, 'lr': 4.782608695652174e-05, 'episode': 1440, 'epoch': 0.27}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  4%|\u258d         | 1/23 [00:16<03:53, 10.61s/it]\r  9%|\u258a         | 2/23 [00:16<02:38,  7.55s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957794.4591815, "gpudata": {"0": {"memory": [13548.25, 81920.0], "load": 1.0, "temperature": 40.0, "power": 214.663}, "1": {"memory": [13530.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 208.464}, "2": {"memory": [13480.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 212.488}, "3": {"memory": [13458.25, 81920.0], "load": 1.0, "temperature": 40.0, "power": 209.823}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957794.4591815, "iodata": {"read_count": 0, "write_count": 342, "read_bytes": 0, "read_time": 0, "write_time": 43, "busy_time": 144}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957794.4591815, "netdata": {"bytes_sent": 252285666480, "bytes_recv": 672897467259, "packets_sent": 264469460, "packets_recv": 468036504, "errin": 0, "errout": 0, "dropin": 1341895, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957794.4591815, "cpudata": {"memory": [20413902848, 1076141588480], "load": 7.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 100, 'objective/kl': 40.061737060546875, 'objective/entropy': 19.461179733276367, 'objective/non_score_reward': -2.003087043762207, 'objective/rlhf_reward': 0.34415751695632935, 'objective/scores': 2.3472445011138916, 'policy/approxkl_avg': 1.3080735206604004, 'policy/clipfrac_avg': 0.21810796856880188, 'loss/policy_avg': 0.10171832144260406, 'loss/value_avg': 7.050644874572754, 'val/clipfrac_avg': 0.5414111614227295, 'policy/entropy_avg': 0.4475902020931244, 'val/ratio': 0.9778896570205688, 'val/ratio_var': 0.0030748876743018627, 'val/num_eos_tokens': 0, 'lr': 4.565217391304348e-05, 'episode': 2160, 'epoch': 0.4}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  9%|\u258a         | 2/23 [00:21<02:38,  7.55s/it]\r 13%|\u2588\u258e        | 3/23 [00:21<02:12,  6.61s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957804.491399, "gpudata": {"0": {"memory": [11190.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.627}, "1": {"memory": [11216.25, 81920.0], "load": 1.0, "temperature": 37.0, "power": 95.911}, "2": {"memory": [11018.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 97.74}, "3": {"memory": [36766.25, 81920.0], "load": 1.0, "temperature": 38.0, "power": 99.125}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957804.491399, "iodata": {"read_count": 0, "write_count": 342, "read_bytes": 0, "read_time": 0, "write_time": 43, "busy_time": 144}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957804.491399, "netdata": {"bytes_sent": 252285678334, "bytes_recv": 672897480799, "packets_sent": 264469507, "packets_recv": 468036572, "errin": 0, "errout": 0, "dropin": 1341900, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957804.491399, "cpudata": {"memory": [20432670720, 1076141588480], "load": 7.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 48.80145263671875, 'objective/entropy': 13.302457809448242, 'objective/non_score_reward': -2.440072774887085, 'objective/rlhf_reward': -0.07481628656387329, 'objective/scores': 2.3652563095092773, 'policy/approxkl_avg': 1.3429675102233887, 'policy/clipfrac_avg': 0.1782887876033783, 'loss/policy_avg': 0.08319862186908722, 'loss/value_avg': 4.108891010284424, 'val/clipfrac_avg': 0.5498886108398438, 'policy/entropy_avg': 0.31602516770362854, 'val/ratio': 0.9600131511688232, 'val/ratio_var': 0.0015216360334306955, 'val/num_eos_tokens': 0, 'lr': 4.347826086956522e-05, 'episode': 2880, 'epoch': 0.53}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 13%|\u2588\u258e        | 3/23 [00:27<02:12,  6.61s/it]\r 17%|\u2588\u258b        | 4/23 [00:27<01:58,  6.24s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': 73.43086242675781, 'objective/entropy': 15.221759796142578, 'objective/non_score_reward': -3.6715431213378906, 'objective/rlhf_reward': -1.372384786605835, 'objective/scores': 2.2991585731506348, 'policy/approxkl_avg': 2.471135139465332, 'policy/clipfrac_avg': 0.170427143573761, 'loss/policy_avg': 0.09477078914642334, 'loss/value_avg': 2.969212532043457, 'val/clipfrac_avg': 0.4307979643344879, 'policy/entropy_avg': 0.26463741064071655, 'val/ratio': 1.00301194190979, 'val/ratio_var': 0.0179371926933527, 'val/num_eos_tokens': 0, 'lr': 4.130434782608696e-05, 'episode': 3600, 'epoch': 0.67}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 17%|\u2588\u258b        | 4/23 [00:33<01:58,  6.24s/it]\r 22%|\u2588\u2588\u258f       | 5/23 [00:33<01:49,  6.09s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957814.5171113, "gpudata": {"0": {"memory": [44504.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 278.69}, "1": {"memory": [44166.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 232.453}, "2": {"memory": [45178.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 322.294}, "3": {"memory": [44504.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 286.904}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957814.5171113, "iodata": {"read_count": 0, "write_count": 359, "read_bytes": 0, "read_time": 0, "write_time": 46, "busy_time": 184}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957814.5171113, "netdata": {"bytes_sent": 252285787938, "bytes_recv": 672897518551, "packets_sent": 264469656, "packets_recv": 468036716, "errin": 0, "errout": 0, "dropin": 1341905, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957814.5171113, "cpudata": {"memory": [20443140096, 1076141588480], "load": 7.9}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 111, 'objective/kl': 45.738380432128906, 'objective/entropy': 3.8074960708618164, 'objective/non_score_reward': -2.286919116973877, 'objective/rlhf_reward': -0.07400405406951904, 'objective/scores': 2.2129149436950684, 'policy/approxkl_avg': 1.0574367046356201, 'policy/clipfrac_avg': 0.06414439529180527, 'loss/policy_avg': 0.04450605809688568, 'loss/value_avg': 2.256021022796631, 'val/clipfrac_avg': 0.4900026321411133, 'policy/entropy_avg': 0.06968380510807037, 'val/ratio': 1.0108411312103271, 'val/ratio_var': 0.0034655635245144367, 'val/num_eos_tokens': 0, 'lr': 3.91304347826087e-05, 'episode': 4320, 'epoch': 0.8}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 22%|\u2588\u2588\u258f       | 5/23 [00:38<01:49,  6.09s/it]\r 26%|\u2588\u2588\u258c       | 6/23 [00:38<01:42,  6.02s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 113, 'objective/kl': 36.50522232055664, 'objective/entropy': 1.6868727207183838, 'objective/non_score_reward': -1.825261116027832, 'objective/rlhf_reward': 0.37682563066482544, 'objective/scores': 2.2020866870880127, 'policy/approxkl_avg': 2.2284202575683594, 'policy/clipfrac_avg': 0.055601414293050766, 'loss/policy_avg': 0.028540905565023422, 'loss/value_avg': 1.947127342224121, 'val/clipfrac_avg': 0.555431067943573, 'policy/entropy_avg': 0.04754767566919327, 'val/ratio': 0.9657610654830933, 'val/ratio_var': 0.0010422401828691363, 'val/num_eos_tokens': 0, 'lr': 3.695652173913043e-05, 'episode': 5040, 'epoch': 0.93}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 26%|\u2588\u2588\u258c       | 6/23 [00:44<01:42,  6.02s/it]\r 30%|\u2588\u2588\u2588       | 7/23 [00:44<01:34,  5.92s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 4462.056088866411, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8822.630167640104, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8728.030368797796, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8435.348892584665, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8336.332527364739, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8332.13369096027, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8368.807870040699, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957824.5371027, "gpudata": {"0": {"memory": [17812.25, 81920.0], "load": 0.43, "temperature": 45.0, "power": 236.479}, "1": {"memory": [18126.25, 81920.0], "load": 0.77, "temperature": 43.0, "power": 236.781}, "2": {"memory": [18304.25, 81920.0], "load": 0.73, "temperature": 46.0, "power": 187.81}, "3": {"memory": [18708.25, 81920.0], "load": 0.99, "temperature": 44.0, "power": 177.628}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957824.5371027, "iodata": {"read_count": 0, "write_count": 404, "read_bytes": 0, "read_time": 0, "write_time": 53, "busy_time": 208}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957824.5371027, "netdata": {"bytes_sent": 252285799760, "bytes_recv": 672897533023, "packets_sent": 264469707, "packets_recv": 468036794, "errin": 0, "errout": 0, "dropin": 1341910, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957824.5371027, "cpudata": {"memory": [20446900224, 1076141588480], "load": 7.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 114, 'objective/kl': 56.82432556152344, 'objective/entropy': 1.2713733911514282, 'objective/non_score_reward': -2.8412160873413086, 'objective/rlhf_reward': -0.8101861476898193, 'objective/scores': 2.0310299396514893, 'policy/approxkl_avg': 0.4024052619934082, 'policy/clipfrac_avg': 0.02296907640993595, 'loss/policy_avg': 0.012665698304772377, 'loss/value_avg': 1.3679893016815186, 'val/clipfrac_avg': 0.4676690101623535, 'policy/entropy_avg': 0.02410276234149933, 'val/ratio': 0.9962766170501709, 'val/ratio_var': 7.644108700333163e-05, 'val/num_eos_tokens': 0, 'lr': 3.478260869565218e-05, 'episode': 5760, 'epoch': 1.07}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 30%|\u2588\u2588\u2588       | 7/23 [00:50<01:34,  5.92s/it]\r 35%|\u2588\u2588\u2588\u258d      | 8/23 [00:50<01:27,  5.81s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 115, 'objective/kl': 55.0916633605957, 'objective/entropy': 1.144457459449768, 'objective/non_score_reward': -2.7545831203460693, 'objective/rlhf_reward': -0.7452392578125, 'objective/scores': 2.0093438625335693, 'policy/approxkl_avg': 2.450704336166382, 'policy/clipfrac_avg': 0.02019129879772663, 'loss/policy_avg': 0.013083323836326599, 'loss/value_avg': 1.129460334777832, 'val/clipfrac_avg': 0.4651795029640198, 'policy/entropy_avg': 0.017630811780691147, 'val/ratio': 1.0044158697128296, 'val/ratio_var': 0.00045096463873051107, 'val/num_eos_tokens': 0, 'lr': 3.260869565217392e-05, 'episode': 6480, 'epoch': 1.2}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 35%|\u2588\u2588\u2588\u258d      | 8/23 [00:56<01:27,  5.81s/it]\r 39%|\u2588\u2588\u2588\u2589      | 9/23 [00:56<01:21,  5.81s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957834.5737913, "gpudata": {"0": {"memory": [13548.25, 81920.0], "load": 0.83, "temperature": 45.0, "power": 343.304}, "1": {"memory": [13508.25, 81920.0], "load": 0.79, "temperature": 43.0, "power": 337.528}, "2": {"memory": [13480.25, 81920.0], "load": 0.83, "temperature": 45.0, "power": 183.806}, "3": {"memory": [13556.25, 81920.0], "load": 0.81, "temperature": 43.0, "power": 191.241}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957834.5737913, "iodata": {"read_count": 0, "write_count": 404, "read_bytes": 0, "read_time": 0, "write_time": 53, "busy_time": 208}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957834.5737913, "netdata": {"bytes_sent": 252285811250, "bytes_recv": 672897546381, "packets_sent": 264469754, "packets_recv": 468036861, "errin": 0, "errout": 0, "dropin": 1341915, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957834.5737913, "cpudata": {"memory": [20456349696, 1076141588480], "load": 7.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 116, 'objective/kl': 49.738365173339844, 'objective/entropy': 0.26862090826034546, 'objective/non_score_reward': -2.4869184494018555, 'objective/rlhf_reward': -0.46413668990135193, 'objective/scores': 2.0227818489074707, 'policy/approxkl_avg': 0.015683140605688095, 'policy/clipfrac_avg': 0.005116614513099194, 'loss/policy_avg': 0.002051351359114051, 'loss/value_avg': 1.1063039302825928, 'val/clipfrac_avg': 0.47952699661254883, 'policy/entropy_avg': 0.007951585575938225, 'val/ratio': 0.999509334564209, 'val/ratio_var': 7.297870979527943e-06, 'val/num_eos_tokens': 0, 'lr': 3.0434782608695656e-05, 'episode': 7200, 'epoch': 1.33}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 39%|\u2588\u2588\u2588\u2589      | 9/23 [01:01<01:21,  5.81s/it]\r 43%|\u2588\u2588\u2588\u2588\u258e     | 10/23 [01:01<01:15,  5.82s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957844.8408003, "gpudata": {"0": {"memory": [11190.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 98.458}, "1": {"memory": [15328.25, 81920.0], "load": 1.0, "temperature": 38.0, "power": 96.555}, "2": {"memory": [11018.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 98.814}, "3": {"memory": [15256.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 99.706}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957844.8408003, "iodata": {"read_count": 0, "write_count": 448, "read_bytes": 0, "read_time": 0, "write_time": 58, "busy_time": 240}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957844.8408003, "netdata": {"bytes_sent": 252285916210, "bytes_recv": 672897571097, "packets_sent": 264469864, "packets_recv": 468036967, "errin": 0, "errout": 0, "dropin": 1341920, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957844.8408003, "cpudata": {"memory": [20433305600, 1076141588480], "load": 7.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 117, 'objective/kl': 49.60472869873047, 'objective/entropy': 0.2879018485546112, 'objective/non_score_reward': -2.480236291885376, 'objective/rlhf_reward': -0.5036782026290894, 'objective/scores': 1.976557970046997, 'policy/approxkl_avg': 0.015265118330717087, 'policy/clipfrac_avg': 0.004684224259108305, 'loss/policy_avg': 0.0023887360002845526, 'loss/value_avg': 1.0014393329620361, 'val/clipfrac_avg': 0.42579925060272217, 'policy/entropy_avg': 0.006723407655954361, 'val/ratio': 0.9989765882492065, 'val/ratio_var': 2.9486009225365706e-06, 'val/num_eos_tokens': 0, 'lr': 2.826086956521739e-05, 'episode': 7920, 'epoch': 1.47}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 43%|\u2588\u2588\u2588\u2588\u258e     | 10/23 [01:07<01:15,  5.82s/it]\r 48%|\u2588\u2588\u2588\u2588\u258a     | 11/23 [01:07<01:09,  5.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 118, 'objective/kl': 51.275779724121094, 'objective/entropy': 0.10383407771587372, 'objective/non_score_reward': -2.563788890838623, 'objective/rlhf_reward': -0.5834176540374756, 'objective/scores': 1.9803712368011475, 'policy/approxkl_avg': 0.005952479317784309, 'policy/clipfrac_avg': 0.001664046081714332, 'loss/policy_avg': 0.0006017423002049327, 'loss/value_avg': 0.92472904920578, 'val/clipfrac_avg': 0.34450340270996094, 'policy/entropy_avg': 0.002146247075870633, 'val/ratio': 0.9996641278266907, 'val/ratio_var': 1.9241561233229731e-07, 'val/num_eos_tokens': 0, 'lr': 2.608695652173913e-05, 'episode': 8640, 'epoch': 1.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 48%|\u2588\u2588\u2588\u2588\u258a     | 11/23 [01:13<01:09,  5.78s/it]\r 52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 12/23 [01:13<01:02,  5.71s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957855.0612671, "gpudata": {"0": {"memory": [11190.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 100.603}, "1": {"memory": [11280.25, 81920.0], "load": 1.0, "temperature": 41.0, "power": 127.347}, "2": {"memory": [11212.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 132.608}, "3": {"memory": [11842.25, 81920.0], "load": 1.0, "temperature": 42.0, "power": 132.06}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957855.0612671, "iodata": {"read_count": 0, "write_count": 460, "read_bytes": 0, "read_time": 0, "write_time": 59, "busy_time": 256}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957855.0612671, "netdata": {"bytes_sent": 252285929831, "bytes_recv": 672897585943, "packets_sent": 264469921, "packets_recv": 468037040, "errin": 0, "errout": 0, "dropin": 1341925, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957855.0612671, "cpudata": {"memory": [20449153024, 1076141588480], "load": 7.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 118, 'objective/kl': 51.45450973510742, 'objective/entropy': 0.015545438975095749, 'objective/non_score_reward': -2.572725772857666, 'objective/rlhf_reward': -0.6116490364074707, 'objective/scores': 1.9610764980316162, 'policy/approxkl_avg': 0.00024562858743593097, 'policy/clipfrac_avg': 0.00015068134234752506, 'loss/policy_avg': 0.001180581864900887, 'loss/value_avg': 0.8231502175331116, 'val/clipfrac_avg': 0.31055423617362976, 'policy/entropy_avg': 0.0006722100079059601, 'val/ratio': 1.0005240440368652, 'val/ratio_var': 5.702809630747652e-06, 'val/num_eos_tokens': 0, 'lr': 2.391304347826087e-05, 'episode': 9360, 'epoch': 1.73}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 12/23 [01:19<01:02,  5.71s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r 57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 13/23 [01:19<00:57,  5.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 119, 'objective/kl': 51.42535400390625, 'objective/entropy': 0.01717263087630272, 'objective/non_score_reward': -2.57126784324646, 'objective/rlhf_reward': -0.5971285104751587, 'objective/scores': 1.9741392135620117, 'policy/approxkl_avg': 0.00029146886663511395, 'policy/clipfrac_avg': 0.00024895177921280265, 'loss/policy_avg': 9.85682854661718e-05, 'loss/value_avg': 0.8042107820510864, 'val/clipfrac_avg': 0.2669614553451538, 'policy/entropy_avg': 0.0007701126160100102, 'val/ratio': 1.00019371509552, 'val/ratio_var': 1.1146312317578122e-06, 'val/num_eos_tokens': 0, 'lr': 2.173913043478261e-05, 'episode': 10080, 'epoch': 1.86}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 13/23 [01:24<00:57,  5.78s/it]\r 61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 14/23 [01:24<00:51,  5.74s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8773.493786717068, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8296.72935320283, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8283.993542216826, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8333.514608704954, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8652.165074202074, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7760.191697935148, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8878.35579773038, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957865.1162996, "gpudata": {"0": {"memory": [44504.25, 81920.0], "load": 1.0, "temperature": 50.0, "power": 331.01}, "1": {"memory": [44166.25, 81920.0], "load": 0.97, "temperature": 47.0, "power": 329.565}, "2": {"memory": [44382.25, 81920.0], "load": 0.84, "temperature": 52.0, "power": 378.3}, "3": {"memory": [44094.25, 81920.0], "load": 0.96, "temperature": 48.0, "power": 313.835}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957865.1162996, "iodata": {"read_count": 0, "write_count": 480, "read_bytes": 0, "read_time": 0, "write_time": 59, "busy_time": 272}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957865.1162996, "netdata": {"bytes_sent": 252285941625, "bytes_recv": 672897599435, "packets_sent": 264469967, "packets_recv": 468037108, "errin": 0, "errout": 0, "dropin": 1341930, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957865.1162996, "cpudata": {"memory": [20447399936, 1076141588480], "load": 7.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 119, 'objective/kl': 51.62775421142578, 'objective/entropy': 0.012675313279032707, 'objective/non_score_reward': -2.581387758255005, 'objective/rlhf_reward': -0.6132791042327881, 'objective/scores': 1.9681086540222168, 'policy/approxkl_avg': 0.0004005625960417092, 'policy/clipfrac_avg': 0.0004979035584256053, 'loss/policy_avg': -0.00016208080342039466, 'loss/value_avg': 0.7610048055648804, 'val/clipfrac_avg': 0.1781512051820755, 'policy/entropy_avg': 0.0008797537884674966, 'val/ratio': 0.9996297955513, 'val/ratio_var': 1.124547921449448e-08, 'val/num_eos_tokens': 0, 'lr': 1.956521739130435e-05, 'episode': 10800, 'epoch': 2.0}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 14/23 [01:30<00:51,  5.74s/it]\r 65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 15/23 [01:30<00:46,  5.80s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 120, 'objective/kl': 51.51765441894531, 'objective/entropy': 0.03465615585446358, 'objective/non_score_reward': -2.57588267326355, 'objective/rlhf_reward': -0.5998363494873047, 'objective/scores': 1.9760463237762451, 'policy/approxkl_avg': 0.000798627792391926, 'policy/clipfrac_avg': 0.000589622650295496, 'loss/policy_avg': 6.782700802432373e-05, 'loss/value_avg': 0.7485606670379639, 'val/clipfrac_avg': 0.09467374533414841, 'policy/entropy_avg': 0.001141721266321838, 'val/ratio': 1.0003950595855713, 'val/ratio_var': 2.2677238575852243e-06, 'val/num_eos_tokens': 0, 'lr': 1.739130434782609e-05, 'episode': 11520, 'epoch': 2.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 15/23 [01:35<00:46,  5.80s/it]\r 70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 16/23 [01:35<00:39,  5.66s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957875.1577857, "gpudata": {"0": {"memory": [11188.25, 81920.0], "load": 0.7, "temperature": 51.0, "power": 333.415}, "1": {"memory": [11214.25, 81920.0], "load": 0.99, "temperature": 49.0, "power": 327.499}, "2": {"memory": [11018.25, 81920.0], "load": 0.78, "temperature": 53.0, "power": 334.859}, "3": {"memory": [11142.25, 81920.0], "load": 1.0, "temperature": 49.0, "power": 326.966}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957875.1577857, "iodata": {"read_count": 0, "write_count": 508, "read_bytes": 0, "read_time": 0, "write_time": 63, "busy_time": 304}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957875.1577857, "netdata": {"bytes_sent": 252286046300, "bytes_recv": 672897624283, "packets_sent": 264470077, "packets_recv": 468037215, "errin": 0, "errout": 0, "dropin": 1341935, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957875.1577857, "cpudata": {"memory": [20450779136, 1076141588480], "load": 7.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 120, 'objective/kl': 50.66667556762695, 'objective/entropy': 0.037953685969114304, 'objective/non_score_reward': -2.5333340167999268, 'objective/rlhf_reward': -0.5567569732666016, 'objective/scores': 1.9765770435333252, 'policy/approxkl_avg': 0.00109187257476151, 'policy/clipfrac_avg': 0.0005503144348040223, 'loss/policy_avg': 0.0007569551817141473, 'loss/value_avg': 0.7494286298751831, 'val/clipfrac_avg': 0.032553721219301224, 'policy/entropy_avg': 0.0010240639094263315, 'val/ratio': 1.0005638599395752, 'val/ratio_var': 1.92680886357266e-06, 'val/num_eos_tokens': 0, 'lr': 1.5217391304347828e-05, 'episode': 12240, 'epoch': 2.26}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 16/23 [01:41<00:39,  5.66s/it]\r 74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 17/23 [01:41<00:33,  5.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [17, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "\r 74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 17/23 [01:47<00:33,  5.65s/it]", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 120, 'objective/kl': 52.089725494384766, 'objective/entropy': 0.007896415889263153, 'objective/non_score_reward': -2.6044864654541016, 'objective/rlhf_reward': -0.645043671131134, 'objective/scores': 1.9594427347183228, 'policy/approxkl_avg': 0.0001270850480068475, 'policy/clipfrac_avg': 0.00015068134234752506, 'loss/policy_avg': 9.331457840744406e-05, 'loss/value_avg': 0.7337170839309692, 'val/clipfrac_avg': 0.008746068924665451, 'policy/entropy_avg': 0.0005534248193725944, 'val/ratio': 0.9998290538787842, 'val/ratio_var': 5.337612574152217e-09, 'val/num_eos_tokens': 0, 'lr': 1.3043478260869566e-05, 'episode': 12960, 'epoch': 2.4}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 18/23 [01:47<00:28,  5.63s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [18, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957885.1884847, "gpudata": {"0": {"memory": [12896.25, 81920.0], "load": 1.0, "temperature": 49.0, "power": 201.212}, "1": {"memory": [12904.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 325.907}, "2": {"memory": [12888.25, 81920.0], "load": 1.0, "temperature": 51.0, "power": 346.824}, "3": {"memory": [12834.25, 81920.0], "load": 1.0, "temperature": 45.0, "power": 330.864}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957885.1884847, "iodata": {"read_count": 0, "write_count": 530, "read_bytes": 0, "read_time": 0, "write_time": 64, "busy_time": 328}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957885.1884847, "netdata": {"bytes_sent": 252286057994, "bytes_recv": 672897638161, "packets_sent": 264470126, "packets_recv": 468037286, "errin": 0, "errout": 0, "dropin": 1341940, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957885.1884847, "cpudata": {"memory": [20440653824, 1076141588480], "load": 7.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 121, 'objective/kl': 51.09166717529297, 'objective/entropy': 0.016634048894047737, 'objective/non_score_reward': -2.5545835494995117, 'objective/rlhf_reward': -0.591405987739563, 'objective/scores': 1.9631774425506592, 'policy/approxkl_avg': 0.0003223532112315297, 'policy/clipfrac_avg': 8.516771777067333e-05, 'loss/policy_avg': 0.00023594060621690005, 'loss/value_avg': 0.7196505665779114, 'val/clipfrac_avg': 0.006158281117677689, 'policy/entropy_avg': 0.00036877227830700576, 'val/ratio': 1.0000576972961426, 'val/ratio_var': 1.7607064251023985e-07, 'val/num_eos_tokens': 0, 'lr': 1.0869565217391305e-05, 'episode': 13680, 'epoch': 2.53}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 18/23 [01:52<00:28,  5.63s/it]\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 19/23 [01:52<00:22,  5.61s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [19, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957895.2091117, "gpudata": {"0": {"memory": [44322.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 99.3}, "1": {"memory": [44166.25, 81920.0], "load": 1.0, "temperature": 39.0, "power": 96.999}, "2": {"memory": [44170.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 99.706}, "3": {"memory": [44094.25, 81920.0], "load": 1.0, "temperature": 44.0, "power": 321.305}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957895.2091117, "iodata": {"read_count": 0, "write_count": 563, "read_bytes": 0, "read_time": 0, "write_time": 67, "busy_time": 344}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957895.2091117, "netdata": {"bytes_sent": 252286069414, "bytes_recv": 672897652227, "packets_sent": 264470172, "packets_recv": 468037361, "errin": 0, "errout": 0, "dropin": 1341945, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957895.2091117, "cpudata": {"memory": [20446875648, 1076141588480], "load": 7.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 121, 'objective/kl': 52.680908203125, 'objective/entropy': 0.035556942224502563, 'objective/non_score_reward': -2.6340456008911133, 'objective/rlhf_reward': -0.6868700981140137, 'objective/scores': 1.9471756219863892, 'policy/approxkl_avg': 0.0003754633944481611, 'policy/clipfrac_avg': 0.00015068134234752506, 'loss/policy_avg': 0.0001736365957185626, 'loss/value_avg': 0.7225803732872009, 'val/clipfrac_avg': 0.004258385859429836, 'policy/entropy_avg': 0.000467465550173074, 'val/ratio': 1.0004215240478516, 'val/ratio_var': 3.4828938169084722e-06, 'val/num_eos_tokens': 0, 'lr': 8.695652173913044e-06, 'episode': 14400, 'epoch': 2.66}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 19/23 [01:58<00:22,  5.61s/it]\r 87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 20/23 [01:58<00:16,  5.61s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [20, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 122, 'objective/kl': 51.7707633972168, 'objective/entropy': 0.0018340697279199958, 'objective/non_score_reward': -2.58853816986084, 'objective/rlhf_reward': -0.6267515420913696, 'objective/scores': 1.9617865085601807, 'policy/approxkl_avg': 5.011883331462741e-05, 'policy/clipfrac_avg': 0.00011792452278314158, 'loss/policy_avg': 6.922018656041473e-05, 'loss/value_avg': 0.7246615290641785, 'val/clipfrac_avg': 0.003930817358195782, 'policy/entropy_avg': 0.0004914157907478511, 'val/ratio': 0.9998817443847656, 'val/ratio_var': 5.084984433523232e-09, 'val/num_eos_tokens': 0, 'lr': 6.521739130434783e-06, 'episode': 15120, 'epoch': 2.8}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 20/23 [02:03<00:16,  5.61s/it]\r 91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 21/23 [02:03<00:11,  5.62s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8087.638831724368, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 9067.01401779192, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8629.03385322441, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8491.11631682807, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8618.418011147014, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8470.089554071239, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 8611.321011983873, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957905.231244, "gpudata": {"0": {"memory": [13862.25, 81920.0], "load": 1.0, "temperature": 46.0, "power": 100.894}, "1": {"memory": [13976.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 151.905}, "2": {"memory": [13932.25, 81920.0], "load": 1.0, "temperature": 47.0, "power": 221.398}, "3": {"memory": [14054.25, 81920.0], "load": 1.0, "temperature": 43.0, "power": 224.39}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957905.231244, "iodata": {"read_count": 0, "write_count": 576, "read_bytes": 0, "read_time": 0, "write_time": 69, "busy_time": 368}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957905.231244, "netdata": {"bytes_sent": 252286173957, "bytes_recv": 672897676181, "packets_sent": 264470282, "packets_recv": 468037458, "errin": 0, "errout": 0, "dropin": 1341950, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733957905.231244, "cpudata": {"memory": [20452335616, 1076141588480], "load": 7.9}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 122, 'objective/kl': 52.136322021484375, 'objective/entropy': 0.008001675829291344, 'objective/non_score_reward': -2.606816291809082, 'objective/rlhf_reward': -0.634244441986084, 'objective/scores': 1.972571849822998, 'policy/approxkl_avg': 0.0003104998031631112, 'policy/clipfrac_avg': 0.00016378406144212931, 'loss/policy_avg': 0.00014604169700760394, 'loss/value_avg': 0.730282723903656, 'val/clipfrac_avg': 0.004572851117700338, 'policy/entropy_avg': 0.0006076953141018748, 'val/ratio': 0.9998522400856018, 'val/ratio_var': 6.309420541583677e-09, 'val/num_eos_tokens': 0, 'lr': 4.347826086956522e-06, 'episode': 15840, 'epoch': 2.93}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 21/23 [02:09<00:11,  5.62s/it]\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 22/23 [02:09<00:05,  5.62s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [22, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 122, 'objective/kl': 51.05008316040039, 'objective/entropy': 0.011284084990620613, 'objective/non_score_reward': -2.552504301071167, 'objective/rlhf_reward': -0.5909355878829956, 'objective/scores': 1.9615685939788818, 'policy/approxkl_avg': 0.0002312421565875411, 'policy/clipfrac_avg': 0.0002030922332778573, 'loss/policy_avg': -3.40496699209325e-05, 'loss/value_avg': 0.7319141626358032, 'val/clipfrac_avg': 0.004848008044064045, 'policy/entropy_avg': 0.0005411878228187561, 'val/ratio': 0.999847412109375, 'val/ratio_var': 1.1207931471801658e-08, 'val/num_eos_tokens': 0, 'lr': 2.173913043478261e-06, 'episode': 16560, 'epoch': 3.06}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 22/23 [02:14<00:05,  5.62s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 23/23 [02:14<00:00,  5.50s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 23/23 [02:14<00:00,  5.87s/it]\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 8684.715731676097, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1211 17:58:32.492815473 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "180", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733957914.58885, "return_code": 0}, "pipe": null}
