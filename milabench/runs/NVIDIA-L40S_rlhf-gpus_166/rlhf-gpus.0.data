{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-l040.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-l040.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-L40S_rlhf-gpus_166.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 48, "brand": "Intel(R) Xeon(R) Gold 5418Y"}, "os": {"sysname": "Linux", "nodename": "cn-l040.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "0", "device": 0, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 42.0, "power": 64.703, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "1", "device": 1, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 42.0, "power": 65.501, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "2", "device": 2, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 43.0, "power": 65.409, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "3", "device": 3, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 42.0, "power": 65.114, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1733931507.05367, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "166", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733913507.1128163}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/25 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1733913534.7996871, "gpudata": {"0": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 38.0, "power": 104.456}, "1": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 38.0, "power": 103.137}, "2": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 39.0, "power": 104.74}, "3": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 38.0, "power": 101.796}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913534.7996871, "iodata": {"read_count": 0, "write_count": 136, "read_bytes": 0, "read_time": 0, "write_time": 5, "busy_time": 32}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913534.7996871, "netdata": {"bytes_sent": 488145256108, "bytes_recv": 509693704567, "packets_sent": 610208012, "packets_recv": 641817170, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913534.7996871, "cpudata": {"memory": [15554109440, 1076052799488], "load": 0.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 56, 'objective/kl': 4.579149390337989e-05, 'objective/entropy': 93.66291809082031, 'objective/non_score_reward': -2.2895746951689944e-06, 'objective/rlhf_reward': 1.6419625282287598, 'objective/scores': 1.6419646739959717, 'policy/approxkl_avg': 2.3544816970825195, 'policy/clipfrac_avg': 0.4247840344905853, 'loss/policy_avg': 0.23129571974277496, 'loss/value_avg': 12.16043472290039, 'val/clipfrac_avg': 0.4388923645019531, 'policy/entropy_avg': 1.5117006301879883, 'val/ratio': 0.9633324146270752, 'val/ratio_var': 0.0013628610176965594, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 664, 'epoch': 0.12}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/25 [00:11<?, ?it/s]\r  4%|\u258d         | 1/25 [00:11<04:42, 11.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913544.8121982, "gpudata": {"0": {"memory": [40147.75, 46068.0], "load": 1.0, "temperature": 45.0, "power": 257.996}, "1": {"memory": [39991.75, 46068.0], "load": 0.84, "temperature": 46.0, "power": 255.196}, "2": {"memory": [40463.75, 46068.0], "load": 0.9, "temperature": 46.0, "power": 270.119}, "3": {"memory": [39987.75, 46068.0], "load": 0.85, "temperature": 46.0, "power": 295.483}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913544.8121982, "iodata": {"read_count": 0, "write_count": 184, "read_bytes": 0, "read_time": 0, "write_time": 13, "busy_time": 76}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913544.8121982, "netdata": {"bytes_sent": 488145295822, "bytes_recv": 509693737895, "packets_sent": 610208107, "packets_recv": 641817270, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913544.8121982, "cpudata": {"memory": [17359958016, 1076052799488], "load": 9.9}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 75, 'objective/kl': 25.024574279785156, 'objective/entropy': 26.08293342590332, 'objective/non_score_reward': -1.2512288093566895, 'objective/rlhf_reward': 0.5744310617446899, 'objective/scores': 1.8256597518920898, 'policy/approxkl_avg': 0.9449772834777832, 'policy/clipfrac_avg': 0.22125767171382904, 'loss/policy_avg': 0.0940709263086319, 'loss/value_avg': 7.7681732177734375, 'val/clipfrac_avg': 0.5570939779281616, 'policy/entropy_avg': 0.5327802896499634, 'val/ratio': 0.9723162651062012, 'val/ratio_var': 0.0011218253057450056, 'val/num_eos_tokens': 0, 'lr': 4.8e-05, 'episode': 1328, 'epoch': 0.25}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  4%|\u258d         | 1/25 [00:17<04:42, 11.78s/it]\r  8%|\u258a         | 2/25 [00:17<03:09,  8.26s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 85, 'objective/kl': 29.239538192749023, 'objective/entropy': 15.1424560546875, 'objective/non_score_reward': -1.4619771242141724, 'objective/rlhf_reward': 0.39769166707992554, 'objective/scores': 1.8596687316894531, 'policy/approxkl_avg': 0.744195818901062, 'policy/clipfrac_avg': 0.1413673609495163, 'loss/policy_avg': 0.06290891766548157, 'loss/value_avg': 5.902612686157227, 'val/clipfrac_avg': 0.47594624757766724, 'policy/entropy_avg': 0.30678999423980713, 'val/ratio': 0.9877206087112427, 'val/ratio_var': 0.0005079900729469955, 'val/num_eos_tokens': 0, 'lr': 4.600000000000001e-05, 'episode': 1992, 'epoch': 0.37}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 2/25 [00:23<03:09,  8.26s/it]\r 12%|\u2588\u258f        | 3/25 [00:23<02:36,  7.13s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913554.827577, "gpudata": {"0": {"memory": [11843.75, 46068.0], "load": 0.77, "temperature": 46.0, "power": 206.569}, "1": {"memory": [11827.75, 46068.0], "load": 0.77, "temperature": 46.0, "power": 197.086}, "2": {"memory": [11599.75, 46068.0], "load": 0.75, "temperature": 47.0, "power": 195.582}, "3": {"memory": [11631.75, 46068.0], "load": 0.75, "temperature": 46.0, "power": 199.232}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913554.827577, "iodata": {"read_count": 0, "write_count": 293, "read_bytes": 0, "read_time": 0, "write_time": 18, "busy_time": 144}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913554.827577, "netdata": {"bytes_sent": 488145318406, "bytes_recv": 509693764229, "packets_sent": 610208196, "packets_recv": 641817382, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913554.827577, "cpudata": {"memory": [17377128448, 1076052799488], "load": 10.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 91, 'objective/kl': 26.67173957824707, 'objective/entropy': 4.9740705490112305, 'objective/non_score_reward': -1.3335870504379272, 'objective/rlhf_reward': 0.5589450597763062, 'objective/scores': 1.8925321102142334, 'policy/approxkl_avg': 0.3257926106452942, 'policy/clipfrac_avg': 0.06276994943618774, 'loss/policy_avg': 0.02973431535065174, 'loss/value_avg': 3.7306575775146484, 'val/clipfrac_avg': 0.5286855101585388, 'policy/entropy_avg': 0.10833679139614105, 'val/ratio': 0.990814745426178, 'val/ratio_var': 7.280479621840641e-05, 'val/num_eos_tokens': 0, 'lr': 4.4000000000000006e-05, 'episode': 2656, 'epoch': 0.49}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 12%|\u2588\u258f        | 3/25 [00:29<02:36,  7.13s/it]\r 16%|\u2588\u258c        | 4/25 [00:29<02:18,  6.59s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913564.8441918, "gpudata": {"0": {"memory": [32935.75, 46068.0], "load": 1.0, "temperature": 44.0, "power": 206.832}, "1": {"memory": [40461.75, 46068.0], "load": 1.0, "temperature": 44.0, "power": 207.291}, "2": {"memory": [40119.75, 46068.0], "load": 1.0, "temperature": 45.0, "power": 211.826}, "3": {"memory": [40443.75, 46068.0], "load": 1.0, "temperature": 45.0, "power": 202.769}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913564.8441918, "iodata": {"read_count": 0, "write_count": 307, "read_bytes": 0, "read_time": 0, "write_time": 19, "busy_time": 168}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913564.8441918, "netdata": {"bytes_sent": 488145388380, "bytes_recv": 509693778851, "packets_sent": 610208283, "packets_recv": 641817461, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913564.8441918, "cpudata": {"memory": [17400029184, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 95, 'objective/kl': 28.470338821411133, 'objective/entropy': 3.060642957687378, 'objective/non_score_reward': -1.4235169887542725, 'objective/rlhf_reward': 0.46631932258605957, 'objective/scores': 1.8898359537124634, 'policy/approxkl_avg': 0.37318480014801025, 'policy/clipfrac_avg': 0.045820072293281555, 'loss/policy_avg': 0.016161546111106873, 'loss/value_avg': 2.9783377647399902, 'val/clipfrac_avg': 0.5063508749008179, 'policy/entropy_avg': 0.06692765653133392, 'val/ratio': 0.9929931163787842, 'val/ratio_var': 0.0002926455927081406, 'val/num_eos_tokens': 0, 'lr': 4.2e-05, 'episode': 3320, 'epoch': 0.61}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 16%|\u2588\u258c        | 4/25 [00:34<02:18,  6.59s/it]\r 20%|\u2588\u2588        | 5/25 [00:34<02:06,  6.30s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 97, 'objective/kl': 28.04718780517578, 'objective/entropy': 1.6127679347991943, 'objective/non_score_reward': -1.4023594856262207, 'objective/rlhf_reward': 0.48330628871917725, 'objective/scores': 1.885665774345398, 'policy/approxkl_avg': 0.36514154076576233, 'policy/clipfrac_avg': 0.030887702479958534, 'loss/policy_avg': 0.010355975478887558, 'loss/value_avg': 2.506653308868408, 'val/clipfrac_avg': 0.4996377229690552, 'policy/entropy_avg': 0.03974180668592453, 'val/ratio': 0.9908223152160645, 'val/ratio_var': 6.131531699793413e-05, 'val/num_eos_tokens': 0, 'lr': 4e-05, 'episode': 3984, 'epoch': 0.74}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 20%|\u2588\u2588        | 5/25 [00:40<02:06,  6.30s/it]\r 24%|\u2588\u2588\u258d       | 6/25 [00:40<01:56,  6.13s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913575.130177, "gpudata": {"0": {"memory": [9899.75, 46068.0], "load": 0.98, "temperature": 45.0, "power": 212.028}, "1": {"memory": [9883.75, 46068.0], "load": 0.98, "temperature": 45.0, "power": 193.865}, "2": {"memory": [9885.75, 46068.0], "load": 0.97, "temperature": 46.0, "power": 194.914}, "3": {"memory": [9851.75, 46068.0], "load": 0.97, "temperature": 45.0, "power": 188.419}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913575.130177, "iodata": {"read_count": 0, "write_count": 403, "read_bytes": 0, "read_time": 0, "write_time": 23, "busy_time": 192}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913575.130177, "netdata": {"bytes_sent": 488145427602, "bytes_recv": 509693804144, "packets_sent": 610208363, "packets_recv": 641817551, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913575.130177, "cpudata": {"memory": [17373949952, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 99, 'objective/kl': 21.936935424804688, 'objective/entropy': 0.9425574541091919, 'objective/non_score_reward': -1.0968468189239502, 'objective/rlhf_reward': 0.8934114575386047, 'objective/scores': 1.9902582168579102, 'policy/approxkl_avg': 0.1068105548620224, 'policy/clipfrac_avg': 0.016090305522084236, 'loss/policy_avg': 0.003487610025331378, 'loss/value_avg': 2.676352024078369, 'val/clipfrac_avg': 0.5132771730422974, 'policy/entropy_avg': 0.02237623557448387, 'val/ratio': 0.9949632287025452, 'val/ratio_var': 1.2627029718714766e-05, 'val/num_eos_tokens': 0, 'lr': 3.8e-05, 'episode': 4648, 'epoch': 0.86}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 24%|\u2588\u2588\u258d       | 6/25 [00:46<01:56,  6.13s/it]\r 28%|\u2588\u2588\u258a       | 7/25 [00:46<01:48,  6.03s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              ", "pipe": "stderr"}
{"event": "line", "data": "\r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 101, 'objective/kl': 21.310274124145508, 'objective/entropy': 0.589151918888092, 'objective/non_score_reward': -1.0655137300491333, 'objective/rlhf_reward': 0.9401881694793701, 'objective/scores': 2.005701780319214, 'policy/approxkl_avg': 0.07858924567699432, 'policy/clipfrac_avg': 0.01412252802401781, 'loss/policy_avg': 0.007865441963076591, 'loss/value_avg': 2.608198881149292, 'val/clipfrac_avg': 0.47487354278564453, 'policy/entropy_avg': 0.01797499880194664, 'val/ratio': 0.998279333114624, 'val/ratio_var': 6.916863640071824e-05, 'val/num_eos_tokens': 0, 'lr': 3.6e-05, 'episode': 5312, 'epoch': 0.98}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 28%|\u2588\u2588\u258a       | 7/25 [00:52<01:48,  6.03s/it]\r 32%|\u2588\u2588\u2588\u258f      | 8/25 [00:52<01:40,  5.93s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 3707.6405088253664, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7529.202531707393, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7653.164841063001, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7639.239300963313, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7725.714049259794, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7718.660499822292, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7730.065579663199, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7708.181883504975, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913585.14417, "gpudata": {"0": {"memory": [40493.75, 46068.0], "load": 0.87, "temperature": 50.0, "power": 296.163}, "1": {"memory": [40463.75, 46068.0], "load": 0.93, "temperature": 50.0, "power": 229.566}, "2": {"memory": [40463.75, 46068.0], "load": 0.92, "temperature": 51.0, "power": 263.989}, "3": {"memory": [40615.75, 46068.0], "load": 0.72, "temperature": 50.0, "power": 284.791}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913585.14417, "iodata": {"read_count": 0, "write_count": 483, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 216}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913585.14417, "netdata": {"bytes_sent": 488145438682, "bytes_recv": 509693817016, "packets_sent": 610208405, "packets_recv": 641817613, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913585.14417, "cpudata": {"memory": [17379139584, 1076052799488], "load": 10.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 102, 'objective/kl': 24.74767303466797, 'objective/entropy': 0.694058358669281, 'objective/non_score_reward': -1.2373838424682617, 'objective/rlhf_reward': 0.7631494998931885, 'objective/scores': 2.00053334236145, 'policy/approxkl_avg': 0.12104202806949615, 'policy/clipfrac_avg': 0.015557512640953064, 'loss/policy_avg': 0.013802530243992805, 'loss/value_avg': 2.5716304779052734, 'val/clipfrac_avg': 0.43471524119377136, 'policy/entropy_avg': 0.014731453731656075, 'val/ratio': 1.0035130977630615, 'val/ratio_var': 0.0005485832807607949, 'val/num_eos_tokens': 0, 'lr': 3.4000000000000007e-05, 'episode': 5976, 'epoch': 1.11}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 32%|\u2588\u2588\u2588\u258f      | 8/25 [00:58<01:40,  5.93s/it]\r 36%|\u2588\u2588\u2588\u258c      | 9/25 [00:58<01:34,  5.90s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 103, 'objective/kl': 29.176498413085938, 'objective/entropy': 0.6517770290374756, 'objective/non_score_reward': -1.458824872970581, 'objective/rlhf_reward': 0.5205248594284058, 'objective/scores': 1.9793498516082764, 'policy/approxkl_avg': 0.6818568706512451, 'policy/clipfrac_avg': 0.02663247287273407, 'loss/policy_avg': 0.01049720123410225, 'loss/value_avg': 2.1191225051879883, 'val/clipfrac_avg': 0.44288474321365356, 'policy/entropy_avg': 0.021812934428453445, 'val/ratio': 0.9894793629646301, 'val/ratio_var': 0.00025416931021027267, 'val/num_eos_tokens': 0, 'lr': 3.2000000000000005e-05, 'episode': 6640, 'epoch': 1.23}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 36%|\u2588\u2588\u2588\u258c      | 9/25 [01:03<01:34,  5.90s/it]\r 40%|\u2588\u2588\u2588\u2588      | 10/25 [01:03<01:28,  5.89s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913595.15825, "gpudata": {"0": {"memory": [12033.75, 46068.0], "load": 0.95, "temperature": 49.0, "power": 216.14}, "1": {"memory": [11931.75, 46068.0], "load": 0.9, "temperature": 50.0, "power": 197.6}, "2": {"memory": [11779.75, 46068.0], "load": 0.88, "temperature": 51.0, "power": 189.492}, "3": {"memory": [11863.75, 46068.0], "load": 0.89, "temperature": 50.0, "power": 190.406}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913595.15825, "iodata": {"read_count": 0, "write_count": 495, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 224}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913595.15825, "netdata": {"bytes_sent": 488145507496, "bytes_recv": 509693832350, "packets_sent": 610208495, "packets_recv": 641817700, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913595.15825, "cpudata": {"memory": [17381384192, 1076052799488], "load": 10.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 25.77301025390625, 'objective/entropy': 1.6024965047836304, 'objective/non_score_reward': -1.2886505126953125, 'objective/rlhf_reward': 0.7583139538764954, 'objective/scores': 2.046964645385742, 'policy/approxkl_avg': 0.4555093050003052, 'policy/clipfrac_avg': 0.0297226645052433, 'loss/policy_avg': 0.012920580804347992, 'loss/value_avg': 2.447115898132324, 'val/clipfrac_avg': 0.37812572717666626, 'policy/entropy_avg': 0.0416061207652092, 'val/ratio': 0.9906977415084839, 'val/ratio_var': 2.625440902193077e-05, 'val/num_eos_tokens': 0, 'lr': 3e-05, 'episode': 7304, 'epoch': 1.35}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 40%|\u2588\u2588\u2588\u2588      | 10/25 [01:09<01:28,  5.89s/it]\r 44%|\u2588\u2588\u2588\u2588\u258d     | 11/25 [01:09<01:22,  5.88s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913605.1732316, "gpudata": {"0": {"memory": [12387.75, 46068.0], "load": 1.0, "temperature": 48.0, "power": 207.505}, "1": {"memory": [12385.75, 46068.0], "load": 0.97, "temperature": 48.0, "power": 193.975}, "2": {"memory": [12459.75, 46068.0], "load": 0.97, "temperature": 49.0, "power": 193.007}, "3": {"memory": [12369.75, 46068.0], "load": 0.97, "temperature": 48.0, "power": 187.561}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913605.1732316, "iodata": {"read_count": 0, "write_count": 530, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 248}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913605.1732316, "netdata": {"bytes_sent": 488145546010, "bytes_recv": 509693855310, "packets_sent": 610208570, "packets_recv": 641817782, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913605.1732316, "cpudata": {"memory": [17391419392, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 21.87276268005371, 'objective/entropy': 1.1437292098999023, 'objective/non_score_reward': -1.0936381816864014, 'objective/rlhf_reward': 0.9337491989135742, 'objective/scores': 2.0273873805999756, 'policy/approxkl_avg': 0.09508571028709412, 'policy/clipfrac_avg': 0.026149407029151917, 'loss/policy_avg': 0.014295835979282856, 'loss/value_avg': 2.376610279083252, 'val/clipfrac_avg': 0.3501150608062744, 'policy/entropy_avg': 0.045003741979599, 'val/ratio': 1.0025169849395752, 'val/ratio_var': 0.0006349938339553773, 'val/num_eos_tokens': 0, 'lr': 2.8000000000000003e-05, 'episode': 7968, 'epoch': 1.47}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 44%|\u2588\u2588\u2588\u2588\u258d     | 11/25 [01:15<01:22,  5.88s/it]\r 48%|\u2588\u2588\u2588\u2588\u258a     | 12/25 [01:15<01:15,  5.82s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 23.990375518798828, 'objective/entropy': 1.0892853736877441, 'objective/non_score_reward': -1.1995187997817993, 'objective/rlhf_reward': 0.859499454498291, 'objective/scores': 2.05901837348938, 'policy/approxkl_avg': 0.08375266939401627, 'policy/clipfrac_avg': 0.01704222522675991, 'loss/policy_avg': 0.011713463813066483, 'loss/value_avg': 2.235161781311035, 'val/clipfrac_avg': 0.3538162112236023, 'policy/entropy_avg': 0.03283369541168213, 'val/ratio': 0.9994233846664429, 'val/ratio_var': 5.883847188670188e-05, 'val/num_eos_tokens': 0, 'lr': 2.6000000000000002e-05, 'episode': 8632, 'epoch': 1.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 48%|\u2588\u2588\u2588\u2588\u258a     | 12/25 [01:21<01:15,  5.82s/it]\r 52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 13/25 [01:21<01:09,  5.80s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913615.190117, "gpudata": {"0": {"memory": [40147.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 202.061}, "1": {"memory": [40463.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 235.441}, "2": {"memory": [40463.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 238.286}, "3": {"memory": [40113.75, 46068.0], "load": 0.99, "temperature": 52.0, "power": 236.985}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913615.190117, "iodata": {"read_count": 0, "write_count": 536, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 264}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913615.190117, "netdata": {"bytes_sent": 488145557410, "bytes_recv": 509693868494, "packets_sent": 610208617, "packets_recv": 641817848, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913615.190117, "cpudata": {"memory": [17402642432, 1076052799488], "load": 10.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 24.38801383972168, 'objective/entropy': 0.8234351873397827, 'objective/non_score_reward': -1.2194007635116577, 'objective/rlhf_reward': 0.848004162311554, 'objective/scores': 2.0674049854278564, 'policy/approxkl_avg': 0.33828356862068176, 'policy/clipfrac_avg': 0.01380995661020279, 'loss/policy_avg': 0.00556672178208828, 'loss/value_avg': 2.5639781951904297, 'val/clipfrac_avg': 0.30537480115890503, 'policy/entropy_avg': 0.02382727526128292, 'val/ratio': 1.0049992799758911, 'val/ratio_var': 0.0006082124309614301, 'val/num_eos_tokens': 0, 'lr': 2.4e-05, 'episode': 9296, 'epoch': 1.72}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 13/25 [01:26<01:09,  5.80s/it]\r 56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 14/25 [01:26<01:03,  5.77s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 20.718198776245117, 'objective/entropy': 0.4023769497871399, 'objective/non_score_reward': -1.03590989112854, 'objective/rlhf_reward': 1.0083413124084473, 'objective/scores': 2.0442512035369873, 'policy/approxkl_avg': 0.014314481988549232, 'policy/clipfrac_avg': 0.0069120824337005615, 'loss/policy_avg': 0.0032888695131987333, 'loss/value_avg': 2.1601946353912354, 'val/clipfrac_avg': 0.284027636051178, 'policy/entropy_avg': 0.01227568369358778, 'val/ratio': 0.9979363679885864, 'val/ratio_var': 5.013467671233229e-06, 'val/num_eos_tokens': 0, 'lr': 2.2000000000000003e-05, 'episode': 9960, 'epoch': 1.84}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 14/25 [01:32<01:03,  5.77s/it]\r 60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 15/25 [01:32<00:57,  5.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913625.2770197, "gpudata": {"0": {"memory": [9901.75, 46068.0], "load": 1.0, "temperature": 49.0, "power": 282.092}, "1": {"memory": [9885.75, 46068.0], "load": 0.83, "temperature": 49.0, "power": 224.879}, "2": {"memory": [9885.75, 46068.0], "load": 0.93, "temperature": 50.0, "power": 244.999}, "3": {"memory": [9851.75, 46068.0], "load": 0.96, "temperature": 49.0, "power": 263.3}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913625.2770197, "iodata": {"read_count": 0, "write_count": 554, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 280}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913625.2770197, "netdata": {"bytes_sent": 488145625789, "bytes_recv": 509693883046, "packets_sent": 610208703, "packets_recv": 641817926, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913625.2770197, "cpudata": {"memory": [17396133888, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 21.17122459411621, 'objective/entropy': 0.15124917030334473, 'objective/non_score_reward': -1.0585612058639526, 'objective/rlhf_reward': 0.9760032296180725, 'objective/scores': 2.03456449508667, 'policy/approxkl_avg': 0.026330340653657913, 'policy/clipfrac_avg': 0.00639349827542901, 'loss/policy_avg': 0.0021857749670743942, 'loss/value_avg': 2.135141372680664, 'val/clipfrac_avg': 0.2014165222644806, 'policy/entropy_avg': 0.011264155618846416, 'val/ratio': 0.999840497970581, 'val/ratio_var': 0.0002226968645118177, 'val/num_eos_tokens': 0, 'lr': 2e-05, 'episode': 10624, 'epoch': 1.97}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 15/25 [01:38<00:57,  5.78s/it]\r 64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 16/25 [01:38<00:51,  5.77s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7716.380381639867, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7517.53457310621, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7694.564356799482, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7716.7354057530465, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7659.4304861738365, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7679.8834694735815, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7603.82776088817, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7760.342959040407, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 23.036596298217773, 'objective/entropy': 0.7622324228286743, 'objective/non_score_reward': -1.151829719543457, 'objective/rlhf_reward': 0.931580662727356, 'objective/scores': 2.0834107398986816, 'policy/approxkl_avg': 0.2796298861503601, 'policy/clipfrac_avg': 0.011259661987423897, 'loss/policy_avg': 0.005790076218545437, 'loss/value_avg': 2.0480806827545166, 'val/clipfrac_avg': 0.16157080233097076, 'policy/entropy_avg': 0.008990388363599777, 'val/ratio': 0.9981619119644165, 'val/ratio_var': 1.3263722394185606e-05, 'val/num_eos_tokens': 0, 'lr': 1.8e-05, 'episode': 11288, 'epoch': 2.09}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 16/25 [01:44<00:51,  5.77s/it]\r 68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 17/25 [01:44<00:46,  5.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [17, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913635.2917829, "gpudata": {"0": {"memory": [10713.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 217.497}, "1": {"memory": [10711.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 201.084}, "2": {"memory": [10711.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 203.703}, "3": {"memory": [10675.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 190.606}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913635.2917829, "iodata": {"read_count": 0, "write_count": 554, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 280}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913635.2917829, "netdata": {"bytes_sent": 488145663201, "bytes_recv": 509693905746, "packets_sent": 610208773, "packets_recv": 641818005, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913635.2917829, "cpudata": {"memory": [17396961280, 1076052799488], "load": 10.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 20.615324020385742, 'objective/entropy': 0.14091110229492188, 'objective/non_score_reward': -1.030766248703003, 'objective/rlhf_reward': 1.039608120918274, 'objective/scores': 2.0703744888305664, 'policy/approxkl_avg': 0.004172786138951778, 'policy/clipfrac_avg': 0.003061775118112564, 'loss/policy_avg': 0.0016554816393181682, 'loss/value_avg': 2.071122407913208, 'val/clipfrac_avg': 0.10604683309793472, 'policy/entropy_avg': 0.00540001317858696, 'val/ratio': 0.9994028210639954, 'val/ratio_var': 2.5407074645045213e-05, 'val/num_eos_tokens': 0, 'lr': 1.6000000000000003e-05, 'episode': 11952, 'epoch': 2.21}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 17/25 [01:50<00:46,  5.79s/it]\r 72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 18/25 [01:50<00:40,  5.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [18, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913645.5689216, "gpudata": {"0": {"memory": [9901.75, 46068.0], "load": 0.99, "temperature": 48.0, "power": 194.222}, "1": {"memory": [9887.75, 46068.0], "load": 0.96, "temperature": 49.0, "power": 205.854}, "2": {"memory": [9883.75, 46068.0], "load": 0.96, "temperature": 50.0, "power": 205.276}, "3": {"memory": [9853.75, 46068.0], "load": 0.96, "temperature": 49.0, "power": 193.901}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913645.5689216, "iodata": {"read_count": 0, "write_count": 558, "read_bytes": 0, "read_time": 0, "write_time": 40, "busy_time": 288}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913645.5689216, "netdata": {"bytes_sent": 488145674351, "bytes_recv": 509693918650, "packets_sent": 610208816, "packets_recv": 641818068, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913645.5689216, "cpudata": {"memory": [17404305408, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 20.61918067932129, 'objective/entropy': 0.07146205753087997, 'objective/non_score_reward': -1.030959129333496, 'objective/rlhf_reward': 0.9856637716293335, 'objective/scores': 2.016622543334961, 'policy/approxkl_avg': 0.002508980454877019, 'policy/clipfrac_avg': 0.001115310238674283, 'loss/policy_avg': 0.0004699110868386924, 'loss/value_avg': 2.074204683303833, 'val/clipfrac_avg': 0.06422623991966248, 'policy/entropy_avg': 0.0018968068761751056, 'val/ratio': 0.9996625185012817, 'val/ratio_var': 2.9570972515102767e-07, 'val/num_eos_tokens': 0, 'lr': 1.4000000000000001e-05, 'episode': 12616, 'epoch': 2.33}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 18/25 [01:56<00:40,  5.79s/it]\r 76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 19/25 [01:56<00:34,  5.82s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [19, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': 20.971179962158203, 'objective/entropy': 0.042304836213588715, 'objective/non_score_reward': -1.0485590696334839, 'objective/rlhf_reward': 0.9748891592025757, 'objective/scores': 2.0234484672546387, 'policy/approxkl_avg': 0.001217299373820424, 'policy/clipfrac_avg': 0.0008666742360219359, 'loss/policy_avg': 0.00030606461223214865, 'loss/value_avg': 2.073277235031128, 'val/clipfrac_avg': 0.027818823233246803, 'policy/entropy_avg': 0.0013555525802075863, 'val/ratio': 0.9997572898864746, 'val/ratio_var': 5.03045441746508e-07, 'val/num_eos_tokens': 0, 'lr': 1.2e-05, 'episode': 13280, 'epoch': 2.46}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 19/25 [02:01<00:34,  5.82s/it]\r 80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 20/25 [02:01<00:28,  5.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [20, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913655.5833244, "gpudata": {"0": {"memory": [40005.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 211.412}, "1": {"memory": [40119.75, 46068.0], "load": 1.0, "temperature": 53.0, "power": 230.41}, "2": {"memory": [40463.75, 46068.0], "load": 1.0, "temperature": 53.0, "power": 229.646}, "3": {"memory": [40113.75, 46068.0], "load": 0.98, "temperature": 53.0, "power": 233.581}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913655.5833244, "iodata": {"read_count": 0, "write_count": 599, "read_bytes": 0, "read_time": 0, "write_time": 42, "busy_time": 304}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913655.5833244, "netdata": {"bytes_sent": 488145745780, "bytes_recv": 509693945032, "packets_sent": 610208935, "packets_recv": 641818191, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913655.5833244, "cpudata": {"memory": [17409777664, 1076052799488], "load": 10.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': 20.23406410217285, 'objective/entropy': 0.0439874567091465, 'objective/non_score_reward': -1.0117031335830688, 'objective/rlhf_reward': 1.0148435831069946, 'objective/scores': 2.0265467166900635, 'policy/approxkl_avg': 0.0014509230386465788, 'policy/clipfrac_avg': 0.00048306433018296957, 'loss/policy_avg': 0.0007083485252223909, 'loss/value_avg': 2.0598013401031494, 'val/clipfrac_avg': 0.012112127617001534, 'policy/entropy_avg': 0.0008209483930841088, 'val/ratio': 1.000011682510376, 'val/ratio_var': 4.1721116872395214e-07, 'val/num_eos_tokens': 0, 'lr': 1e-05, 'episode': 13944, 'epoch': 2.58}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 20/25 [02:07<00:28,  5.79s/it]\r 84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 21/25 [02:07<00:23,  5.77s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': 20.35547637939453, 'objective/entropy': 0.026616621762514114, 'objective/non_score_reward': -1.0177738666534424, 'objective/rlhf_reward': 1.0037941932678223, 'objective/scores': 2.0215680599212646, 'policy/approxkl_avg': 0.0037026347126811743, 'policy/clipfrac_avg': 0.000959024706389755, 'loss/policy_avg': -0.00016043288633227348, 'loss/value_avg': 2.0610151290893555, 'val/clipfrac_avg': 0.004688565619289875, 'policy/entropy_avg': 0.0012125904904678464, 'val/ratio': 0.9995489120483398, 'val/ratio_var': 2.852402474218252e-07, 'val/num_eos_tokens': 0, 'lr': 8.000000000000001e-06, 'episode': 14608, 'epoch': 2.7}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 21/25 [02:13<00:23,  5.77s/it]\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 22/25 [02:13<00:17,  5.76s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [22, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913665.715435, "gpudata": {"0": {"memory": [9901.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 238.25}, "1": {"memory": [9887.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 265.853}, "2": {"memory": [9887.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 268.398}, "3": {"memory": [9851.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 231.859}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913665.715435, "iodata": {"read_count": 0, "write_count": 613, "read_bytes": 0, "read_time": 0, "write_time": 46, "busy_time": 328}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913665.715435, "netdata": {"bytes_sent": 488145784417, "bytes_recv": 509693968140, "packets_sent": 610209012, "packets_recv": 641818275, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913665.715435, "cpudata": {"memory": [17406611456, 1076052799488], "load": 10.5}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': 20.00868797302246, 'objective/entropy': 0.03777293860912323, 'objective/non_score_reward': -1.000434398651123, 'objective/rlhf_reward': 1.0358303785324097, 'objective/scores': 2.036264657974243, 'policy/approxkl_avg': 0.0011728674871847034, 'policy/clipfrac_avg': 0.0005327915423549712, 'loss/policy_avg': 0.00039145335904322565, 'loss/value_avg': 2.053809642791748, 'val/clipfrac_avg': 0.002308763563632965, 'policy/entropy_avg': 0.0010556025663390756, 'val/ratio': 0.9999545812606812, 'val/ratio_var': 3.714005174515478e-07, 'val/num_eos_tokens': 0, 'lr': 6e-06, 'episode': 15272, 'epoch': 2.83}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 22/25 [02:19<00:17,  5.76s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 23/25 [02:19<00:11,  5.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [23, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 110, 'objective/kl': 19.96593475341797, 'objective/entropy': 0.02414914220571518, 'objective/non_score_reward': -0.9982966780662537, 'objective/rlhf_reward': 1.046250820159912, 'objective/scores': 2.0445475578308105, 'policy/approxkl_avg': 0.0011798779014497995, 'policy/clipfrac_avg': 0.0006180381751619279, 'loss/policy_avg': 7.703642040723935e-06, 'loss/value_avg': 2.052109718322754, 'val/clipfrac_avg': 0.001981984358280897, 'policy/entropy_avg': 0.001030354993417859, 'val/ratio': 0.9996702671051025, 'val/ratio_var': 7.481614261450886e-08, 'val/num_eos_tokens': 0, 'lr': 4.000000000000001e-06, 'episode': 15936, 'epoch': 2.95}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 23/25 [02:24<00:11,  5.79s/it]\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 24/25 [02:24<00:05,  5.77s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [24, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7620.971515973895, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7643.122992102036, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7655.072737072756, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7693.673809301341, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7602.062338204865, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7733.174550603742, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7569.19220578333, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7804.832487545315, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [24, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913675.7312102, "gpudata": {"0": {"memory": [10713.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 186.216}, "1": {"memory": [10731.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 209.303}, "2": {"memory": [10707.75, 46068.0], "load": 1.0, "temperature": 53.0, "power": 221.901}, "3": {"memory": [10687.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 187.219}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913675.7312102, "iodata": {"read_count": 0, "write_count": 635, "read_bytes": 0, "read_time": 0, "write_time": 47, "busy_time": 344}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913675.7312102, "netdata": {"bytes_sent": 488145853209, "bytes_recv": 509693983134, "packets_sent": 610209101, "packets_recv": 641818361, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733913675.7312102, "cpudata": {"memory": [17405800448, 1076052799488], "load": 10.4}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 110, 'objective/kl': 20.02218246459961, 'objective/entropy': 0.017536474391818047, 'objective/non_score_reward': -1.0011091232299805, 'objective/rlhf_reward': 1.032681941986084, 'objective/scores': 2.0337910652160645, 'policy/approxkl_avg': 0.0003596157184801996, 'policy/clipfrac_avg': 0.0003622982476372272, 'loss/policy_avg': 1.8111810277332552e-05, 'loss/value_avg': 2.051453113555908, 'val/clipfrac_avg': 0.0013071151915937662, 'policy/entropy_avg': 0.00103999231941998, 'val/ratio': 0.9998804330825806, 'val/ratio_var': 9.047809612638957e-08, 'val/num_eos_tokens': 0, 'lr': 2.0000000000000003e-06, 'episode': 16600, 'epoch': 3.07}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 24/25 [02:30<00:05,  5.77s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25/25 [02:30<00:00,  5.80s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25/25 [02:30<00:00,  6.03s/it]", "pipe": "stderr"}
{"event": "line", "data": "\n", "pipe": "stderr"}
{"event": "line", "data": "[rank0]:[W1211 05:41:21.406693565 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "166", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733913683.57281, "return_code": 0}, "pipe": null}
