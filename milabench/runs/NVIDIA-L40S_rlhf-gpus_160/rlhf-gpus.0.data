{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-l040.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-l040.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-L40S_rlhf-gpus_160.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 48, "brand": "Intel(R) Xeon(R) Gold 5418Y"}, "os": {"sysname": "Linux", "nodename": "cn-l040.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "0", "device": 0, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 38.0, "power": 50.146, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "1", "device": 1, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 38.0, "power": 50.746, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "2", "device": 2, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 39.0, "power": 37.307, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "3", "device": 3, "product": "NVIDIA L40S", "memory": {"used": 359.125, "total": 46068.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 38.0, "power": 36.866, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1733930292.475504, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "160", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733912292.5382447}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/26 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1733912320.1488473, "gpudata": {"0": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 36.0, "power": 102.768}, "1": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 36.0, "power": 102.228}, "2": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 37.0, "power": 103.529}, "3": {"memory": [4697.75, 46068.0], "load": 0.0, "temperature": 36.0, "power": 101.918}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912320.1488473, "iodata": {"read_count": 0, "write_count": 84, "read_bytes": 0, "read_time": 0, "write_time": 3, "busy_time": 16}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912320.1488473, "netdata": {"bytes_sent": 488139356625, "bytes_recv": 509689311363, "packets_sent": 610187879, "packets_recv": 641795982, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912320.1488473, "cpudata": {"memory": [15596167168, 1076052799488], "load": 0.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 54, 'objective/kl': 0.00017477897927165031, 'objective/entropy': 92.22233581542969, 'objective/non_score_reward': -8.738948054087814e-06, 'objective/rlhf_reward': 6.061892032623291, 'objective/scores': 6.061900615692139, 'policy/approxkl_avg': 2.243629217147827, 'policy/clipfrac_avg': 0.40079599618911743, 'loss/policy_avg': 0.22422468662261963, 'loss/value_avg': 9.544503211975098, 'val/clipfrac_avg': 0.3410377502441406, 'policy/entropy_avg': 1.560911774635315, 'val/ratio': 0.9582818746566772, 'val/ratio_var': 0.0015681736404076219, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 640, 'epoch': 0.12}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/26 [00:11<?, ?it/s]\r  4%|\u258d         | 1/26 [00:11<04:54, 11.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912330.1557384, "gpudata": {"0": {"memory": [38999.75, 46068.0], "load": 0.9, "temperature": 43.0, "power": 264.524}, "1": {"memory": [38731.75, 46068.0], "load": 0.92, "temperature": 44.0, "power": 250.211}, "2": {"memory": [38857.75, 46068.0], "load": 0.93, "temperature": 44.0, "power": 264.081}, "3": {"memory": [39463.75, 46068.0], "load": 0.94, "temperature": 44.0, "power": 234.963}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912330.1557384, "iodata": {"read_count": 0, "write_count": 101, "read_bytes": 0, "read_time": 0, "write_time": 4, "busy_time": 32}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912330.1557384, "netdata": {"bytes_sent": 488139426061, "bytes_recv": 509689325975, "packets_sent": 610187965, "packets_recv": 641796061, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912330.1557384, "cpudata": {"memory": [17259970560, 1076052799488], "load": 9.9}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 72, 'objective/kl': 30.17909812927246, 'objective/entropy': 46.39545822143555, 'objective/non_score_reward': -1.5089550018310547, 'objective/rlhf_reward': 4.471958637237549, 'objective/scores': 5.980913162231445, 'policy/approxkl_avg': 1.420807957649231, 'policy/clipfrac_avg': 0.2754422426223755, 'loss/policy_avg': 0.1503492295742035, 'loss/value_avg': 7.631504535675049, 'val/clipfrac_avg': 0.3330262303352356, 'policy/entropy_avg': 0.8630703091621399, 'val/ratio': 0.9789952039718628, 'val/ratio_var': 0.001366412383504212, 'val/num_eos_tokens': 0, 'lr': 4.8076923076923084e-05, 'episode': 1280, 'epoch': 0.24}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  4%|\u258d         | 1/26 [00:17<04:54, 11.79s/it]\r  8%|\u258a         | 2/26 [00:17<03:17,  8.24s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 82, 'objective/kl': 49.77543640136719, 'objective/entropy': 20.628318786621094, 'objective/non_score_reward': -2.488771915435791, 'objective/rlhf_reward': 3.467653751373291, 'objective/scores': 5.956425666809082, 'policy/approxkl_avg': 0.9340004920959473, 'policy/clipfrac_avg': 0.18049085140228271, 'loss/policy_avg': 0.08919645845890045, 'loss/value_avg': 7.04383659362793, 'val/clipfrac_avg': 0.34790682792663574, 'policy/entropy_avg': 0.40842968225479126, 'val/ratio': 0.9769830703735352, 'val/ratio_var': 0.0005469636525958776, 'val/num_eos_tokens': 2, 'lr': 4.615384615384616e-05, 'episode': 1920, 'epoch': 0.36}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 2/26 [00:23<03:17,  8.24s/it]\r 12%|\u2588\u258f        | 3/26 [00:23<02:42,  7.08s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912340.1703641, "gpudata": {"0": {"memory": [12329.75, 46068.0], "load": 0.76, "temperature": 43.0, "power": 225.032}, "1": {"memory": [12345.75, 46068.0], "load": 0.75, "temperature": 43.0, "power": 215.006}, "2": {"memory": [12571.75, 46068.0], "load": 0.75, "temperature": 44.0, "power": 218.465}, "3": {"memory": [12321.75, 46068.0], "load": 0.77, "temperature": 43.0, "power": 236.697}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912340.1703641, "iodata": {"read_count": 0, "write_count": 146, "read_bytes": 0, "read_time": 0, "write_time": 5, "busy_time": 64}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912340.1703641, "netdata": {"bytes_sent": 488139465794, "bytes_recv": 509689359745, "packets_sent": 610188059, "packets_recv": 641796181, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912340.1703641, "cpudata": {"memory": [17287168000, 1076052799488], "load": 10.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 88, 'objective/kl': 41.36138153076172, 'objective/entropy': 9.535322189331055, 'objective/non_score_reward': -2.0680689811706543, 'objective/rlhf_reward': 3.9150519371032715, 'objective/scores': 5.983120918273926, 'policy/approxkl_avg': 0.8789695501327515, 'policy/clipfrac_avg': 0.12460200488567352, 'loss/policy_avg': 0.06122010946273804, 'loss/value_avg': 7.121114730834961, 'val/clipfrac_avg': 0.41872793436050415, 'policy/entropy_avg': 0.23118533194065094, 'val/ratio': 0.9969749450683594, 'val/ratio_var': 0.0034387633204460144, 'val/num_eos_tokens': 0, 'lr': 4.423076923076923e-05, 'episode': 2560, 'epoch': 0.47}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 12%|\u2588\u258f        | 3/26 [00:28<02:42,  7.08s/it]\r 15%|\u2588\u258c        | 4/26 [00:28<02:23,  6.51s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912350.1856625, "gpudata": {"0": {"memory": [38893.75, 46068.0], "load": 1.0, "temperature": 43.0, "power": 190.952}, "1": {"memory": [39509.75, 46068.0], "load": 0.99, "temperature": 44.0, "power": 203.142}, "2": {"memory": [38857.75, 46068.0], "load": 0.99, "temperature": 44.0, "power": 203.553}, "3": {"memory": [38935.75, 46068.0], "load": 1.0, "temperature": 44.0, "power": 187.711}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912350.1856625, "iodata": {"read_count": 0, "write_count": 212, "read_bytes": 0, "read_time": 0, "write_time": 15, "busy_time": 88}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912350.1856625, "netdata": {"bytes_sent": 488139477454, "bytes_recv": 509689372733, "packets_sent": 610188108, "packets_recv": 641796240, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912350.1856625, "cpudata": {"memory": [17288167424, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 92, 'objective/kl': 45.32023620605469, 'objective/entropy': 8.791326522827148, 'objective/non_score_reward': -2.2660117149353027, 'objective/rlhf_reward': 3.7655766010284424, 'objective/scores': 6.031588554382324, 'policy/approxkl_avg': 1.0962932109832764, 'policy/clipfrac_avg': 0.11432045698165894, 'loss/policy_avg': 0.05870601162314415, 'loss/value_avg': 7.168252468109131, 'val/clipfrac_avg': 0.3580188751220703, 'policy/entropy_avg': 0.20996016263961792, 'val/ratio': 0.9760230183601379, 'val/ratio_var': 0.0012979673920199275, 'val/num_eos_tokens': 0, 'lr': 4.230769230769231e-05, 'episode': 3200, 'epoch': 0.59}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 15%|\u2588\u258c        | 4/26 [00:34<02:23,  6.51s/it]\r 19%|\u2588\u2589        | 5/26 [00:34<02:10,  6.21s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 95, 'objective/kl': 49.94029998779297, 'objective/entropy': 6.898021697998047, 'objective/non_score_reward': -2.4970149993896484, 'objective/rlhf_reward': 3.5260915756225586, 'objective/scores': 6.023106575012207, 'policy/approxkl_avg': 1.0932095050811768, 'policy/clipfrac_avg': 0.09564416110515594, 'loss/policy_avg': 0.044777147471904755, 'loss/value_avg': 6.911796569824219, 'val/clipfrac_avg': 0.31996607780456543, 'policy/entropy_avg': 0.15298497676849365, 'val/ratio': 0.9786813259124756, 'val/ratio_var': 0.0008017616928555071, 'val/num_eos_tokens': 0, 'lr': 4.038461538461539e-05, 'episode': 3840, 'epoch': 0.71}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 19%|\u2588\u2589        | 5/26 [00:40<02:10,  6.21s/it]\r 23%|\u2588\u2588\u258e       | 6/26 [00:40<02:00,  6.03s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912360.2002702, "gpudata": {"0": {"memory": [38999.75, 46068.0], "load": 1.0, "temperature": 45.0, "power": 208.918}, "1": {"memory": [30699.75, 46068.0], "load": 1.0, "temperature": 46.0, "power": 217.311}, "2": {"memory": [32073.75, 46068.0], "load": 1.0, "temperature": 46.0, "power": 216.133}, "3": {"memory": [39463.75, 46068.0], "load": 1.0, "temperature": 45.0, "power": 196.31}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912360.2002702, "iodata": {"read_count": 0, "write_count": 242, "read_bytes": 0, "read_time": 0, "write_time": 16, "busy_time": 128}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912360.2002702, "netdata": {"bytes_sent": 488139546867, "bytes_recv": 509689387873, "packets_sent": 610188197, "packets_recv": 641796325, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912360.2002702, "cpudata": {"memory": [17291235328, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 97, 'objective/kl': 39.83310317993164, 'objective/entropy': 3.3315961360931396, 'objective/non_score_reward': -1.9916552305221558, 'objective/rlhf_reward': 4.027019500732422, 'objective/scores': 6.018675327301025, 'policy/approxkl_avg': 0.5365316271781921, 'policy/clipfrac_avg': 0.05720076709985733, 'loss/policy_avg': 0.026721568778157234, 'loss/value_avg': 6.828827381134033, 'val/clipfrac_avg': 0.3986070156097412, 'policy/entropy_avg': 0.08414450287818909, 'val/ratio': 0.9831044673919678, 'val/ratio_var': 3.502145045786165e-05, 'val/num_eos_tokens': 0, 'lr': 3.846153846153846e-05, 'episode': 4480, 'epoch': 0.83}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 23%|\u2588\u2588\u258e       | 6/26 [00:45<02:00,  6.03s/it]\r 27%|\u2588\u2588\u258b       | 7/26 [00:45<01:52,  5.92s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 99, 'objective/kl': 29.948692321777344, 'objective/entropy': 2.4103665351867676, 'objective/non_score_reward': -1.4974346160888672, 'objective/rlhf_reward': 4.486904144287109, 'objective/scores': 5.984338760375977, 'policy/approxkl_avg': 0.26978781819343567, 'policy/clipfrac_avg': 0.04922612011432648, 'loss/policy_avg': 0.02645101398229599, 'loss/value_avg': 6.826696395874023, 'val/clipfrac_avg': 0.43118366599082947, 'policy/entropy_avg': 0.06954599171876907, 'val/ratio': 0.997324526309967, 'val/ratio_var': 0.00023645687906537205, 'val/num_eos_tokens': 0, 'lr': 3.653846153846154e-05, 'episode': 5120, 'epoch': 0.95}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 27%|\u2588\u2588\u258b       | 7/26 [00:51<01:52,  5.92s/it]\r 31%|\u2588\u2588\u2588       | 8/26 [00:51<01:44,  5.83s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 3559.948682233535, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7346.893018493537, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7470.953300199145, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7548.039440753442, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7475.4235310312215, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7606.903730111469, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7633.350694371319, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7602.996964208527, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912370.24902, "gpudata": {"0": {"memory": [9915.75, 46068.0], "load": 0.97, "temperature": 45.0, "power": 201.439}, "1": {"memory": [9359.75, 46068.0], "load": 0.96, "temperature": 45.0, "power": 215.418}, "2": {"memory": [9649.75, 46068.0], "load": 0.97, "temperature": 45.0, "power": 229.412}, "3": {"memory": [9883.75, 46068.0], "load": 0.97, "temperature": 45.0, "power": 216.839}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912370.24902, "iodata": {"read_count": 0, "write_count": 272, "read_bytes": 0, "read_time": 0, "write_time": 17, "busy_time": 136}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912370.24902, "netdata": {"bytes_sent": 488139584328, "bytes_recv": 509689411171, "packets_sent": 610188265, "packets_recv": 641796405, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912370.24902, "cpudata": {"memory": [17288077312, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 100, 'objective/kl': 48.07035827636719, 'objective/entropy': 5.0263352394104, 'objective/non_score_reward': -2.403517961502075, 'objective/rlhf_reward': 3.6598551273345947, 'objective/scores': 6.06337308883667, 'policy/approxkl_avg': 19.31319236755371, 'policy/clipfrac_avg': 0.13609227538108826, 'loss/policy_avg': 0.12839347124099731, 'loss/value_avg': 6.38142204284668, 'val/clipfrac_avg': 0.3191995620727539, 'policy/entropy_avg': 0.0597563162446022, 'val/ratio': 1.0385857820510864, 'val/ratio_var': 0.05232910066843033, 'val/num_eos_tokens': 0, 'lr': 3.461538461538462e-05, 'episode': 5760, 'epoch': 1.07}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 31%|\u2588\u2588\u2588       | 8/26 [00:57<01:44,  5.83s/it]\r 35%|\u2588\u2588\u2588\u258d      | 9/26 [00:57<01:38,  5.78s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 101, 'objective/kl': 44.367042541503906, 'objective/entropy': 0.061435867100954056, 'objective/non_score_reward': -2.2183523178100586, 'objective/rlhf_reward': 3.95040225982666, 'objective/scores': 6.1687541007995605, 'policy/approxkl_avg': 0.011053397320210934, 'policy/clipfrac_avg': 0.0009433962404727936, 'loss/policy_avg': 0.0009501351742073894, 'loss/value_avg': 6.033626079559326, 'val/clipfrac_avg': 0.3893793821334839, 'policy/entropy_avg': 0.0006411327631212771, 'val/ratio': 1.0000149011611938, 'val/ratio_var': 6.659272457909537e-07, 'val/num_eos_tokens': 0, 'lr': 3.269230769230769e-05, 'episode': 6400, 'epoch': 1.18}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 35%|\u2588\u2588\u2588\u258d      | 9/26 [01:02<01:38,  5.78s/it]\r 38%|\u2588\u2588\u2588\u258a      | 10/26 [01:02<01:32,  5.75s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912380.2634335, "gpudata": {"0": {"memory": [9913.75, 46068.0], "load": 0.76, "temperature": 51.0, "power": 252.06}, "1": {"memory": [9353.75, 46068.0], "load": 0.78, "temperature": 52.0, "power": 239.797}, "2": {"memory": [9647.75, 46068.0], "load": 0.76, "temperature": 51.0, "power": 245.342}, "3": {"memory": [9885.75, 46068.0], "load": 0.8, "temperature": 51.0, "power": 244.194}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912380.2634335, "iodata": {"read_count": 0, "write_count": 280, "read_bytes": 0, "read_time": 0, "write_time": 18, "busy_time": 152}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912380.2634335, "netdata": {"bytes_sent": 488139597108, "bytes_recv": 509689424597, "packets_sent": 610188320, "packets_recv": 641796469, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912380.2634335, "cpudata": {"memory": [17291862016, 1076052799488], "load": 10.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 102, 'objective/kl': 43.275062561035156, 'objective/entropy': 6.728847074555233e-05, 'objective/non_score_reward': -2.1637535095214844, 'objective/rlhf_reward': 4.0015034675598145, 'objective/scores': 6.165256500244141, 'policy/approxkl_avg': 1.668863319537195e-06, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 3.092342467425624e-06, 'loss/value_avg': 5.997688293457031, 'val/clipfrac_avg': 0.41561028361320496, 'policy/entropy_avg': 1.9365884327271488e-06, 'val/ratio': 0.9999967813491821, 'val/ratio_var': 2.1556575968695313e-10, 'val/num_eos_tokens': 0, 'lr': 3.0769230769230774e-05, 'episode': 7040, 'epoch': 1.3}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 38%|\u2588\u2588\u2588\u258a      | 10/26 [01:08<01:32,  5.75s/it]\r 42%|\u2588\u2588\u2588\u2588\u258f     | 11/26 [01:08<01:25,  5.73s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 103, 'objective/kl': 43.399375915527344, 'objective/entropy': 9.104240916713024e-07, 'objective/non_score_reward': -2.169968605041504, 'objective/rlhf_reward': 4.004631996154785, 'objective/scores': 6.174601078033447, 'policy/approxkl_avg': 1.0547837559979345e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 2.272778587553148e-08, 'loss/value_avg': 6.021387100219727, 'val/clipfrac_avg': 0.2645931839942932, 'policy/entropy_avg': -7.972627827257384e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 2.8846153846153845e-05, 'episode': 7680, 'epoch': 1.42}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 42%|\u2588\u2588\u2588\u2588\u258f     | 11/26 [01:14<01:25,  5.73s/it]\r 46%|\u2588\u2588\u2588\u2588\u258c     | 12/26 [01:14<01:19,  5.68s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912390.2809162, "gpudata": {"0": {"memory": [9915.75, 46068.0], "load": 0.98, "temperature": 45.0, "power": 214.071}, "1": {"memory": [9349.75, 46068.0], "load": 1.0, "temperature": 48.0, "power": 197.268}, "2": {"memory": [9645.75, 46068.0], "load": 1.0, "temperature": 46.0, "power": 188.217}, "3": {"memory": [10685.75, 46068.0], "load": 0.99, "temperature": 50.0, "power": 185.844}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912390.2809162, "iodata": {"read_count": 0, "write_count": 303, "read_bytes": 0, "read_time": 0, "write_time": 20, "busy_time": 172}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912390.2809162, "netdata": {"bytes_sent": 488139665770, "bytes_recv": 509689439109, "packets_sent": 610188405, "packets_recv": 641796550, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912390.2809162, "cpudata": {"memory": [17291149312, 1076052799488], "load": 10.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 43.611907958984375, 'objective/entropy': 1.3858050351700513e-07, 'objective/non_score_reward': -2.180595636367798, 'objective/rlhf_reward': 3.9941153526306152, 'objective/scores': 6.174710750579834, 'policy/approxkl_avg': 4.748669990214949e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 3.4160176909381335e-09, 'loss/value_avg': 5.515974998474121, 'val/clipfrac_avg': 0.3281618654727936, 'policy/entropy_avg': -7.484994057449512e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 2.6923076923076923e-05, 'episode': 8320, 'epoch': 1.54}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 46%|\u2588\u2588\u2588\u2588\u258c     | 12/26 [01:19<01:19,  5.68s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 13/26 [01:19<01:13,  5.66s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912400.4101253, "gpudata": {"0": {"memory": [9915.75, 46068.0], "load": 0.97, "temperature": 46.0, "power": 200.833}, "1": {"memory": [9371.75, 46068.0], "load": 0.98, "temperature": 46.0, "power": 191.856}, "2": {"memory": [9647.75, 46068.0], "load": 0.99, "temperature": 47.0, "power": 181.995}, "3": {"memory": [9887.75, 46068.0], "load": 0.98, "temperature": 46.0, "power": 191.805}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912400.4101253, "iodata": {"read_count": 0, "write_count": 303, "read_bytes": 0, "read_time": 0, "write_time": 20, "busy_time": 172}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912400.4101253, "netdata": {"bytes_sent": 488139702919, "bytes_recv": 509689462105, "packets_sent": 610188471, "packets_recv": 641796634, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912400.4101253, "cpudata": {"memory": [17288724480, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 44.1207275390625, 'objective/entropy': 1.7974468846659875e-07, 'objective/non_score_reward': -2.206036329269409, 'objective/rlhf_reward': 3.966127872467041, 'objective/scores': 6.1721649169921875, 'policy/approxkl_avg': 9.351657902917365e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 1.2488509071317822e-07, 'loss/value_avg': 5.562728404998779, 'val/clipfrac_avg': 0.25013267993927, 'policy/entropy_avg': -7.350489795499016e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 8960, 'epoch': 1.66}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 13/26 [01:25<01:13,  5.66s/it]\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 14/26 [01:25<01:08,  5.67s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [14, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 44.17182922363281, 'objective/entropy': 1.6633356381134945e-07, 'objective/non_score_reward': -2.2085916996002197, 'objective/rlhf_reward': 3.9616305828094482, 'objective/scores': 6.170222282409668, 'policy/approxkl_avg': 2.2043150724876392e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 8.15662843933751e-08, 'loss/value_avg': 5.394038200378418, 'val/clipfrac_avg': 0.24913030862808228, 'policy/entropy_avg': -7.653686225239653e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 2.307692307692308e-05, 'episode': 9600, 'epoch': 1.78}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 14/26 [01:31<01:08,  5.67s/it]\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 15/26 [01:31<01:02,  5.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [15, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912410.4246657, "gpudata": {"0": {"memory": [38999.75, 46068.0], "load": 1.0, "temperature": 48.0, "power": 211.6}, "1": {"memory": [38885.75, 46068.0], "load": 1.0, "temperature": 49.0, "power": 207.156}, "2": {"memory": [39385.75, 46068.0], "load": 1.0, "temperature": 49.0, "power": 189.362}, "3": {"memory": [39567.75, 46068.0], "load": 1.0, "temperature": 48.0, "power": 196.756}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912410.4246657, "iodata": {"read_count": 0, "write_count": 336, "read_bytes": 0, "read_time": 0, "write_time": 29, "busy_time": 204}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912410.4246657, "netdata": {"bytes_sent": 488139714639, "bytes_recv": 509689475981, "packets_sent": 610188521, "packets_recv": 641796703, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912410.4246657, "cpudata": {"memory": [17292587008, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 105, 'objective/kl': 44.42097091674805, 'objective/entropy': 2.1252714077490964e-07, 'objective/non_score_reward': -2.2210488319396973, 'objective/rlhf_reward': 3.9494740962982178, 'objective/scores': 6.170522689819336, 'policy/approxkl_avg': 9.452557009695384e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 5.143008507957347e-08, 'loss/value_avg': 5.24497127532959, 'val/clipfrac_avg': 0.2455630898475647, 'policy/entropy_avg': -8.048651579883881e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 2.1153846153846154e-05, 'episode': 10240, 'epoch': 1.89}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 15/26 [01:36<01:02,  5.65s/it]\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 16/26 [01:36<00:56,  5.66s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7629.436811576993, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7561.149282695506, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7606.034232966484, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7582.024683631176, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7568.146106238611, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7546.621646124583, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7504.4033768916415, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7532.160846806092, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [16, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 44.30565643310547, 'objective/entropy': 2.1401655203590053e-07, 'objective/non_score_reward': -2.215282917022705, 'objective/rlhf_reward': 3.9495038986206055, 'objective/scores': 6.1647868156433105, 'policy/approxkl_avg': 4.194655039979622e-11, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': -3.5495691719233946e-08, 'loss/value_avg': 5.131918430328369, 'val/clipfrac_avg': 0.20428213477134705, 'policy/entropy_avg': -7.385577646346064e-06, 'val/ratio': 1.0, 'val/ratio_var': 1.2434497875801753e-14, 'val/num_eos_tokens': 0, 'lr': 1.923076923076923e-05, 'episode': 10880, 'epoch': 2.01}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 16/26 [01:42<00:56,  5.66s/it]\r 65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 17/26 [01:42<00:51,  5.67s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [17, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912420.4388554, "gpudata": {"0": {"memory": [21897.75, 46068.0], "load": 0.53, "temperature": 51.0, "power": 245.503}, "1": {"memory": [22199.75, 46068.0], "load": 0.42, "temperature": 51.0, "power": 220.705}, "2": {"memory": [21853.75, 46068.0], "load": 0.28, "temperature": 51.0, "power": 269.012}, "3": {"memory": [23231.75, 46068.0], "load": 0.5, "temperature": 50.0, "power": 264.306}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912420.4388554, "iodata": {"read_count": 0, "write_count": 382, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 236}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912420.4388554, "netdata": {"bytes_sent": 488139782963, "bytes_recv": 509689490215, "packets_sent": 610188604, "packets_recv": 641796781, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912420.4388554, "cpudata": {"memory": [17294852096, 1076052799488], "load": 10.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 44.60490798950195, 'objective/entropy': 1.1641510155868673e-07, 'objective/non_score_reward': -2.2302451133728027, 'objective/rlhf_reward': 3.9381208419799805, 'objective/scores': 6.168365955352783, 'policy/approxkl_avg': 6.236933712544523e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': -4.853422552741904e-09, 'loss/value_avg': 5.060544013977051, 'val/clipfrac_avg': 0.17179392278194427, 'policy/entropy_avg': -7.267268301802687e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 1.730769230769231e-05, 'episode': 11520, 'epoch': 2.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 17/26 [01:48<00:51,  5.67s/it]\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 18/26 [01:48<00:45,  5.67s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [18, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 106, 'objective/kl': 43.743431091308594, 'objective/entropy': 2.3264340143214213e-07, 'objective/non_score_reward': -2.187171459197998, 'objective/rlhf_reward': 3.981217384338379, 'objective/scores': 6.168388843536377, 'policy/approxkl_avg': 1.2762486380213378e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 1.7211895908531005e-08, 'loss/value_avg': 4.9747819900512695, 'val/clipfrac_avg': 0.20321343839168549, 'policy/entropy_avg': -7.668981197639368e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 1.5384615384615387e-05, 'episode': 12160, 'epoch': 2.25}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 18/26 [01:53<00:45,  5.67s/it]\r 73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 19/26 [01:53<00:39,  5.67s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [19, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912430.4555216, "gpudata": {"0": {"memory": [11577.75, 46068.0], "load": 0.83, "temperature": 51.0, "power": 208.407}, "1": {"memory": [11419.75, 46068.0], "load": 0.79, "temperature": 50.0, "power": 205.593}, "2": {"memory": [11657.75, 46068.0], "load": 0.81, "temperature": 51.0, "power": 206.151}, "3": {"memory": [11671.75, 46068.0], "load": 0.83, "temperature": 51.0, "power": 196.777}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912430.4555216, "iodata": {"read_count": 0, "write_count": 398, "read_bytes": 0, "read_time": 0, "write_time": 31, "busy_time": 252}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912430.4555216, "netdata": {"bytes_sent": 488139820333, "bytes_recv": 509689513409, "packets_sent": 610188673, "packets_recv": 641796867, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912430.4555216, "cpudata": {"memory": [17301544960, 1076052799488], "load": 10.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 44.564796447753906, 'objective/entropy': 1.5627557559128036e-07, 'objective/non_score_reward': -2.2282400131225586, 'objective/rlhf_reward': 3.948265314102173, 'objective/scores': 6.176505088806152, 'policy/approxkl_avg': 1.7261604472185166e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 1.6521308765504727e-08, 'loss/value_avg': 4.943266868591309, 'val/clipfrac_avg': 0.10623525083065033, 'policy/entropy_avg': -7.341493073909078e-06, 'val/ratio': 1.0, 'val/ratio_var': 7.10542746348012e-16, 'val/num_eos_tokens': 0, 'lr': 1.3461538461538462e-05, 'episode': 12800, 'epoch': 2.37}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 19/26 [01:59<00:39,  5.67s/it]\r 77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 20/26 [01:59<00:33,  5.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [20, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912440.4701493, "gpudata": {"0": {"memory": [38893.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 220.669}, "1": {"memory": [38731.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 210.188}, "2": {"memory": [39385.75, 46068.0], "load": 1.0, "temperature": 53.0, "power": 230.669}, "3": {"memory": [38935.75, 46068.0], "load": 1.0, "temperature": 52.0, "power": 219.223}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912440.4701493, "iodata": {"read_count": 0, "write_count": 398, "read_bytes": 0, "read_time": 0, "write_time": 31, "busy_time": 252}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912440.4701493, "netdata": {"bytes_sent": 488139834371, "bytes_recv": 509689536985, "packets_sent": 610188743, "packets_recv": 641796946, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912440.4701493, "cpudata": {"memory": [17302298624, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 44.21372985839844, 'objective/entropy': 1.3671771625922702e-07, 'objective/non_score_reward': -2.210686683654785, 'objective/rlhf_reward': 3.949258327484131, 'objective/scores': 6.159945011138916, 'policy/approxkl_avg': 1.0698463599398411e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 4.656614649434232e-09, 'loss/value_avg': 4.875129699707031, 'val/clipfrac_avg': 0.19016805291175842, 'policy/entropy_avg': -7.863314749556594e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 1.153846153846154e-05, 'episode': 13440, 'epoch': 2.49}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 20/26 [02:05<00:33,  5.65s/it]\r 81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 21/26 [02:05<00:28,  5.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [21, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 43.554588317871094, 'objective/entropy': 1.769507207427523e-07, 'objective/non_score_reward': -2.177729606628418, 'objective/rlhf_reward': 3.9918580055236816, 'objective/scores': 6.1695876121521, 'policy/approxkl_avg': 1.040137810950914e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 6.517501205394183e-09, 'loss/value_avg': 4.8653106689453125, 'val/clipfrac_avg': 0.001437205239199102, 'policy/entropy_avg': -7.573164111818187e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 9.615384615384616e-06, 'episode': 14080, 'epoch': 2.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 21/26 [02:10<00:28,  5.65s/it]\r 85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 22/26 [02:10<00:22,  5.63s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [22, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912450.4842103, "gpudata": {"0": {"memory": [20325.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 208.282}, "1": {"memory": [19223.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 200.203}, "2": {"memory": [20099.75, 46068.0], "load": 1.0, "temperature": 51.0, "power": 202.866}, "3": {"memory": [21223.75, 46068.0], "load": 1.0, "temperature": 50.0, "power": 200.887}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912450.4842103, "iodata": {"read_count": 0, "write_count": 441, "read_bytes": 0, "read_time": 0, "write_time": 32, "busy_time": 284}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912450.4842103, "netdata": {"bytes_sent": 488139902523, "bytes_recv": 509689551409, "packets_sent": 610188825, "packets_recv": 641797026, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912450.4842103, "cpudata": {"memory": [17306492928, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 107, 'objective/kl': 43.730674743652344, 'objective/entropy': 1.7862703316495754e-07, 'objective/non_score_reward': -2.1865336894989014, 'objective/rlhf_reward': 3.9879324436187744, 'objective/scores': 6.174466133117676, 'policy/approxkl_avg': 8.413433253036395e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': -1.1133695743126282e-08, 'loss/value_avg': 4.822145462036133, 'val/clipfrac_avg': 0.2355394959449768, 'policy/entropy_avg': -8.135022653732449e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 7.692307692307694e-06, 'episode': 14720, 'epoch': 2.72}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 22/26 [02:16<00:22,  5.63s/it]\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 23/26 [02:16<00:16,  5.64s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [23, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 43.34593200683594, 'objective/entropy': 1.3429622924832074e-07, 'objective/non_score_reward': -2.167296886444092, 'objective/rlhf_reward': 4.010891914367676, 'objective/scores': 6.178188323974609, 'policy/approxkl_avg': 6.492578826997053e-13, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': -1.8837315707287416e-08, 'loss/value_avg': 4.789797306060791, 'val/clipfrac_avg': 7.3702831286937e-06, 'policy/entropy_avg': -7.847570486774202e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 5.76923076923077e-06, 'episode': 15360, 'epoch': 2.84}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 23/26 [02:21<00:16,  5.64s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 24/26 [02:21<00:11,  5.66s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [24, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7576.047477761252, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7474.068001824723, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7633.049457335302, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7547.938549241307, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7436.656918800409, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7614.149281350828, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7489.87812851694, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7578.903997624851, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [24, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912460.6552017, "gpudata": {"0": {"memory": [9917.75, 46068.0], "load": 0.95, "temperature": 49.0, "power": 209.124}, "1": {"memory": [9351.75, 46068.0], "load": 0.97, "temperature": 49.0, "power": 232.377}, "2": {"memory": [9649.75, 46068.0], "load": 0.98, "temperature": 50.0, "power": 229.572}, "3": {"memory": [9883.75, 46068.0], "load": 0.98, "temperature": 49.0, "power": 223.671}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912460.6552017, "iodata": {"read_count": 0, "write_count": 446, "read_bytes": 0, "read_time": 0, "write_time": 32, "busy_time": 292}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912460.6552017, "netdata": {"bytes_sent": 488139942714, "bytes_recv": 509689585249, "packets_sent": 610188924, "packets_recv": 641797144, "errin": 0, "errout": 0, "dropin": 0, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1733912460.6552017, "cpudata": {"memory": [17311309824, 1076052799488], "load": 10.8}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 44.19554901123047, 'objective/entropy': 2.631898041727254e-07, 'objective/non_score_reward': -2.209777355194092, 'objective/rlhf_reward': 3.9652106761932373, 'objective/scores': 6.174988269805908, 'policy/approxkl_avg': 8.846405552542791e-11, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': 8.955457531101274e-08, 'loss/value_avg': 4.762621879577637, 'val/clipfrac_avg': 0.009920400567352772, 'policy/entropy_avg': -6.926734386070166e-06, 'val/ratio': 0.9999999403953552, 'val/ratio_var': 2.3684757293981375e-14, 'val/num_eos_tokens': 0, 'lr': 3.846153846153847e-06, 'episode': 16000, 'epoch': 2.96}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 24/26 [02:27<00:11,  5.66s/it]\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 25/26 [02:27<00:05,  5.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [25, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 108, 'objective/kl': 44.142601013183594, 'objective/entropy': 1.7564690324434196e-07, 'objective/non_score_reward': -2.207129955291748, 'objective/rlhf_reward': 3.9628994464874268, 'objective/scores': 6.170029640197754, 'policy/approxkl_avg': 1.2396774145412293e-12, 'policy/clipfrac_avg': 0.0, 'loss/policy_avg': -4.9855628958539455e-08, 'loss/value_avg': 4.745996475219727, 'val/clipfrac_avg': 0.0005675117718055844, 'policy/entropy_avg': -7.959581125760451e-06, 'val/ratio': 1.0, 'val/ratio_var': 0.0, 'val/num_eos_tokens': 0, 'lr': 1.9230769230769234e-06, 'episode': 16640, 'epoch': 3.08}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 25/26 [02:33<00:05,  5.65s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 26/26 [02:33<00:00,  5.66s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 26/26 [02:33<00:00,  5.90s/it]\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 7747.407149829388, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1211 05:21:09.383392308 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "160", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1733912471.5882018, "return_code": 0}, "pipe": null}
