{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-H100-80GB-HBM3_rlhf-gpus_308.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 192, "brand": "AMD EPYC 9654 96-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-n002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "4", "device": 0, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 34.0, "power": 70.786, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "5", "device": 1, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 39.0, "power": 71.941, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "6", "device": 2, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 38.0, "power": 72.585, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "7", "device": 3, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 33.0, "power": 71.921, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1734049697.248608, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "308", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031697.327856}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/14 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031724.5507736, "gpudata": {"0": {"memory": [7172.5625, 81559.0], "load": 0.0, "temperature": 33.0, "power": 118.522}, "1": {"memory": [7208.5625, 81559.0], "load": 0.0, "temperature": 37.0, "power": 120.641}, "2": {"memory": [7208.5625, 81559.0], "load": 0.0, "temperature": 36.0, "power": 121.962}, "3": {"memory": [6968.5625, 81559.0], "load": 0.0, "temperature": 33.0, "power": 121.035}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031724.5507736, "iodata": {"read_count": 0, "write_count": 149, "read_bytes": 0, "read_time": 0, "write_time": 10, "busy_time": 112}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031724.5507736, "netdata": {"bytes_sent": 111168114785, "bytes_recv": 801223631588, "packets_sent": 256479696, "packets_recv": 673948827, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031724.5507736, "cpudata": {"memory": [65711751168, 2429110050816], "load": 0.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 98, 'objective/kl': 9.324159327661619e-05, 'objective/entropy': 93.04039001464844, 'objective/non_score_reward': -4.66207984572975e-06, 'objective/rlhf_reward': 0.2709158658981323, 'objective/scores': 0.2709205150604248, 'policy/approxkl_avg': 2.616609573364258, 'policy/clipfrac_avg': 0.39880698919296265, 'loss/policy_avg': 0.22145918011665344, 'loss/value_avg': 6.279565811157227, 'val/clipfrac_avg': 0.3703289330005646, 'policy/entropy_avg': 1.4258427619934082, 'val/ratio': 0.9737454056739807, 'val/ratio_var': 0.0005767055554315448, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 1232, 'epoch': 0.23}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/14 [00:12<?, ?it/s]\r  7%|\u258b         | 1/14 [00:12<02:44, 12.64s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031734.5668108, "gpudata": {"0": {"memory": [16506.5625, 81559.0], "load": 0.84, "temperature": 39.0, "power": 272.471}, "1": {"memory": [16904.5625, 81559.0], "load": 0.82, "temperature": 42.0, "power": 280.663}, "2": {"memory": [16920.5625, 81559.0], "load": 0.84, "temperature": 42.0, "power": 266.718}, "3": {"memory": [16632.5625, 81559.0], "load": 0.83, "temperature": 39.0, "power": 269.721}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031734.5668108, "iodata": {"read_count": 0, "write_count": 389, "read_bytes": 0, "read_time": 0, "write_time": 15, "busy_time": 236}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031734.5668108, "netdata": {"bytes_sent": 111168126619, "bytes_recv": 801223644143, "packets_sent": 256479748, "packets_recv": 673948879, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031734.5668108, "cpudata": {"memory": [67631792128, 2429110050816], "load": 5.9}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 133, 'objective/kl': 28.115062713623047, 'objective/entropy': 25.298160552978516, 'objective/non_score_reward': -1.4057531356811523, 'objective/rlhf_reward': -1.1883411407470703, 'objective/scores': 0.21741211414337158, 'policy/approxkl_avg': 1.6252145767211914, 'policy/clipfrac_avg': 0.22820693254470825, 'loss/policy_avg': 0.11300316452980042, 'loss/value_avg': 3.9605915546417236, 'val/clipfrac_avg': 0.3851613998413086, 'policy/entropy_avg': 0.5567210912704468, 'val/ratio': 0.9577139616012573, 'val/ratio_var': 0.0007842485210858285, 'val/num_eos_tokens': 0, 'lr': 4.642857142857143e-05, 'episode': 2464, 'epoch': 0.46}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  7%|\u258b         | 1/14 [00:18<02:44, 12.64s/it]\r 14%|\u2588\u258d        | 2/14 [00:18<01:45,  8.77s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031744.6984375, "gpudata": {"0": {"memory": [16508.5625, 81559.0], "load": 0.67, "temperature": 38.0, "power": 288.081}, "1": {"memory": [55490.5625, 81559.0], "load": 0.9, "temperature": 42.0, "power": 292.446}, "2": {"memory": [56414.5625, 81559.0], "load": 0.33, "temperature": 41.0, "power": 291.932}, "3": {"memory": [47306.5625, 81559.0], "load": 0.44, "temperature": 38.0, "power": 296.72}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031744.6984375, "iodata": {"read_count": 0, "write_count": 570, "read_bytes": 0, "read_time": 0, "write_time": 19, "busy_time": 372}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031744.6984375, "netdata": {"bytes_sent": 111168189647, "bytes_recv": 801223686918, "packets_sent": 256479854, "packets_recv": 673948975, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031744.6984375, "cpudata": {"memory": [67690455040, 2429110050816], "load": 6.2}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 149, 'objective/kl': 32.034053802490234, 'objective/entropy': 12.440706253051758, 'objective/non_score_reward': -1.6017026901245117, 'objective/rlhf_reward': -1.435876727104187, 'objective/scores': 0.1658259630203247, 'policy/approxkl_avg': 1.3105984926223755, 'policy/clipfrac_avg': 0.13490106165409088, 'loss/policy_avg': 0.06399550288915634, 'loss/value_avg': 3.0654993057250977, 'val/clipfrac_avg': 0.4216988682746887, 'policy/entropy_avg': 0.23871688544750214, 'val/ratio': 0.9781452417373657, 'val/ratio_var': 0.00041764212073758245, 'val/num_eos_tokens': 0, 'lr': 4.2857142857142856e-05, 'episode': 3696, 'epoch': 0.68}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 14%|\u2588\u258d        | 2/14 [00:24<01:45,  8.77s/it]\r 21%|\u2588\u2588\u258f       | 3/14 [00:24<01:23,  7.57s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 159, 'objective/kl': 32.146087646484375, 'objective/entropy': 5.431525230407715, 'objective/non_score_reward': -1.607304334640503, 'objective/rlhf_reward': -1.4263790845870972, 'objective/scores': 0.1809251308441162, 'policy/approxkl_avg': 1.3667322397232056, 'policy/clipfrac_avg': 0.09995634853839874, 'loss/policy_avg': 0.054610785096883774, 'loss/value_avg': 2.1867244243621826, 'val/clipfrac_avg': 0.45132166147232056, 'policy/entropy_avg': 0.14652429521083832, 'val/ratio': 0.9810045957565308, 'val/ratio_var': 0.0015288889408111572, 'val/num_eos_tokens': 0, 'lr': 3.928571428571429e-05, 'episode': 4928, 'epoch': 0.91}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 21%|\u2588\u2588\u258f       | 3/14 [00:30<01:23,  7.57s/it]\r 29%|\u2588\u2588\u258a       | 4/14 [00:30<01:09,  6.98s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 6453.314565989784, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13599.848241723004, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13609.823899665498, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13704.420890739244, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031754.7343552, "gpudata": {"0": {"memory": [54222.5625, 81559.0], "load": 0.47, "temperature": 43.0, "power": 429.601}, "1": {"memory": [35430.5625, 81559.0], "load": 0.15, "temperature": 44.0, "power": 450.734}, "2": {"memory": [35394.5625, 81559.0], "load": 0.26, "temperature": 43.0, "power": 446.901}, "3": {"memory": [34414.5625, 81559.0], "load": 0.25, "temperature": 39.0, "power": 443.251}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031754.7343552, "iodata": {"read_count": 0, "write_count": 676, "read_bytes": 0, "read_time": 0, "write_time": 22, "busy_time": 452}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031754.7343552, "netdata": {"bytes_sent": 111168277608, "bytes_recv": 801223700056, "packets_sent": 256479954, "packets_recv": 673949038, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031754.7343552, "cpudata": {"memory": [67843698688, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 164, 'objective/kl': 28.87841033935547, 'objective/entropy': 3.720581531524658, 'objective/non_score_reward': -1.443920612335205, 'objective/rlhf_reward': -1.2238507270812988, 'objective/scores': 0.22007012367248535, 'policy/approxkl_avg': 0.5514875650405884, 'policy/clipfrac_avg': 0.06713274866342545, 'loss/policy_avg': 0.030568357557058334, 'loss/value_avg': 1.8312783241271973, 'val/clipfrac_avg': 0.447500616312027, 'policy/entropy_avg': 0.09965308755636215, 'val/ratio': 0.9790103435516357, 'val/ratio_var': 9.548413072479889e-05, 'val/num_eos_tokens': 0, 'lr': 3.571428571428572e-05, 'episode': 6160, 'epoch': 1.14}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 29%|\u2588\u2588\u258a       | 4/14 [00:37<01:09,  6.98s/it]\r 36%|\u2588\u2588\u2588\u258c      | 5/14 [00:37<01:01,  6.86s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 169, 'objective/kl': 26.39429473876953, 'objective/entropy': 2.7903285026550293, 'objective/non_score_reward': -1.3197147846221924, 'objective/rlhf_reward': -1.1086888313293457, 'objective/scores': 0.21102583408355713, 'policy/approxkl_avg': 0.51041579246521, 'policy/clipfrac_avg': 0.05382029339671135, 'loss/policy_avg': 0.027264196425676346, 'loss/value_avg': 1.617682695388794, 'val/clipfrac_avg': 0.4096345901489258, 'policy/entropy_avg': 0.06972440332174301, 'val/ratio': 0.9934777617454529, 'val/ratio_var': 0.0009049311047419906, 'val/num_eos_tokens': 0, 'lr': 3.2142857142857144e-05, 'episode': 7392, 'epoch': 1.37}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 36%|\u2588\u2588\u2588\u258c      | 5/14 [00:43<01:01,  6.86s/it]\r 43%|\u2588\u2588\u2588\u2588\u258e     | 6/14 [00:43<00:52,  6.58s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031764.7601368, "gpudata": {"0": {"memory": [16508.5625, 81559.0], "load": 0.92, "temperature": 42.0, "power": 283.78}, "1": {"memory": [14520.5625, 81559.0], "load": 0.52, "temperature": 46.0, "power": 290.068}, "2": {"memory": [14492.5625, 81559.0], "load": 0.9, "temperature": 46.0, "power": 284.765}, "3": {"memory": [14242.5625, 81559.0], "load": 1.0, "temperature": 41.0, "power": 283.839}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031764.7601368, "iodata": {"read_count": 0, "write_count": 800, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 564}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031764.7601368, "netdata": {"bytes_sent": 111168289746, "bytes_recv": 801223712141, "packets_sent": 256480005, "packets_recv": 673949086, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031764.7601368, "cpudata": {"memory": [67930345472, 2429110050816], "load": 6.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 174, 'objective/kl': 29.22327423095703, 'objective/entropy': 2.5128562450408936, 'objective/non_score_reward': -1.4611637592315674, 'objective/rlhf_reward': -1.2494968175888062, 'objective/scores': 0.21166682243347168, 'policy/approxkl_avg': 0.3702521026134491, 'policy/clipfrac_avg': 0.04763691499829292, 'loss/policy_avg': 0.021781275048851967, 'loss/value_avg': 1.513747215270996, 'val/clipfrac_avg': 0.32621830701828003, 'policy/entropy_avg': 0.06146356835961342, 'val/ratio': 0.9877448081970215, 'val/ratio_var': 4.592593904817477e-05, 'val/num_eos_tokens': 0, 'lr': 2.857142857142857e-05, 'episode': 8624, 'epoch': 1.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 43%|\u2588\u2588\u2588\u2588\u258e     | 6/14 [00:49<00:52,  6.58s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 7/14 [00:49<00:44,  6.35s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031774.7788045, "gpudata": {"0": {"memory": [24700.5625, 81559.0], "load": 0.72, "temperature": 41.0, "power": 288.263}, "1": {"memory": [22204.5625, 81559.0], "load": 0.83, "temperature": 46.0, "power": 289.906}, "2": {"memory": [22346.5625, 81559.0], "load": 0.7, "temperature": 45.0, "power": 283.745}, "3": {"memory": [21582.5625, 81559.0], "load": 0.66, "temperature": 40.0, "power": 284.202}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031774.7788045, "iodata": {"read_count": 0, "write_count": 860, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 596}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031774.7788045, "netdata": {"bytes_sent": 111168350385, "bytes_recv": 801223744438, "packets_sent": 256480082, "packets_recv": 673949150, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031774.7788045, "cpudata": {"memory": [68032712704, 2429110050816], "load": 6.2}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 177, 'objective/kl': 28.633453369140625, 'objective/entropy': 1.837653398513794, 'objective/non_score_reward': -1.4316726922988892, 'objective/rlhf_reward': -1.205296277999878, 'objective/scores': 0.22637641429901123, 'policy/approxkl_avg': 0.3331889510154724, 'policy/clipfrac_avg': 0.0333825945854187, 'loss/policy_avg': 0.017519716173410416, 'loss/value_avg': 1.3952685594558716, 'val/clipfrac_avg': 0.2947845160961151, 'policy/entropy_avg': 0.04321327060461044, 'val/ratio': 0.990675151348114, 'val/ratio_var': 3.278091753600165e-05, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 9856, 'epoch': 1.82}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 7/14 [00:55<00:44,  6.35s/it]\r 57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 8/14 [00:55<00:37,  6.28s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12574.093621288235, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13797.225319566543, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13961.506475936572, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13361.416840086285, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 179, 'objective/kl': 24.24664306640625, 'objective/entropy': 1.1182684898376465, 'objective/non_score_reward': -1.2123322486877441, 'objective/rlhf_reward': -1.0489816665649414, 'objective/scores': 0.16335058212280273, 'policy/approxkl_avg': 0.1807260811328888, 'policy/clipfrac_avg': 0.018841123208403587, 'loss/policy_avg': 0.007912223227322102, 'loss/value_avg': 1.2535994052886963, 'val/clipfrac_avg': 0.23522880673408508, 'policy/entropy_avg': 0.024948321282863617, 'val/ratio': 0.9943097829818726, 'val/ratio_var': 2.837038118741475e-05, 'val/num_eos_tokens': 0, 'lr': 2.1428571428571428e-05, 'episode': 11088, 'epoch': 2.05}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 8/14 [01:01<00:37,  6.28s/it]\r 64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 9/14 [01:01<00:31,  6.24s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031784.7970285, "gpudata": {"0": {"memory": [16506.5625, 81559.0], "load": 0.98, "temperature": 50.0, "power": 386.515}, "1": {"memory": [14636.5625, 81559.0], "load": 0.71, "temperature": 48.0, "power": 346.402}, "2": {"memory": [13290.5625, 81559.0], "load": 0.77, "temperature": 50.0, "power": 334.102}, "3": {"memory": [13256.5625, 81559.0], "load": 0.78, "temperature": 46.0, "power": 341.273}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031784.7970285, "iodata": {"read_count": 0, "write_count": 896, "read_bytes": 0, "read_time": 0, "write_time": 32, "busy_time": 652}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031784.7970285, "netdata": {"bytes_sent": 111168437925, "bytes_recv": 801223757576, "packets_sent": 256480182, "packets_recv": 673949213, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031784.7970285, "cpudata": {"memory": [68042264576, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 181, 'objective/kl': 23.937332153320312, 'objective/entropy': 0.8451054692268372, 'objective/non_score_reward': -1.196866512298584, 'objective/rlhf_reward': -1.010021448135376, 'objective/scores': 0.186845064163208, 'policy/approxkl_avg': 0.1494055539369583, 'policy/clipfrac_avg': 0.014606560580432415, 'loss/policy_avg': 0.013699624687433243, 'loss/value_avg': 1.182974100112915, 'val/clipfrac_avg': 0.20957639813423157, 'policy/entropy_avg': 0.020919322967529297, 'val/ratio': 0.9997161626815796, 'val/ratio_var': 3.9534665120299906e-05, 'val/num_eos_tokens': 0, 'lr': 1.785714285714286e-05, 'episode': 12320, 'epoch': 2.28}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 9/14 [01:08<00:31,  6.24s/it]\r 71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 10/14 [01:08<00:25,  6.26s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031794.9967349, "gpudata": {"0": {"memory": [16508.5625, 81559.0], "load": 0.63, "temperature": 39.0, "power": 289.96}, "1": {"memory": [49250.5625, 81559.0], "load": 0.35, "temperature": 44.0, "power": 305.052}, "2": {"memory": [49542.5625, 81559.0], "load": 0.51, "temperature": 44.0, "power": 306.919}, "3": {"memory": [55786.5625, 81559.0], "load": 0.5, "temperature": 39.0, "power": 290.43}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031794.9967349, "iodata": {"read_count": 0, "write_count": 1010, "read_bytes": 0, "read_time": 0, "write_time": 37, "busy_time": 728}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031794.9967349, "netdata": {"bytes_sent": 111168450783, "bytes_recv": 801223771669, "packets_sent": 256480236, "packets_recv": 673949273, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031794.9967349, "cpudata": {"memory": [68097626112, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 182, 'objective/kl': 24.99152374267578, 'objective/entropy': 1.1212399005889893, 'objective/non_score_reward': -1.249576210975647, 'objective/rlhf_reward': -1.0542733669281006, 'objective/scores': 0.19530272483825684, 'policy/approxkl_avg': 0.14509370923042297, 'policy/clipfrac_avg': 0.019335027784109116, 'loss/policy_avg': 0.01156698353588581, 'loss/value_avg': 1.1842033863067627, 'val/clipfrac_avg': 0.10135000944137573, 'policy/entropy_avg': 0.02794663980603218, 'val/ratio': 0.9990532398223877, 'val/ratio_var': 0.0003436080296523869, 'val/num_eos_tokens': 0, 'lr': 1.4285714285714285e-05, 'episode': 13552, 'epoch': 2.51}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 10/14 [01:14<00:25,  6.26s/it]\r 79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 11/14 [01:14<00:18,  6.21s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 183, 'objective/kl': 23.70160484313965, 'objective/entropy': 0.9194822311401367, 'objective/non_score_reward': -1.1850802898406982, 'objective/rlhf_reward': -0.9937490224838257, 'objective/scores': 0.1913313865661621, 'policy/approxkl_avg': 0.12827973067760468, 'policy/clipfrac_avg': 0.01455678790807724, 'loss/policy_avg': 0.010030703619122505, 'loss/value_avg': 1.117091178894043, 'val/clipfrac_avg': 0.09790033102035522, 'policy/entropy_avg': 0.02311810664832592, 'val/ratio': 0.9959022998809814, 'val/ratio_var': 2.9620929126394913e-05, 'val/num_eos_tokens': 0, 'lr': 1.0714285714285714e-05, 'episode': 14784, 'epoch': 2.74}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 11/14 [01:20<00:18,  6.21s/it]\r 86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 12/14 [01:20<00:12,  6.30s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13528.360533688136, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13194.691402911667, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13504.793090060059, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12736.480546494813, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031805.017256, "gpudata": {"0": {"memory": [16508.5625, 81559.0], "load": 0.71, "temperature": 40.0, "power": 286.731}, "1": {"memory": [41102.5625, 81559.0], "load": 0.39, "temperature": 45.0, "power": 333.277}, "2": {"memory": [13204.5625, 81559.0], "load": 0.6, "temperature": 45.0, "power": 329.033}, "3": {"memory": [12898.5625, 81559.0], "load": 0.66, "temperature": 40.0, "power": 365.311}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031805.017256, "iodata": {"read_count": 0, "write_count": 1234, "read_bytes": 0, "read_time": 0, "write_time": 41, "busy_time": 888}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031805.017256, "netdata": {"bytes_sent": 111168512837, "bytes_recv": 801223805510, "packets_sent": 256480324, "packets_recv": 673949360, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031805.017256, "cpudata": {"memory": [68031758336, 2429110050816], "load": 5.2}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 185, 'objective/kl': 25.480052947998047, 'objective/entropy': 1.1108133792877197, 'objective/non_score_reward': -1.2740025520324707, 'objective/rlhf_reward': -1.0663270950317383, 'objective/scores': 0.20767557621002197, 'policy/approxkl_avg': 0.23360572755336761, 'policy/clipfrac_avg': 0.015785805881023407, 'loss/policy_avg': 0.010843012481927872, 'loss/value_avg': 1.1567784547805786, 'val/clipfrac_avg': 0.009525852277874947, 'policy/entropy_avg': 0.023722276091575623, 'val/ratio': 0.9975993633270264, 'val/ratio_var': 2.383485116297379e-05, 'val/num_eos_tokens': 0, 'lr': 7.142857142857143e-06, 'episode': 16016, 'epoch': 2.96}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 12/14 [01:26<00:12,  6.30s/it]\r 93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 13/14 [01:26<00:06,  6.19s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [13, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 186, 'objective/kl': 23.449295043945312, 'objective/entropy': 1.0925837755203247, 'objective/non_score_reward': -1.1724648475646973, 'objective/rlhf_reward': -0.9161695241928101, 'objective/scores': 0.25629520416259766, 'policy/approxkl_avg': 0.16419416666030884, 'policy/clipfrac_avg': 0.013496233150362968, 'loss/policy_avg': 0.014967679046094418, 'loss/value_avg': 1.0933520793914795, 'val/clipfrac_avg': 0.008989831432700157, 'policy/entropy_avg': 0.022745899856090546, 'val/ratio': 0.9980531930923462, 'val/ratio_var': 0.00012014348612865433, 'val/num_eos_tokens': 0, 'lr': 3.5714285714285714e-06, 'episode': 17248, 'epoch': 3.19}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 13/14 [01:32<00:06,  6.19s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 14/14 [01:32<00:00,  6.12s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 14/14 [01:32<00:00,  6.62s/it]\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 14079.495537315603, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1212 14:30:14.215768459 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "308", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031816.356849, "return_code": 0}, "pipe": null}
