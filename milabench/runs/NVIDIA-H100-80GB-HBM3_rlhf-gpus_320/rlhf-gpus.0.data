{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-H100-80GB-HBM3_rlhf-gpus_320.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 192, "brand": "AMD EPYC 9654 96-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-n002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "4", "device": 0, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 70.347, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "5", "device": 1, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 35.0, "power": 70.903, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "6", "device": 2, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 34.0, "power": 71.645, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "7", "device": 3, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 70.842, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1734049036.974629, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "320", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031037.0416083}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/13 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031063.8093774, "gpudata": {"0": {"memory": [7172.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.083}, "1": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 35.0, "power": 119.165}, "2": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 34.0, "power": 120.181}, "3": {"memory": [6980.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.325}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031063.8093774, "iodata": {"read_count": 0, "write_count": 46, "read_bytes": 0, "read_time": 0, "write_time": 11, "busy_time": 48}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031063.8093774, "netdata": {"bytes_sent": 111157906406, "bytes_recv": 801215219409, "packets_sent": 256404901, "packets_recv": 673875284, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031063.8093774, "cpudata": {"memory": [50857299968, 2429110050816], "load": 0.0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031073.9959843, "gpudata": {"0": {"memory": [13326.5625, 81559.0], "load": 0.25, "temperature": 35.0, "power": 270.824}, "1": {"memory": [13682.5625, 81559.0], "load": 0.98, "temperature": 37.0, "power": 275.278}, "2": {"memory": [46306.5625, 81559.0], "load": 0.17, "temperature": 37.0, "power": 273.415}, "3": {"memory": [13134.5625, 81559.0], "load": 0.58, "temperature": 34.0, "power": 275.039}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031073.9959843, "iodata": {"read_count": 0, "write_count": 261, "read_bytes": 0, "read_time": 0, "write_time": 18, "busy_time": 232}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031073.9959843, "netdata": {"bytes_sent": 111157975563, "bytes_recv": 801215288743, "packets_sent": 256404956, "packets_recv": 673875339, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031073.9959843, "cpudata": {"memory": [52680482816, 2429110050816], "load": 4.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 96, 'objective/kl': 3.5995202779304236e-05, 'objective/entropy': 92.59837341308594, 'objective/non_score_reward': -1.7997600707531092e-06, 'objective/rlhf_reward': -6.903852462768555, 'objective/scores': -6.903850555419922, 'policy/approxkl_avg': 2.3475775718688965, 'policy/clipfrac_avg': 0.3468897342681885, 'loss/policy_avg': 0.23366215825080872, 'loss/value_avg': 15.274538040161133, 'val/clipfrac_avg': 0.47451353073120117, 'policy/entropy_avg': 1.5332690477371216, 'val/ratio': 0.9936044216156006, 'val/ratio_var': 0.0046619148924946785, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 1280, 'epoch': 0.24}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/13 [00:13<?, ?it/s]\r  8%|\u258a         | 1/13 [00:13<02:39, 13.33s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 130, 'objective/kl': 31.309680938720703, 'objective/entropy': 34.58452224731445, 'objective/non_score_reward': -1.5654842853546143, 'objective/rlhf_reward': -8.596580505371094, 'objective/scores': -7.031096458435059, 'policy/approxkl_avg': 1.3584845066070557, 'policy/clipfrac_avg': 0.16530439257621765, 'loss/policy_avg': 0.13684704899787903, 'loss/value_avg': 11.009410858154297, 'val/clipfrac_avg': 0.7320570945739746, 'policy/entropy_avg': 0.6877173185348511, 'val/ratio': 0.9821583032608032, 'val/ratio_var': 0.0007379651651717722, 'val/num_eos_tokens': 1, 'lr': 4.615384615384616e-05, 'episode': 2560, 'epoch': 0.47}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 1/13 [00:19<02:39, 13.33s/it]\r 15%|\u2588\u258c        | 2/13 [00:19<01:41,  9.20s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031084.0147696, "gpudata": {"0": {"memory": [15132.5625, 81559.0], "load": 0.56, "temperature": 37.0, "power": 287.237}, "1": {"memory": [15534.5625, 81559.0], "load": 0.37, "temperature": 40.0, "power": 287.504}, "2": {"memory": [15762.5625, 81559.0], "load": 0.49, "temperature": 40.0, "power": 281.397}, "3": {"memory": [15454.5625, 81559.0], "load": 0.43, "temperature": 36.0, "power": 276.845}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031084.0147696, "iodata": {"read_count": 0, "write_count": 443, "read_bytes": 0, "read_time": 0, "write_time": 23, "busy_time": 380}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031084.0147696, "netdata": {"bytes_sent": 111158074950, "bytes_recv": 801215315781, "packets_sent": 256405105, "packets_recv": 673875457, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031084.0147696, "cpudata": {"memory": [52700815360, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 148, 'objective/kl': 28.79907989501953, 'objective/entropy': 7.598484992980957, 'objective/non_score_reward': -1.4399540424346924, 'objective/rlhf_reward': -8.590753555297852, 'objective/scores': -7.150798797607422, 'policy/approxkl_avg': 0.8632972836494446, 'policy/clipfrac_avg': 0.07307267189025879, 'loss/policy_avg': 0.12761084735393524, 'loss/value_avg': 5.878081798553467, 'val/clipfrac_avg': 0.5912145972251892, 'policy/entropy_avg': 0.18156644701957703, 'val/ratio': 1.0446970462799072, 'val/ratio_var': 0.014945310540497303, 'val/num_eos_tokens': 1, 'lr': 4.230769230769231e-05, 'episode': 3840, 'epoch': 0.71}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 15%|\u2588\u258c        | 2/13 [00:25<01:41,  9.20s/it]\r 23%|\u2588\u2588\u258e       | 3/13 [00:25<01:18,  7.86s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 159, 'objective/kl': 35.38932800292969, 'objective/entropy': 6.547237873077393, 'objective/non_score_reward': -1.7694666385650635, 'objective/rlhf_reward': -8.810620307922363, 'objective/scores': -7.041153907775879, 'policy/approxkl_avg': 0.9120023250579834, 'policy/clipfrac_avg': 0.08763635158538818, 'loss/policy_avg': 0.040331512689590454, 'loss/value_avg': 3.127265453338623, 'val/clipfrac_avg': 0.5919221639633179, 'policy/entropy_avg': 0.1890059858560562, 'val/ratio': 0.9796603918075562, 'val/ratio_var': 0.0021138566080480814, 'val/num_eos_tokens': 0, 'lr': 3.846153846153846e-05, 'episode': 5120, 'epoch': 0.95}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 23%|\u2588\u2588\u258e       | 3/13 [00:32<01:18,  7.86s/it]\r 31%|\u2588\u2588\u2588       | 4/13 [00:32<01:04,  7.18s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 6359.2347359919695, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13605.627965687785, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13856.007264936929, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14224.962088797723, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031094.0473936, "gpudata": {"0": {"memory": [17366.5625, 81559.0], "load": 0.82, "temperature": 41.0, "power": 293.515}, "1": {"memory": [17604.5625, 81559.0], "load": 0.82, "temperature": 45.0, "power": 294.815}, "2": {"memory": [17600.5625, 81559.0], "load": 0.81, "temperature": 45.0, "power": 292.7}, "3": {"memory": [17048.5625, 81559.0], "load": 0.81, "temperature": 40.0, "power": 298.602}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031094.0473936, "iodata": {"read_count": 0, "write_count": 514, "read_bytes": 0, "read_time": 0, "write_time": 25, "busy_time": 428}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031094.0473936, "netdata": {"bytes_sent": 111158288118, "bytes_recv": 801215360184, "packets_sent": 256405329, "packets_recv": 673875607, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031094.0473936, "cpudata": {"memory": [52732694528, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 163, 'objective/kl': 36.61528778076172, 'objective/entropy': 5.8091535568237305, 'objective/non_score_reward': -1.8307645320892334, 'objective/rlhf_reward': -8.86053466796875, 'objective/scores': -7.0297698974609375, 'policy/approxkl_avg': 0.4731265902519226, 'policy/clipfrac_avg': 0.07311321049928665, 'loss/policy_avg': 0.03735308349132538, 'loss/value_avg': 1.8405781984329224, 'val/clipfrac_avg': 0.511847734451294, 'policy/entropy_avg': 0.16271193325519562, 'val/ratio': 0.9830539226531982, 'val/ratio_var': 0.000352817791281268, 'val/num_eos_tokens': 0, 'lr': 3.461538461538462e-05, 'episode': 6400, 'epoch': 1.18}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 31%|\u2588\u2588\u2588       | 4/13 [00:39<01:04,  7.18s/it]\r 38%|\u2588\u2588\u2588\u258a      | 5/13 [00:39<00:57,  7.14s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031104.404349, "gpudata": {"0": {"memory": [13330.5625, 81559.0], "load": 0.17, "temperature": 38.0, "power": 277.967}, "1": {"memory": [13684.5625, 81559.0], "load": 0.69, "temperature": 42.0, "power": 280.912}, "2": {"memory": [13422.5625, 81559.0], "load": 0.18, "temperature": 42.0, "power": 277.33}, "3": {"memory": [13248.5625, 81559.0], "load": 0.49, "temperature": 38.0, "power": 272.801}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031104.404349, "iodata": {"read_count": 0, "write_count": 608, "read_bytes": 0, "read_time": 0, "write_time": 26, "busy_time": 548}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031104.404349, "netdata": {"bytes_sent": 111158299575, "bytes_recv": 801215372036, "packets_sent": 256405375, "packets_recv": 673875654, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031104.404349, "cpudata": {"memory": [52748091392, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 169, 'objective/kl': 35.00220489501953, 'objective/entropy': 4.623043060302734, 'objective/non_score_reward': -1.750110149383545, 'objective/rlhf_reward': -8.808427810668945, 'objective/scores': -7.0583176612854, 'policy/approxkl_avg': 0.31001919507980347, 'policy/clipfrac_avg': 0.05463222414255142, 'loss/policy_avg': 0.0364578515291214, 'loss/value_avg': 1.412351131439209, 'val/clipfrac_avg': 0.4096366763114929, 'policy/entropy_avg': 0.1213115006685257, 'val/ratio': 1.004645824432373, 'val/ratio_var': 0.001355998683720827, 'val/num_eos_tokens': 0, 'lr': 3.0769230769230774e-05, 'episode': 7680, 'epoch': 1.42}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 38%|\u2588\u2588\u2588\u258a      | 5/13 [00:45<00:57,  7.14s/it]\r 46%|\u2588\u2588\u2588\u2588\u258c     | 6/13 [00:45<00:47,  6.83s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 173, 'objective/kl': 31.661436080932617, 'objective/entropy': 3.1992931365966797, 'objective/non_score_reward': -1.5830717086791992, 'objective/rlhf_reward': -8.626144409179688, 'objective/scores': -7.043072700500488, 'policy/approxkl_avg': 0.24019944667816162, 'policy/clipfrac_avg': 0.0430719330906868, 'loss/policy_avg': 0.026808813214302063, 'loss/value_avg': 1.173134684562683, 'val/clipfrac_avg': 0.3211822211742401, 'policy/entropy_avg': 0.08533630520105362, 'val/ratio': 0.9951523542404175, 'val/ratio_var': 0.00023943612177390605, 'val/num_eos_tokens': 0, 'lr': 2.6923076923076923e-05, 'episode': 8960, 'epoch': 1.66}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 46%|\u2588\u2588\u2588\u2588\u258c     | 6/13 [00:51<00:47,  6.83s/it]\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 7/13 [00:51<00:39,  6.65s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031114.4510424, "gpudata": {"0": {"memory": [13508.5625, 81559.0], "load": 0.65, "temperature": 48.0, "power": 346.908}, "1": {"memory": [14336.5625, 81559.0], "load": 0.82, "temperature": 53.0, "power": 365.404}, "2": {"memory": [13666.5625, 81559.0], "load": 0.67, "temperature": 52.0, "power": 349.307}, "3": {"memory": [14064.5625, 81559.0], "load": 0.83, "temperature": 48.0, "power": 356.412}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031114.4510424, "iodata": {"read_count": 0, "write_count": 673, "read_bytes": 0, "read_time": 0, "write_time": 27, "busy_time": 612}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031114.4510424, "netdata": {"bytes_sent": 111158390110, "bytes_recv": 801215419536, "packets_sent": 256405517, "packets_recv": 673875775, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031114.4510424, "cpudata": {"memory": [52783509504, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 177, 'objective/kl': 29.620113372802734, 'objective/entropy': 2.152477741241455, 'objective/non_score_reward': -1.4810056686401367, 'objective/rlhf_reward': -8.56851577758789, 'objective/scores': -7.087510585784912, 'policy/approxkl_avg': 0.16463176906108856, 'policy/clipfrac_avg': 0.031213147565722466, 'loss/policy_avg': 0.019572000950574875, 'loss/value_avg': 1.0321356058120728, 'val/clipfrac_avg': 0.280582994222641, 'policy/entropy_avg': 0.0544327050447464, 'val/ratio': 0.999755859375, 'val/ratio_var': 0.0005915662623010576, 'val/num_eos_tokens': 0, 'lr': 2.307692307692308e-05, 'episode': 10240, 'epoch': 1.89}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 7/13 [00:57<00:39,  6.65s/it]\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 8/13 [00:57<00:32,  6.50s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12262.10732738036, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13852.016786138776, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13640.929198745149, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13851.083049922789, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 178, 'objective/kl': 28.527618408203125, 'objective/entropy': 1.3273792266845703, 'objective/non_score_reward': -1.4263808727264404, 'objective/rlhf_reward': -8.49921703338623, 'objective/scores': -7.072836875915527, 'policy/approxkl_avg': 0.11482232809066772, 'policy/clipfrac_avg': 0.021734964102506638, 'loss/policy_avg': 0.01258322037756443, 'loss/value_avg': 0.9202747344970703, 'val/clipfrac_avg': 0.21547023952007294, 'policy/entropy_avg': 0.03537595272064209, 'val/ratio': 0.9955162405967712, 'val/ratio_var': 4.017828541691415e-05, 'val/num_eos_tokens': 0, 'lr': 1.923076923076923e-05, 'episode': 11520, 'epoch': 2.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 8/13 [01:04<00:32,  6.50s/it]\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 9/13 [01:04<00:26,  6.53s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031125.1223304, "gpudata": {"0": {"memory": [13326.5625, 81559.0], "load": 0.22, "temperature": 37.0, "power": 210.249}, "1": {"memory": [13682.5625, 81559.0], "load": 0.99, "temperature": 42.0, "power": 224.954}, "2": {"memory": [13306.5625, 81559.0], "load": 0.69, "temperature": 41.0, "power": 212.285}, "3": {"memory": [13186.5625, 81559.0], "load": 0.85, "temperature": 37.0, "power": 191.264}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031125.1223304, "iodata": {"read_count": 0, "write_count": 754, "read_bytes": 0, "read_time": 0, "write_time": 29, "busy_time": 716}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031125.1223304, "netdata": {"bytes_sent": 111158667873, "bytes_recv": 801215500732, "packets_sent": 256405747, "packets_recv": 673875914, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031125.1223304, "cpudata": {"memory": [52800868352, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 180, 'objective/kl': 28.186111450195312, 'objective/entropy': 0.9466511607170105, 'objective/non_score_reward': -1.4093055725097656, 'objective/rlhf_reward': -8.481107711791992, 'objective/scores': -7.071801662445068, 'policy/approxkl_avg': 0.08165524899959564, 'policy/clipfrac_avg': 0.015665536746382713, 'loss/policy_avg': 0.01117679663002491, 'loss/value_avg': 0.8608612418174744, 'val/clipfrac_avg': 0.1823592334985733, 'policy/entropy_avg': 0.025161152705550194, 'val/ratio': 1.002589225769043, 'val/ratio_var': 0.0001426175149390474, 'val/num_eos_tokens': 0, 'lr': 1.5384615384615387e-05, 'episode': 12800, 'epoch': 2.37}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 9/13 [01:10<00:26,  6.53s/it]\r 77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 10/13 [01:10<00:19,  6.48s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031135.3283381, "gpudata": {"0": {"memory": [33478.5625, 81559.0], "load": 0.92, "temperature": 40.0, "power": 301.955}, "1": {"memory": [29580.5625, 81559.0], "load": 0.69, "temperature": 44.0, "power": 298.216}, "2": {"memory": [29296.5625, 81559.0], "load": 0.82, "temperature": 44.0, "power": 299.347}, "3": {"memory": [30172.5625, 81559.0], "load": 0.83, "temperature": 39.0, "power": 298.429}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031135.3283381, "iodata": {"read_count": 0, "write_count": 845, "read_bytes": 0, "read_time": 0, "write_time": 31, "busy_time": 812}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031135.3283381, "netdata": {"bytes_sent": 111158680082, "bytes_recv": 801215513376, "packets_sent": 256405801, "packets_recv": 673875969, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031135.3283381, "cpudata": {"memory": [52815724544, 2429110050816], "load": 5.3}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 182, 'objective/kl': 28.197546005249023, 'objective/entropy': 0.8650976419448853, 'objective/non_score_reward': -1.4098773002624512, 'objective/rlhf_reward': -8.489309310913086, 'objective/scores': -7.079431533813477, 'policy/approxkl_avg': 0.06438453495502472, 'policy/clipfrac_avg': 0.014725824818015099, 'loss/policy_avg': 0.012447185814380646, 'loss/value_avg': 0.849285364151001, 'val/clipfrac_avg': 0.10028744488954544, 'policy/entropy_avg': 0.024038398638367653, 'val/ratio': 1.0015130043029785, 'val/ratio_var': 0.00011756660387618467, 'val/num_eos_tokens': 0, 'lr': 1.153846153846154e-05, 'episode': 14080, 'epoch': 2.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 10/13 [01:17<00:19,  6.48s/it]\r 85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 11/13 [01:17<00:12,  6.43s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 183, 'objective/kl': 27.88335418701172, 'objective/entropy': 0.7542543411254883, 'objective/non_score_reward': -1.3941676616668701, 'objective/rlhf_reward': -8.476080894470215, 'objective/scores': -7.081912994384766, 'policy/approxkl_avg': 0.06679040938615799, 'policy/clipfrac_avg': 0.014880601316690445, 'loss/policy_avg': 0.012796659022569656, 'loss/value_avg': 0.8430906534194946, 'val/clipfrac_avg': 0.055896226316690445, 'policy/entropy_avg': 0.021433301270008087, 'val/ratio': 1.000427484512329, 'val/ratio_var': 9.300481906393543e-05, 'val/num_eos_tokens': 0, 'lr': 7.692307692307694e-06, 'episode': 15360, 'epoch': 2.84}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 11/13 [01:23<00:12,  6.43s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 12/13 [01:23<00:06,  6.43s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13038.846392543357, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13590.59637202525, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13447.243375337866, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13470.80393994705, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [12, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031145.3765142, "gpudata": {"0": {"memory": [16606.5625, 81559.0], "load": 0.83, "temperature": 41.0, "power": 297.677}, "1": {"memory": [16816.5625, 81559.0], "load": 0.81, "temperature": 46.0, "power": 306.397}, "2": {"memory": [16798.5625, 81559.0], "load": 0.81, "temperature": 46.0, "power": 295.63}, "3": {"memory": [16520.5625, 81559.0], "load": 0.81, "temperature": 41.0, "power": 286.103}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031145.3765142, "iodata": {"read_count": 0, "write_count": 1007, "read_bytes": 0, "read_time": 0, "write_time": 41, "busy_time": 964}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031145.3765142, "netdata": {"bytes_sent": 111158772257, "bytes_recv": 801215564875, "packets_sent": 256405963, "packets_recv": 673876109, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031145.3765142, "cpudata": {"memory": [52832612352, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 185, 'objective/kl': 26.80950164794922, 'objective/entropy': 0.6314873099327087, 'objective/non_score_reward': -1.340475082397461, 'objective/rlhf_reward': -8.403355598449707, 'objective/scores': -7.062880516052246, 'policy/approxkl_avg': 0.045585997402668, 'policy/clipfrac_avg': 0.010469486936926842, 'loss/policy_avg': 0.005268514156341553, 'loss/value_avg': 0.8277572393417358, 'val/clipfrac_avg': 0.019129568710923195, 'policy/entropy_avg': 0.016813475638628006, 'val/ratio': 0.9982500076293945, 'val/ratio_var': 1.7685235434328206e-05, 'val/num_eos_tokens': 0, 'lr': 3.846153846153847e-06, 'episode': 16640, 'epoch': 3.08}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 12/13 [01:29<00:06,  6.43s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 13/13 [01:29<00:00,  6.39s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 13/13 [01:29<00:00,  6.92s/it]\n", "pipe": "stderr"}
{"event": "line", "data": "[rank0]:[W1212 14:19:11.235590306 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "320", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031153.2371595, "return_code": 0}, "pipe": null}
