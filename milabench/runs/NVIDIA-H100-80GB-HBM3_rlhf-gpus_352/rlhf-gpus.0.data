{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-H100-80GB-HBM3_rlhf-gpus_352.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 192, "brand": "AMD EPYC 9654 96-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-n002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "4", "device": 0, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 33.0, "power": 70.655, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "5", "device": 1, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 39.0, "power": 71.947, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "6", "device": 2, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 38.0, "power": 72.459, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "7", "device": 3, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 33.0, "power": 71.92, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1734049166.703274, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "352", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031166.778345}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/12 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1734031193.8472438, "gpudata": {"0": {"memory": [7172.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.783}, "1": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 36.0, "power": 119.837}, "2": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 35.0, "power": 121.458}, "3": {"memory": [6980.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.754}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031193.8472438, "iodata": {"read_count": 0, "write_count": 113, "read_bytes": 0, "read_time": 0, "write_time": 2, "busy_time": 96}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031193.8472438, "netdata": {"bytes_sent": 111159982504, "bytes_recv": 801216635366, "packets_sent": 256416354, "packets_recv": 673886364, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031193.8472438, "cpudata": {"memory": [50960445440, 2429110050816], "load": 0.0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031203.863364, "gpudata": {"0": {"memory": [80038.5625, 81559.0], "load": 0.72, "temperature": 43.0, "power": 289.993}, "1": {"memory": [80778.5625, 81559.0], "load": 0.41, "temperature": 47.0, "power": 308.826}, "2": {"memory": [79746.5625, 81559.0], "load": 0.41, "temperature": 46.0, "power": 334.689}, "3": {"memory": [79846.5625, 81559.0], "load": 0.34, "temperature": 43.0, "power": 311.426}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031203.863364, "iodata": {"read_count": 0, "write_count": 449, "read_bytes": 0, "read_time": 0, "write_time": 9, "busy_time": 300}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031203.863364, "netdata": {"bytes_sent": 111160080664, "bytes_recv": 801216656652, "packets_sent": 256416489, "packets_recv": 673886465, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031203.863364, "cpudata": {"memory": [52880281600, 2429110050816], "load": 4.7}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 109, 'objective/kl': -8.041122782742605e-05, 'objective/entropy': 92.95814514160156, 'objective/non_score_reward': 4.020561846118653e-06, 'objective/rlhf_reward': -2.159274101257324, 'objective/scores': -2.159278154373169, 'policy/approxkl_avg': 2.312026023864746, 'policy/clipfrac_avg': 0.40358665585517883, 'loss/policy_avg': 0.22330841422080994, 'loss/value_avg': 5.37138557434082, 'val/clipfrac_avg': 0.3466411530971527, 'policy/entropy_avg': 1.5271522998809814, 'val/ratio': 0.960852861404419, 'val/ratio_var': 0.001153941615484655, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 1408, 'epoch': 0.26}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/12 [00:12<?, ?it/s]\r  8%|\u258a         | 1/12 [00:12<02:21, 12.88s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 145, 'objective/kl': 36.976192474365234, 'objective/entropy': 60.78105163574219, 'objective/non_score_reward': -1.8488095998764038, 'objective/rlhf_reward': -4.006636619567871, 'objective/scores': -2.1578269004821777, 'policy/approxkl_avg': 2.3377625942230225, 'policy/clipfrac_avg': 0.336976021528244, 'loss/policy_avg': 0.20181111991405487, 'loss/value_avg': 3.203242301940918, 'val/clipfrac_avg': 0.3141516149044037, 'policy/entropy_avg': 1.1616029739379883, 'val/ratio': 0.9786652326583862, 'val/ratio_var': 0.0013109365245327353, 'val/num_eos_tokens': 1, 'lr': 4.5833333333333334e-05, 'episode': 2816, 'epoch': 0.52}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 1/12 [00:19<02:21, 12.88s/it]\r 17%|\u2588\u258b        | 2/12 [00:19<01:30,  9.09s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031213.9399335, "gpudata": {"0": {"memory": [13744.5625, 81559.0], "load": 0.88, "temperature": 40.0, "power": 459.658}, "1": {"memory": [13774.5625, 81559.0], "load": 0.97, "temperature": 44.0, "power": 453.448}, "2": {"memory": [17770.5625, 81559.0], "load": 0.75, "temperature": 40.0, "power": 411.278}, "3": {"memory": [13552.5625, 81559.0], "load": 0.5, "temperature": 37.0, "power": 447.161}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031213.9399335, "iodata": {"read_count": 0, "write_count": 576, "read_bytes": 0, "read_time": 0, "write_time": 12, "busy_time": 396}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031213.9399335, "netdata": {"bytes_sent": 111160237049, "bytes_recv": 801216700710, "packets_sent": 256416676, "packets_recv": 673886601, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031213.9399335, "cpudata": {"memory": [52805439488, 2429110050816], "load": 5.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 154, 'objective/kl': 80.36093139648438, 'objective/entropy': 61.3639030456543, 'objective/non_score_reward': -4.018046855926514, 'objective/rlhf_reward': -6.161358833312988, 'objective/scores': -2.1433122158050537, 'policy/approxkl_avg': 2.666929244995117, 'policy/clipfrac_avg': 0.3288988769054413, 'loss/policy_avg': 0.20907986164093018, 'loss/value_avg': 2.383366346359253, 'val/clipfrac_avg': 0.299310564994812, 'policy/entropy_avg': 1.3316357135772705, 'val/ratio': 0.9514178037643433, 'val/ratio_var': 0.0012447533663362265, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-05, 'episode': 4224, 'epoch': 0.78}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 17%|\u2588\u258b        | 2/12 [00:27<01:30,  9.09s/it]\r 25%|\u2588\u2588\u258c       | 3/12 [00:27<01:17,  8.64s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 7236.2774875361565, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14638.02454685987, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11905.57296926794, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031224.1147914, "gpudata": {"0": {"memory": [38102.5625, 81559.0], "load": 0.85, "temperature": 39.0, "power": 300.029}, "1": {"memory": [41536.5625, 81559.0], "load": 0.95, "temperature": 43.0, "power": 308.108}, "2": {"memory": [34910.5625, 81559.0], "load": 0.88, "temperature": 42.0, "power": 298.635}, "3": {"memory": [38362.5625, 81559.0], "load": 0.57, "temperature": 38.0, "power": 285.754}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031224.1147914, "iodata": {"read_count": 0, "write_count": 687, "read_bytes": 0, "read_time": 0, "write_time": 14, "busy_time": 500}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031224.1147914, "netdata": {"bytes_sent": 111160305422, "bytes_recv": 801216769646, "packets_sent": 256416731, "packets_recv": 673886655, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031224.1147914, "cpudata": {"memory": [52815114240, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 164, 'objective/kl': 80.01263427734375, 'objective/entropy': 26.47927474975586, 'objective/non_score_reward': -4.000631332397461, 'objective/rlhf_reward': -6.115379333496094, 'objective/scores': -2.1147475242614746, 'policy/approxkl_avg': 2.627432107925415, 'policy/clipfrac_avg': 0.18949668109416962, 'loss/policy_avg': 0.11660867184400558, 'loss/value_avg': 2.161681652069092, 'val/clipfrac_avg': 0.28305572271347046, 'policy/entropy_avg': 0.421402245759964, 'val/ratio': 1.0007987022399902, 'val/ratio_var': 0.0015529050724580884, 'val/num_eos_tokens': 0, 'lr': 3.7500000000000003e-05, 'episode': 5632, 'epoch': 1.04}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 25%|\u2588\u2588\u258c       | 3/12 [00:34<01:17,  8.64s/it]\r 33%|\u2588\u2588\u2588\u258e      | 4/12 [00:34<01:03,  7.88s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 172, 'objective/kl': 55.024864196777344, 'objective/entropy': 8.080036163330078, 'objective/non_score_reward': -2.7512433528900146, 'objective/rlhf_reward': -4.805244445800781, 'objective/scores': -2.0540013313293457, 'policy/approxkl_avg': 1.4163814783096313, 'policy/clipfrac_avg': 0.10672169923782349, 'loss/policy_avg': 0.06707000732421875, 'loss/value_avg': 1.8988304138183594, 'val/clipfrac_avg': 0.35914719104766846, 'policy/entropy_avg': 0.17495779693126678, 'val/ratio': 0.9778878688812256, 'val/ratio_var': 0.0004594101046677679, 'val/num_eos_tokens': 0, 'lr': 3.3333333333333335e-05, 'episode': 7040, 'epoch': 1.3}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 33%|\u2588\u2588\u2588\u258e      | 4/12 [00:40<01:03,  7.88s/it]\r 42%|\u2588\u2588\u2588\u2588\u258f     | 5/12 [00:40<00:52,  7.44s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031234.1507816, "gpudata": {"0": {"memory": [19232.5625, 81559.0], "load": 0.82, "temperature": 42.0, "power": 302.936}, "1": {"memory": [19064.5625, 81559.0], "load": 0.79, "temperature": 47.0, "power": 306.188}, "2": {"memory": [19074.5625, 81559.0], "load": 0.82, "temperature": 45.0, "power": 305.005}, "3": {"memory": [18914.5625, 81559.0], "load": 0.81, "temperature": 40.0, "power": 302.469}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031234.1507816, "iodata": {"read_count": 0, "write_count": 824, "read_bytes": 0, "read_time": 0, "write_time": 16, "busy_time": 604}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031234.1507816, "netdata": {"bytes_sent": 111160475195, "bytes_recv": 801216805761, "packets_sent": 256416912, "packets_recv": 673886782, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031234.1507816, "cpudata": {"memory": [52841242624, 2429110050816], "load": 5.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 178, 'objective/kl': 39.74742126464844, 'objective/entropy': 3.076355457305908, 'objective/non_score_reward': -1.9873712062835693, 'objective/rlhf_reward': -4.143612861633301, 'objective/scores': -2.1562414169311523, 'policy/approxkl_avg': 0.9851541519165039, 'policy/clipfrac_avg': 0.050449587404727936, 'loss/policy_avg': 0.033244539052248, 'loss/value_avg': 1.487505555152893, 'val/clipfrac_avg': 0.40305399894714355, 'policy/entropy_avg': 0.06587406992912292, 'val/ratio': 0.9948686361312866, 'val/ratio_var': 0.00013309525093063712, 'val/num_eos_tokens': 0, 'lr': 2.916666666666667e-05, 'episode': 8448, 'epoch': 1.56}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 42%|\u2588\u2588\u2588\u2588\u258f     | 5/12 [00:47<00:52,  7.44s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 6/12 [00:47<00:42,  7.13s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14203.551200134067, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14194.554907690637, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14404.689265934165, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031244.1680384, "gpudata": {"0": {"memory": [80782.5625, 81559.0], "load": 0.41, "temperature": 45.0, "power": 263.512}, "1": {"memory": [60278.5625, 81559.0], "load": 0.31, "temperature": 47.0, "power": 202.794}, "2": {"memory": [80078.5625, 81559.0], "load": 0.26, "temperature": 49.0, "power": 211.143}, "3": {"memory": [79848.5625, 81559.0], "load": 0.25, "temperature": 45.0, "power": 232.347}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031244.1680384, "iodata": {"read_count": 0, "write_count": 933, "read_bytes": 0, "read_time": 0, "write_time": 20, "busy_time": 676}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031244.1680384, "netdata": {"bytes_sent": 111160615514, "bytes_recv": 801216835838, "packets_sent": 256417087, "packets_recv": 673886910, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031244.1680384, "cpudata": {"memory": [52893376512, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 177, 'objective/kl': 32.93741989135742, 'objective/entropy': 0.7556008696556091, 'objective/non_score_reward': -1.6468709707260132, 'objective/rlhf_reward': -3.9189610481262207, 'objective/scores': -2.272090196609497, 'policy/approxkl_avg': 0.0741351842880249, 'policy/clipfrac_avg': 0.013906383886933327, 'loss/policy_avg': 0.005521906539797783, 'loss/value_avg': 1.1278129816055298, 'val/clipfrac_avg': 0.3668357729911804, 'policy/entropy_avg': 0.018340934067964554, 'val/ratio': 1.0010247230529785, 'val/ratio_var': 0.000212744707823731, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 9856, 'epoch': 1.82}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 6/12 [00:55<00:42,  7.13s/it]\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 7/12 [00:55<00:37,  7.53s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 180, 'objective/kl': 29.6243896484375, 'objective/entropy': 0.4866982400417328, 'objective/non_score_reward': -1.4812195301055908, 'objective/rlhf_reward': -3.767242908477783, 'objective/scores': -2.2860233783721924, 'policy/approxkl_avg': 0.04917600005865097, 'policy/clipfrac_avg': 0.010439001023769379, 'loss/policy_avg': 0.004405132494866848, 'loss/value_avg': 0.9758319854736328, 'val/clipfrac_avg': 0.33773985505104065, 'policy/entropy_avg': 0.013977090828120708, 'val/ratio': 0.9984707832336426, 'val/ratio_var': 5.012973815610167e-06, 'val/num_eos_tokens': 0, 'lr': 2.0833333333333336e-05, 'episode': 11264, 'epoch': 2.08}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 7/12 [01:02<00:37,  7.53s/it]\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 8/12 [01:02<00:29,  7.28s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031254.191729, "gpudata": {"0": {"memory": [14880.5625, 81559.0], "load": 0.94, "temperature": 41.0, "power": 292.326}, "1": {"memory": [14964.5625, 81559.0], "load": 0.96, "temperature": 46.0, "power": 293.441}, "2": {"memory": [17768.5625, 81559.0], "load": 0.68, "temperature": 45.0, "power": 279.362}, "3": {"memory": [14662.5625, 81559.0], "load": 0.94, "temperature": 40.0, "power": 294.539}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031254.191729, "iodata": {"read_count": 0, "write_count": 1249, "read_bytes": 0, "read_time": 0, "write_time": 30, "busy_time": 836}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031254.191729, "netdata": {"bytes_sent": 111160635368, "bytes_recv": 801216852714, "packets_sent": 256417184, "packets_recv": 673887012, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031254.191729, "cpudata": {"memory": [52832362496, 2429110050816], "load": 5.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 183, 'objective/kl': 26.614376068115234, 'objective/entropy': 0.3614112138748169, 'objective/non_score_reward': -1.330718755722046, 'objective/rlhf_reward': -3.6446869373321533, 'objective/scores': -2.3139681816101074, 'policy/approxkl_avg': 0.03638387471437454, 'policy/clipfrac_avg': 0.007356882095336914, 'loss/policy_avg': 0.002153818029910326, 'loss/value_avg': 0.8788193464279175, 'val/clipfrac_avg': 0.24872024357318878, 'policy/entropy_avg': 0.009252403862774372, 'val/ratio': 0.9988628029823303, 'val/ratio_var': 7.2417255978507455e-06, 'val/num_eos_tokens': 0, 'lr': 1.6666666666666667e-05, 'episode': 12672, 'epoch': 2.34}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 8/12 [01:09<00:29,  7.28s/it]\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 9/12 [01:09<00:21,  7.08s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 11332.173396764807, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14005.558860159219, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14168.382415942615, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031264.348644, "gpudata": {"0": {"memory": [13744.5625, 81559.0], "load": 0.8, "temperature": 40.0, "power": 378.751}, "1": {"memory": [64944.5625, 81559.0], "load": 1.0, "temperature": 45.0, "power": 375.799}, "2": {"memory": [69640.5625, 81559.0], "load": 0.53, "temperature": 44.0, "power": 328.855}, "3": {"memory": [53562.5625, 81559.0], "load": 0.6, "temperature": 39.0, "power": 361.256}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031264.348644, "iodata": {"read_count": 0, "write_count": 1488, "read_bytes": 0, "read_time": 0, "write_time": 36, "busy_time": 996}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031264.348644, "netdata": {"bytes_sent": 111160749048, "bytes_recv": 801216898084, "packets_sent": 256417353, "packets_recv": 673887155, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031264.348644, "cpudata": {"memory": [52921126912, 2429110050816], "load": 5.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 186, 'objective/kl': 24.40628433227539, 'objective/entropy': 0.24981683492660522, 'objective/non_score_reward': -1.2203142642974854, 'objective/rlhf_reward': -3.5335819721221924, 'objective/scores': -2.313267707824707, 'policy/approxkl_avg': 0.021294591948390007, 'policy/clipfrac_avg': 0.004891187883913517, 'loss/policy_avg': 0.002599113155156374, 'loss/value_avg': 0.7941597700119019, 'val/clipfrac_avg': 0.2140263319015503, 'policy/entropy_avg': 0.006319786887615919, 'val/ratio': 1.0043889284133911, 'val/ratio_var': 8.395923214266077e-05, 'val/num_eos_tokens': 0, 'lr': 1.25e-05, 'episode': 14080, 'epoch': 2.6}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 9/12 [01:15<00:21,  7.08s/it]\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 10/12 [01:15<00:13,  6.91s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 188, 'objective/kl': 22.450115203857422, 'objective/entropy': 0.1446046084165573, 'objective/non_score_reward': -1.1225056648254395, 'objective/rlhf_reward': -3.4643592834472656, 'objective/scores': -2.341853618621826, 'policy/approxkl_avg': 0.013099845498800278, 'policy/clipfrac_avg': 0.002479095011949539, 'loss/policy_avg': 0.0015225708484649658, 'loss/value_avg': 0.7158606052398682, 'val/clipfrac_avg': 0.11589770019054413, 'policy/entropy_avg': 0.003814710769802332, 'val/ratio': 0.9987982511520386, 'val/ratio_var': 1.5428408062234666e-07, 'val/num_eos_tokens': 0, 'lr': 8.333333333333334e-06, 'episode': 15488, 'epoch': 2.87}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 10/12 [01:22<00:13,  6.91s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 11/12 [01:22<00:06,  6.84s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031274.389936, "gpudata": {"0": {"memory": [16620.5625, 81559.0], "load": 0.79, "temperature": 42.0, "power": 202.397}, "1": {"memory": [16382.5625, 81559.0], "load": 0.8, "temperature": 47.0, "power": 208.934}, "2": {"memory": [17768.5625, 81559.0], "load": 0.85, "temperature": 46.0, "power": 219.018}, "3": {"memory": [16378.5625, 81559.0], "load": 0.77, "temperature": 41.0, "power": 205.136}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031274.389936, "iodata": {"read_count": 0, "write_count": 1593, "read_bytes": 0, "read_time": 0, "write_time": 38, "busy_time": 1060}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031274.389936, "netdata": {"bytes_sent": 111161005252, "bytes_recv": 801216989686, "packets_sent": 256417574, "packets_recv": 673887300, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734031274.389936, "cpudata": {"memory": [52858695680, 2429110050816], "load": 5.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 189, 'objective/kl': 22.294052124023438, 'objective/entropy': 0.13869690895080566, 'objective/non_score_reward': -1.1147027015686035, 'objective/rlhf_reward': -3.4721436500549316, 'objective/scores': -2.357440948486328, 'policy/approxkl_avg': 0.014280730858445168, 'policy/clipfrac_avg': 0.0028241584077477455, 'loss/policy_avg': 0.001300122239626944, 'loss/value_avg': 0.6902894377708435, 'val/clipfrac_avg': 0.042921848595142365, 'policy/entropy_avg': 0.003970636986196041, 'val/ratio': 0.9987695217132568, 'val/ratio_var': 4.135926019444014e-07, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-06, 'episode': 16896, 'epoch': 3.13}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 11/12 [01:29<00:06,  6.84s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [01:29<00:00,  6.85s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [01:29<00:00,  7.44s/it]\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 14667.293101618227, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14141.210284781242, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1212 14:21:21.397050576 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "352", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734031283.3485782, "return_code": 0}, "pipe": null}
