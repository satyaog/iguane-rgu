{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}], "self": {"name": "local", "ip": "127.0.0.1", "sshport": 22, "user": "root", "main": true, "hostname": "cn-n002.server.mila.quebec", "local": true}}, "dirs": {"base": "/network/scratch/o/ortizgas/data/milabench", "venv": "/network/scratch/o/ortizgas/data/milabench/venv/torch", "data": "/network/scratch/o/ortizgas/data/milabench/data", "runs": "/network/scratch/o/ortizgas/data/milabench/runs", "extra": "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus", "cache": "/network/scratch/o/ortizgas/data/milabench/cache"}, "group": "rlhf-gpus", "install_group": "torch", "install_variant": "cuda", "run_name": "NVIDIA-H100-80GB-HBM3_rlhf-gpus_342.staging", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/home/mila/o/ortizgas/CODE/milabench/config", "config_file": "/home/mila/o/ortizgas/CODE/milabench/config/standard.yaml", "definition": "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf", "plan": {"method": "njobs", "n": 1}, "tags": ["llm", "multigpu", "rl", "rlhf"], "argv": {"--output_dir": "{milabench_extra}/output", "--model_name_or_path": "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size": 64, "--logging_strategy": "no", "--log_level": "critical", "--bf16": true}, "weight": 1.0, "name": "rlhf-gpus", "tag": ["rlhf-gpus", "0"], "job-number": 0, "devices": [0, 1, 2, 3]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 192, "brand": "AMD EPYC 9654 96-Core Processor"}, "os": {"sysname": "Linux", "nodename": "cn-n002.server.mila.quebec", "release": "5.15.0-101-generic", "version": "#111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"0": {"minor_number": "4", "device": 0, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 32.0, "power": 70.932, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "1": {"minor_number": "5", "device": 1, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 37.0, "power": 71.494, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "2": {"minor_number": "6", "device": 2, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 37.0, "power": 72.302, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "3": {"minor_number": "7", "device": 3, "product": "NVIDIA H100 80GB HBM3", "memory": {"used": 215.5625, "total": 81559.0}, "utilization": {"compute": 0.0, "memory": 0}, "temperature": 31.0, "power": 71.067, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1734050024.372123, "milabench": {"tag": "v1.0.0_RC1-13-g7a90b16", "commit": "7a90b1691650232ecd63abded0b7be84bb294c05", "date": "2024-11-08 11:28:56 -0500"}, "pytorch": {"torch": "2.4.0+cu121", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX512", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "12.1", "CUDNN_VERSION": "9.1.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_VERSION": "2.4.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_CUSPARSELT": "1", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_GLOO": "ON", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF", "USE_ROCM_KERNEL_ASSERT": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "342", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734032024.443106}, "pipe": null}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/cache\n", "pipe": "stdout"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "/network/scratch/o/ortizgas/data/milabench/venv/torch/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n", "pipe": "stderr"}
{"event": "line", "data": "  warnings.warn(\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "Some weights of GPTNeoXForSequenceClassification were not initialized from the model checkpoint at EleutherAI/pythia-160m and are newly initialized: ['score.weight']\n", "pipe": "stderr"}
{"event": "line", "data": "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n", "pipe": "stderr"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "line", "data": "===training policy===\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/12 [00:00<?, ?it/s]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [0, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "No overseer found\n", "pipe": "stdout"}
{"event": "data", "data": {"task": "main", "time": 1734032053.7449229, "gpudata": {"0": {"memory": [7172.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 118.855}, "1": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 36.0, "power": 121.364}, "2": {"memory": [7220.5625, 81559.0], "load": 0.0, "temperature": 35.0, "power": 120.875}, "3": {"memory": [6980.5625, 81559.0], "load": 0.0, "temperature": 32.0, "power": 119.135}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032053.7449229, "iodata": {"read_count": 0, "write_count": 208, "read_bytes": 0, "read_time": 0, "write_time": 4, "busy_time": 112}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032053.7449229, "netdata": {"bytes_sent": 111171308247, "bytes_recv": 801226077273, "packets_sent": 256501348, "packets_recv": 673969981, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032053.7449229, "cpudata": {"memory": [67741192192, 2429110050816], "load": 31.6}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032063.773028, "gpudata": {"0": {"memory": [78358.5625, 81559.0], "load": 0.59, "temperature": 43.0, "power": 336.446}, "1": {"memory": [78794.5625, 81559.0], "load": 0.84, "temperature": 45.0, "power": 332.716}, "2": {"memory": [77760.5625, 81559.0], "load": 0.94, "temperature": 46.0, "power": 364.918}, "3": {"memory": [78200.5625, 81559.0], "load": 0.78, "temperature": 43.0, "power": 335.588}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032063.773028, "iodata": {"read_count": 0, "write_count": 581, "read_bytes": 0, "read_time": 0, "write_time": 20, "busy_time": 296}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032063.773028, "netdata": {"bytes_sent": 111171320975, "bytes_recv": 801226089904, "packets_sent": 256501404, "packets_recv": 673970036, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032063.773028, "cpudata": {"memory": [69546831872, 2429110050816], "load": 5.6}}, "pipe": "data"}
{"event": "line", "data": "\r                                      \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 104, 'objective/kl': 4.6187633415684104e-05, 'objective/entropy': 93.00003051757812, 'objective/non_score_reward': -2.3093807612895034e-06, 'objective/rlhf_reward': 1.2695744037628174, 'objective/scores': 1.2695767879486084, 'policy/approxkl_avg': 2.148373603820801, 'policy/clipfrac_avg': 0.38473397493362427, 'loss/policy_avg': 0.20711031556129456, 'loss/value_avg': 3.218808174133301, 'val/clipfrac_avg': 0.143792062997818, 'policy/entropy_avg': 1.5352954864501953, 'val/ratio': 0.9787462949752808, 'val/ratio_var': 0.0004835639556404203, 'val/num_eos_tokens': 0, 'lr': 5e-05, 'episode': 1368, 'epoch': 0.25}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  0%|          | 0/12 [00:13<?, ?it/s]\r  8%|\u258a         | 1/12 [00:13<02:23, 13.05s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [1, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 139, 'objective/kl': 27.446701049804688, 'objective/entropy': 38.765167236328125, 'objective/non_score_reward': -1.3723351955413818, 'objective/rlhf_reward': -0.1518140733242035, 'objective/scores': 1.220521092414856, 'policy/approxkl_avg': 1.160632610321045, 'policy/clipfrac_avg': 0.19945107400417328, 'loss/policy_avg': 0.12313477694988251, 'loss/value_avg': 1.0484967231750488, 'val/clipfrac_avg': 0.5901122689247131, 'policy/entropy_avg': 0.724494993686676, 'val/ratio': 0.9963563084602356, 'val/ratio_var': 0.00031460588797926903, 'val/num_eos_tokens': 1, 'lr': 4.5833333333333334e-05, 'episode': 2736, 'epoch': 0.51}\n", "pipe": "stdout"}
{"event": "line", "data": "\r  8%|\u258a         | 1/12 [00:19<02:23, 13.05s/it]\r 17%|\u2588\u258b        | 2/12 [00:19<01:32,  9.29s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [2, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032073.7908149, "gpudata": {"0": {"memory": [18854.5625, 81559.0], "load": 0.72, "temperature": 37.0, "power": 284.426}, "1": {"memory": [19708.5625, 81559.0], "load": 0.65, "temperature": 41.0, "power": 273.644}, "2": {"memory": [19030.5625, 81559.0], "load": 0.6, "temperature": 40.0, "power": 278.127}, "3": {"memory": [18848.5625, 81559.0], "load": 0.65, "temperature": 36.0, "power": 280.212}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032073.7908149, "iodata": {"read_count": 0, "write_count": 869, "read_bytes": 0, "read_time": 0, "write_time": 28, "busy_time": 404}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032073.7908149, "netdata": {"bytes_sent": 111171333400, "bytes_recv": 801226102498, "packets_sent": 256501456, "packets_recv": 673970083, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032073.7908149, "cpudata": {"memory": [69594099712, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 154, 'objective/kl': 36.58641815185547, 'objective/entropy': 17.16217803955078, 'objective/non_score_reward': -1.8293209075927734, 'objective/rlhf_reward': -0.5901912450790405, 'objective/scores': 1.239129662513733, 'policy/approxkl_avg': 1.0539335012435913, 'policy/clipfrac_avg': 0.13919921219348907, 'loss/policy_avg': 0.06383104622364044, 'loss/value_avg': 0.6677324771881104, 'val/clipfrac_avg': 0.5574968457221985, 'policy/entropy_avg': 0.34393924474716187, 'val/ratio': 0.9857621788978577, 'val/ratio_var': 0.0005654289270751178, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-05, 'episode': 4104, 'epoch': 0.76}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 17%|\u2588\u258b        | 2/12 [00:26<01:32,  9.29s/it]\r 25%|\u2588\u2588\u258c       | 3/12 [00:26<01:13,  8.17s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 6945.678424335517, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13661.769193981187, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13505.25138662616, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [3, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032083.8078897, "gpudata": {"0": {"memory": [78392.5625, 81559.0], "load": 0.63, "temperature": 44.0, "power": 325.746}, "1": {"memory": [78826.5625, 81559.0], "load": 0.55, "temperature": 48.0, "power": 314.707}, "2": {"memory": [79740.5625, 81559.0], "load": 0.89, "temperature": 45.0, "power": 288.508}, "3": {"memory": [58424.5625, 81559.0], "load": 0.95, "temperature": 43.0, "power": 276.244}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032083.8078897, "iodata": {"read_count": 0, "write_count": 895, "read_bytes": 0, "read_time": 0, "write_time": 29, "busy_time": 444}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032083.8078897, "netdata": {"bytes_sent": 111171470762, "bytes_recv": 801226136681, "packets_sent": 256501589, "packets_recv": 673970170, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032083.8078897, "cpudata": {"memory": [69708136448, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 165, 'objective/kl': 46.12493133544922, 'objective/entropy': 12.837297439575195, 'objective/non_score_reward': -2.306246519088745, 'objective/rlhf_reward': -1.0456877946853638, 'objective/scores': 1.2605587244033813, 'policy/approxkl_avg': 0.938586950302124, 'policy/clipfrac_avg': 0.13593043386936188, 'loss/policy_avg': 0.05694820359349251, 'loss/value_avg': 0.4888147711753845, 'val/clipfrac_avg': 0.5240710973739624, 'policy/entropy_avg': 0.26611560583114624, 'val/ratio': 0.9729557037353516, 'val/ratio_var': 0.0003753847850020975, 'val/num_eos_tokens': 0, 'lr': 3.7500000000000003e-05, 'episode': 5472, 'epoch': 1.01}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 25%|\u2588\u2588\u258c       | 3/12 [00:33<01:13,  8.17s/it]\r 33%|\u2588\u2588\u2588\u258e      | 4/12 [00:33<01:00,  7.55s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [4, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 172, 'objective/kl': 44.90081787109375, 'objective/entropy': 5.784580230712891, 'objective/non_score_reward': -2.2450408935546875, 'objective/rlhf_reward': -0.9483771920204163, 'objective/scores': 1.296663522720337, 'policy/approxkl_avg': 2.3054773807525635, 'policy/clipfrac_avg': 0.09600849449634552, 'loss/policy_avg': 0.052843399345874786, 'loss/value_avg': 0.3976771831512451, 'val/clipfrac_avg': 0.3441258370876312, 'policy/entropy_avg': 0.13329952955245972, 'val/ratio': 1.2738544940948486, 'val/ratio_var': 1.0827338695526123, 'val/num_eos_tokens': 0, 'lr': 3.3333333333333335e-05, 'episode': 6840, 'epoch': 1.27}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 33%|\u2588\u2588\u2588\u258e      | 4/12 [00:39<01:00,  7.55s/it]\r 42%|\u2588\u2588\u2588\u2588\u258f     | 5/12 [00:39<00:50,  7.16s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [5, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032093.8307917, "gpudata": {"0": {"memory": [16392.5625, 81559.0], "load": 0.63, "temperature": 44.0, "power": 279.62}, "1": {"memory": [13896.5625, 81559.0], "load": 0.63, "temperature": 42.0, "power": 274.644}, "2": {"memory": [17726.5625, 81559.0], "load": 0.63, "temperature": 51.0, "power": 293.759}, "3": {"memory": [17492.5625, 81559.0], "load": 0.63, "temperature": 43.0, "power": 278.982}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032093.8307917, "iodata": {"read_count": 0, "write_count": 1002, "read_bytes": 0, "read_time": 0, "write_time": 31, "busy_time": 516}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032093.8307917, "netdata": {"bytes_sent": 111171482992, "bytes_recv": 801226149176, "packets_sent": 256501641, "packets_recv": 673970220, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032093.8307917, "cpudata": {"memory": [69655519232, 2429110050816], "load": 6.2}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 177, 'objective/kl': 33.73319625854492, 'objective/entropy': 1.3908231258392334, 'objective/non_score_reward': -1.686659812927246, 'objective/rlhf_reward': -0.47210144996643066, 'objective/scores': 1.2145583629608154, 'policy/approxkl_avg': 0.2515708804130554, 'policy/clipfrac_avg': 0.03436017408967018, 'loss/policy_avg': 0.015521351248025894, 'loss/value_avg': 0.24094197154045105, 'val/clipfrac_avg': 0.08663660287857056, 'policy/entropy_avg': 0.04401102289557457, 'val/ratio': 0.9912639856338501, 'val/ratio_var': 9.317464719060808e-05, 'val/num_eos_tokens': 1, 'lr': 2.916666666666667e-05, 'episode': 8208, 'epoch': 1.52}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 42%|\u2588\u2588\u2588\u2588\u258f     | 5/12 [00:46<00:50,  7.16s/it]\r 50%|\u2588\u2588\u2588\u2588\u2588     | 6/12 [00:46<00:41,  6.99s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14020.142446316724, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14284.57414083431, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13729.014260077472, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [6, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032104.02274, "gpudata": {"0": {"memory": [13568.5625, 81559.0], "load": 0.17, "temperature": 38.0, "power": 288.752}, "1": {"memory": [13896.5625, 81559.0], "load": 0.24, "temperature": 42.0, "power": 295.491}, "2": {"memory": [17726.5625, 81559.0], "load": 0.54, "temperature": 42.0, "power": 294.102}, "3": {"memory": [13376.5625, 81559.0], "load": 0.45, "temperature": 37.0, "power": 297.603}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032104.02274, "iodata": {"read_count": 0, "write_count": 1413, "read_bytes": 0, "read_time": 0, "write_time": 44, "busy_time": 636}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032104.02274, "netdata": {"bytes_sent": 111171500254, "bytes_recv": 801226173067, "packets_sent": 256501730, "packets_recv": 673970310, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032104.02274, "cpudata": {"memory": [69698629632, 2429110050816], "load": 6.2}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 181, 'objective/kl': 37.37384796142578, 'objective/entropy': 3.1457173824310303, 'objective/non_score_reward': -1.868692398071289, 'objective/rlhf_reward': -0.6099363565444946, 'objective/scores': 1.2587560415267944, 'policy/approxkl_avg': 0.32145655155181885, 'policy/clipfrac_avg': 0.05403494834899902, 'loss/policy_avg': 0.034973472356796265, 'loss/value_avg': 0.2814330458641052, 'val/clipfrac_avg': 0.09388447552919388, 'policy/entropy_avg': 0.07801146060228348, 'val/ratio': 1.0140931606292725, 'val/ratio_var': 0.004411482717841864, 'val/num_eos_tokens': 0, 'lr': 2.5e-05, 'episode': 9576, 'epoch': 1.77}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 50%|\u2588\u2588\u2588\u2588\u2588     | 6/12 [00:52<00:41,  6.99s/it]\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 7/12 [00:52<00:34,  6.82s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [7, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 182, 'objective/kl': 29.71061897277832, 'objective/entropy': 1.5195908546447754, 'objective/non_score_reward': -1.4855310916900635, 'objective/rlhf_reward': -0.177883118391037, 'objective/scores': 1.307647943496704, 'policy/approxkl_avg': 0.26843056082725525, 'policy/clipfrac_avg': 0.029194941744208336, 'loss/policy_avg': 0.016916833817958832, 'loss/value_avg': 0.19873805344104767, 'val/clipfrac_avg': 0.028532909229397774, 'policy/entropy_avg': 0.0378204807639122, 'val/ratio': 0.9959903359413147, 'val/ratio_var': 3.167198519804515e-05, 'val/num_eos_tokens': 0, 'lr': 2.0833333333333336e-05, 'episode': 10944, 'epoch': 2.02}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 7/12 [00:59<00:34,  6.82s/it]\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 8/12 [00:59<00:27,  6.96s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [8, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032114.0490868, "gpudata": {"0": {"memory": [19178.5625, 81559.0], "load": 0.82, "temperature": 39.0, "power": 284.384}, "1": {"memory": [19706.5625, 81559.0], "load": 0.73, "temperature": 43.0, "power": 281.368}, "2": {"memory": [19030.5625, 81559.0], "load": 0.74, "temperature": 43.0, "power": 280.841}, "3": {"memory": [18848.5625, 81559.0], "load": 0.81, "temperature": 38.0, "power": 283.133}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032114.0490868, "iodata": {"read_count": 0, "write_count": 1504, "read_bytes": 0, "read_time": 0, "write_time": 45, "busy_time": 708}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032114.0490868, "netdata": {"bytes_sent": 111171636887, "bytes_recv": 801226206647, "packets_sent": 256501860, "packets_recv": 673970393, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032114.0490868, "cpudata": {"memory": [69798821888, 2429110050816], "load": 6.0}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 184, 'objective/kl': 25.815597534179688, 'objective/entropy': 0.6986318230628967, 'objective/non_score_reward': -1.2907800674438477, 'objective/rlhf_reward': 0.08784231543540955, 'objective/scores': 1.37862229347229, 'policy/approxkl_avg': 0.10226534307003021, 'policy/clipfrac_avg': 0.014699188992381096, 'loss/policy_avg': 0.006681286729872227, 'loss/value_avg': 0.15965679287910461, 'val/clipfrac_avg': 0.01658184453845024, 'policy/entropy_avg': 0.01816878467798233, 'val/ratio': 0.9966098070144653, 'val/ratio_var': 1.537138086860068e-05, 'val/num_eos_tokens': 0, 'lr': 1.6666666666666667e-05, 'episode': 12312, 'epoch': 2.28}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 8/12 [01:06<00:27,  6.96s/it]\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 9/12 [01:06<00:20,  6.92s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"rate": 14207.217881444036, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 12752.396026528651, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13353.550888119222, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"progress": [9, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032124.062749, "gpudata": {"0": {"memory": [79274.5625, 81559.0], "load": 0.77, "temperature": 44.0, "power": 278.861}, "1": {"memory": [78826.5625, 81559.0], "load": 0.64, "temperature": 49.0, "power": 309.86}, "2": {"memory": [78804.5625, 81559.0], "load": 0.77, "temperature": 50.0, "power": 288.313}, "3": {"memory": [78166.5625, 81559.0], "load": 0.96, "temperature": 43.0, "power": 275.976}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032124.062749, "iodata": {"read_count": 0, "write_count": 1627, "read_bytes": 0, "read_time": 0, "write_time": 48, "busy_time": 828}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032124.062749, "netdata": {"bytes_sent": 111171648511, "bytes_recv": 801226218536, "packets_sent": 256501906, "packets_recv": 673970437, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032124.062749, "cpudata": {"memory": [69941653504, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                              \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 186, 'objective/kl': 23.359203338623047, 'objective/entropy': 0.4411303997039795, 'objective/non_score_reward': -1.1679601669311523, 'objective/rlhf_reward': 0.18326227366924286, 'objective/scores': 1.3512225151062012, 'policy/approxkl_avg': 0.0834028497338295, 'policy/clipfrac_avg': 0.009402928873896599, 'loss/policy_avg': 0.006202980875968933, 'loss/value_avg': 0.131996288895607, 'val/clipfrac_avg': 0.01949547603726387, 'policy/entropy_avg': 0.01272639911621809, 'val/ratio': 0.9985672235488892, 'val/ratio_var': 5.76355705561582e-06, 'val/num_eos_tokens': 0, 'lr': 1.25e-05, 'episode': 13680, 'epoch': 2.53}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 9/12 [01:13<00:20,  6.92s/it]\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 10/12 [01:13<00:13,  6.84s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [10, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 187, 'objective/kl': 21.841684341430664, 'objective/entropy': 0.40023675560951233, 'objective/non_score_reward': -1.0920841693878174, 'objective/rlhf_reward': 0.23220789432525635, 'objective/scores': 1.3242921829223633, 'policy/approxkl_avg': 0.05864005908370018, 'policy/clipfrac_avg': 0.007909908890724182, 'loss/policy_avg': 0.003159616608172655, 'loss/value_avg': 0.10386182367801666, 'val/clipfrac_avg': 0.006989269517362118, 'policy/entropy_avg': 0.010175934992730618, 'val/ratio': 1.0000767707824707, 'val/ratio_var': 1.7485410353401676e-05, 'val/num_eos_tokens': 0, 'lr': 8.333333333333334e-06, 'episode': 15048, 'epoch': 2.78}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 10/12 [01:20<00:13,  6.84s/it]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 11/12 [01:20<00:06,  6.79s/it]", "pipe": "stderr"}
{"event": "data", "data": {"progress": [11, 70], "task": "early_stop"}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032134.114777, "gpudata": {"0": {"memory": [19112.5625, 81559.0], "load": 0.79, "temperature": 40.0, "power": 298.059}, "1": {"memory": [19566.5625, 81559.0], "load": 0.81, "temperature": 45.0, "power": 294.501}, "2": {"memory": [19030.5625, 81559.0], "load": 0.73, "temperature": 44.0, "power": 290.919}, "3": {"memory": [18848.5625, 81559.0], "load": 0.75, "temperature": 38.0, "power": 285.155}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032134.114777, "iodata": {"read_count": 0, "write_count": 1739, "read_bytes": 0, "read_time": 0, "write_time": 50, "busy_time": 948}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032134.114777, "netdata": {"bytes_sent": 111171673775, "bytes_recv": 801226243911, "packets_sent": 256501962, "packets_recv": 673970493, "errin": 0, "errout": 0, "dropin": 10, "dropout": 0}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "time": 1734032134.114777, "cpudata": {"memory": [69856854016, 2429110050816], "load": 6.1}}, "pipe": "data"}
{"event": "line", "data": "\r                                               \r", "pipe": "stderr"}
{"event": "line", "data": "{'eps': 189, 'objective/kl': 20.635040283203125, 'objective/entropy': 0.24423813819885254, 'objective/non_score_reward': -1.031752109527588, 'objective/rlhf_reward': 0.2802218198776245, 'objective/scores': 1.3119738101959229, 'policy/approxkl_avg': 0.022818904370069504, 'policy/clipfrac_avg': 0.005096270702779293, 'loss/policy_avg': 0.0031003232579678297, 'loss/value_avg': 0.08494003117084503, 'val/clipfrac_avg': 0.003758413251489401, 'policy/entropy_avg': 0.006402638740837574, 'val/ratio': 0.9994022846221924, 'val/ratio_var': 5.211349161982071e-06, 'val/num_eos_tokens': 0, 'lr': 4.166666666666667e-06, 'episode': 16416, 'epoch': 3.04}\n", "pipe": "stdout"}
{"event": "line", "data": "\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 11/12 [01:26<00:06,  6.79s/it]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [01:26<00:00,  6.71s/it]", "pipe": "stderr"}
{"event": "line", "data": "\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [01:26<00:00,  7.24s/it]", "pipe": "stderr"}
{"event": "line", "data": "\n", "pipe": "stderr"}
{"event": "data", "data": {"rate": 13942.971547835985, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "data", "data": {"rate": 13679.667020698394, "units": "items/s", "task": "train"}, "pipe": "data"}
{"event": "line", "data": "[rank0]:[W1212 14:35:39.448953484 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["/home/mila/o/ortizgas/CODE/milabench/milabench/scripts/activator", "/network/scratch/o/ortizgas/data/milabench/venv/torch", "/network/scratch/o/ortizgas/data/milabench/cache", "accelerate", "launch", "--mixed_precision=bf16", "--dynamo_backend=no", "--machine_rank=0", "--num_machines=1", "--multi_gpu", "--gradient_accumulation_steps=1", "--num_cpu_threads_per_process=4", "--main_process_ip=127.0.0.1", "--main_process_port=29400", "--num_processes=4", "/home/mila/o/ortizgas/CODE/milabench/benchmarks/rlhf/main.py", "--output_dir", "/network/scratch/o/ortizgas/data/milabench/extra/rlhf-gpus/output", "--model_name_or_path", "EleutherAI/pythia-1b-deduped", "--per_device_train_batch_size", "342", "--logging_strategy", "no", "--log_level", "critical", "--bf16"], "time": 1734032141.2959871, "return_code": 0}, "pipe": null}
